$(document).ready(function(){$(document).on("click","#confirm_but_reset_password",function(){var a=$(this);var d=getObjectData($(".confirm_container_unsubscribe input[name=NewPassword]"));var e=getObjectData($(".confirm_container_unsubscribe input[name=ConfirmNewPassword]"));if(checkAccountInfo(d,e)){$(".upload-overlay-loading-fix").show();var c=a.attr("data-email");var b="email="+c+"&new_pass="+d;$.ajax({type:"POST",url:ReturnLink("/ajax/update_forgot_password.php"),data:b,success:function(h){var g;try{g=$.parseJSON(h)}catch(f){}if(g.status=="ok"){$(".confirm_container_unsubscribe").hide();$("#confirm_container_hide").show()}else{TTAlert({msg:g.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}$(".upload-overlay-loading-fix").hide()}})}});$(document).on("click",".reactivate_notifications",function(){var a=$(this);var c=a.attr("data-email");var b="email="+c;$.ajax({type:"POST",url:ReturnLink("/ajax/reactivate_notifications.php"),data:b,success:function(f){var e;try{e=$.parseJSON(f)}catch(d){}TTAlert({msg:e.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}})});$(document).on("click","#confirm_but_delete_channel",function(){var a=$(this);var b=a.attr("data-channel");var c="channel="+b;$.ajax({type:"POST",url:ReturnLink("/ajax/channel_unsubscribe_delete.php"),data:c,success:function(f){var e;try{e=$.parseJSON(f)}catch(d){}if(e.error=="error"){TTAlert({msg:e.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{$("#confirm_text_title").hide();$("#confirm_but_delete_channel").hide();$(".confirm_text_confirm").show()}}})});$(document).on("click","#confirm_but_delete_user",function(){var b=$(this);var a=b.attr("data-code");var c="code="+a;$.ajax({type:"POST",url:ReturnLink("/ajax/user_unsubscribe_delete.php"),data:c,success:function(f){var e;try{e=$.parseJSON(f)}catch(d){}if(e.error=="error"){TTAlert({msg:e.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{$("#confirm_text_title").hide();$("#confirm_but_delete_user").hide();$(".confirm_text_confirm").show()}}})});$(document).on("click","#confirm_but_accept",function(){$(".confirm_container .requestinvitation_wrong_credentials").html("");$(".confirm_container .confirm_input").focus().removeClass("InputErr");var c=getObjectData($(".confirm_container #pass"));var a=getObjectData($(".confirm_container #cpass"));var b=$(".confirm_container").attr("data-val");if(c.length==0||!(c.match(/([\<])([^\>]{1,})*([\>])/i)==null)){$(".confirm_container #pass").focus().addClass("InputErr");$(".confirm_container .requestinvitation_wrong_credentials").html(t("please enter your password."));return false}else{if(c.length<6){$(".confirm_container #pass").focus().addClass("InputErr");$(".confirm_container .requestinvitation_wrong_credentials").html(t("please your password should be at least 6 characters long."));return false}else{if(a.length==0||!(a.match(/([\<])([^\>]{1,})*([\>])/i)==null)){$(".confirm_container #cpass").focus().addClass("InputErr");$(".confirm_container .requestinvitation_wrong_credentials").html(t("please confirm your password."));return false}else{if(a!=c){$(".confirm_container #cpass").focus().addClass("InputErr");$(".confirm_container .requestinvitation_wrong_credentials").html(t("password does not match."));return false}}}}var d=getObjectData($(".confirm_container #username"));$.ajax({url:ReturnLink("/ajax/ajax_register_accept.php"),data:{YourEmail:b,YourPassword:c,YourCPassword:a,rusername:d},type:"post",success:function(e){var g=null;try{g=$.parseJSON(e)}catch(f){return}if(g.error){if(g.YourUserName){$("#YourUserName").val(g.YourUserName)}$(".confirm_container .requestinvitation_wrong_credentials").html(g.error)}else{window.top.location.href=ReturnLink("/touristtube-video")}}})});$(document).on("click","#confirm_but1",function(){var b=getObjectData($("#confirm_email"));var c=getObjectData($("#confirm_pass"));$("#confirm_pass, #confirm_email").removeClass("InputErr");if(b.length==0||!(b.match(/([\<])([^\>]{1,})*([\>])/i)==null)){$("#confirm_email").focus().addClass("InputErr");return false}else{if(c.length==0||!(c.match(/([\<])([^\>]{1,})*([\>])/i)==null)){$("#confirm_pass").focus().addClass("InputErr");return false}else{var a="EmailField="+b+"&PasswordField="+c;if($("#RememberMe").is(":checked")){$.cookie("remember_me","true",{path:"/"});$.cookie("remember_me_name",$("#EmailField").val(),{path:"/"});$.cookie("remember_me_pass",$("#PasswordField").val(),{path:"/"})}else{$.cookie("remember_me","false",{path:"/"});$.cookie("remember_me_name",null,{path:"/"});$.cookie("remember_me_pass",null,{path:"/"})}$.ajax({type:"POST",url:ReturnLink("/ajax/process.php"),data:a,success:function(d){var f;try{f=$.parseJSON(d)}catch(e){return}if(f.status=="ok"){window.location.reload()}else{TTAlert({msg:t("Invalid credentials"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})}}});$(".signin").fancybox({padding:0,margin:0,onComplete:clearForm()});$("#signInbtn").live("click",function(){var b=getObjectData($("#SEmailField"));var c=getObjectData($("#SPasswordField"));$("#SPasswordField, #SEmailField").removeClass("InputErr");if(b==""||b=="yourname@email.com"||!(b.match(/([\<])([^\>]{1,})*([\>])/i)==null)){$("#SEmailField").focus().addClass("InputErr");return false}else{if(c==""||c=="Your Password"||!(c.match(/([\<])([^\>]{1,})*([\>])/i)==null)){$("#SPasswordField").focus().addClass("InputErr");return false}else{var a="EmailField="+b+"&PasswordField="+c;$.cookie("remember_me_name",$("#SEmailField").val(),{path:"/"});$.cookie("remember_me_pass",$("#SPasswordField").val(),{path:"/"});$.ajax({type:"POST",url:ReturnLink("/ajax/process.php"),data:a,success:function(d){CloseFancyBox();var f;try{f=$.parseJSON(d)}catch(e){return}var g=$("#InsideNormal .selected").attr("id");clearForm();if(f.status=="ok"){$.fancybox.close();window.top.location.href=ReturnLink("register/"+g)}else{TTAlert({msg:t("Invalid credentials"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}});return true}}});$("#resetbtn").live("click",function(b){var c=getObjectData($("#SEmailForgotForm"));$("#SEmailForgotForm").removeClass("InputErr");if(c==""||c=="yourname@email.com"||!(c.match(/([\<])([^\>]{1,})*([\>])/i)==null)){$("#SEmailForgotForm").focus().addClass("InputErr")}else{var a="EmailForgotForm="+c;$.ajax({type:"POST",url:ReturnLink("/ajax/passprocess.php"),data:a,success:function(e){clearForm();var f;try{f=$.parseJSON(e)}catch(d){return}if(!f){return}if(f.status=="ok"){$.fancybox.close();ShowClaimdiv(t("an email is sent to you to reset your password"))}else{TTAlert({msg:t("Invalid email, please try again"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})}})});function clearForm(){$("#SEmailField").val(t("yourname@email.com"));$("#SPasswordField").val(t("Your Password"));$("#SEmailForgotForm").val(t("yourname@email.com"))}function checkSubmitConfirm(a){if(a&&a.keyCode==13){$("#confirm_but1").click()}}function checkSubmitAccept(a){if(a&&a.keyCode==13){$("#confirm_but_accept").click()}}function checkAccountInfo(b,c){$(".confirm_container_unsubscribe input").removeClass("InputErr");$(".confirm_container_unsubscribe .errorclass").html("");var a=6;if(b.length==0||(b.length<a)){$(".confirm_container_unsubscribe .errorclass").html(sprintf(t("Password must be minimum %s characters long"),[a]));$(".confirm_container_unsubscribe input[name=NewPassword]").addClass("InputErr");return false}else{if(b!=c){$(".confirm_container_unsubscribe .errorclass").html(t("Passwords mismatch"));$(".confirm_container_unsubscribe input[name=NewPassword]").addClass("InputErr");$(".confirm_container_unsubscribe input[name=ConfirmNewPassword]").addClass("InputErr");return false}}return true}function ShowClaimdiv(a){$(".confirm_container .requestinvitation_wrong_credentials").html("");if(a==1){show=t("please ")+'<a href="#signIn" class="signin">'+t("sign in")+"</a> "+t("using this email or ")+' <a href="#resetIn" class="signin">'+t("reset your password")+"</a>"}else{show=a}$("#ClaimEmail").css("visibility","visible");$("#ClaimEmail").html(show)};