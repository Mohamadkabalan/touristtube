var keypressed=0;var indexpressed=-1;var dragbool=false;var frsposx=0;var frsposy=0;var catalogpressed="";var currentPage=0;var globtxtsrch="";var globkeysrch="";var caltocreated=false;var curdate=new Date();var TO_CAL;var mediatype="a";var ct_id="";var frtxt="";var totxt="";$(document).ready(function(){$("#headbutinfocontent").css("width","1500px");var a=$("#headbutinfocontenttxt").width()+51;$("#headbutinfocontent").css("width","0px");$("#headbutinfocontent").attr("data-width",a);$("#headbutinfocontent").removeClass("opacityzero");$(document).on("click",".uploadinfocheckbox",function(){var b=$(this);if(b.hasClass("uploadinfocheckbox_remove1")){b.addClass("active");$(".uploadinfocheckbox_remove2").removeClass("active")}else{if(b.hasClass("uploadinfocheckbox_remove2")){b.addClass("active");$(".uploadinfocheckbox_remove1").removeClass("active")}else{if(b.hasClass("uploadinfocheckbox_remove3")){b.addClass("active");$(".uploadinfocheckbox_remove4").removeClass("active")}else{if(b.hasClass("uploadinfocheckbox_remove4")){b.addClass("active");$(".uploadinfocheckbox_remove3").removeClass("active")}else{if($(this).hasClass("active")){$(this).removeClass("active");if($(this).hasClass("uploadinfocheckbox3")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#friendsdata").remove()}}else{if($(this).hasClass("uploadinfocheckbox_friends_of_friends")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#friends_of_friends_data").remove()}}else{if($(this).hasClass("uploadinfocheckbox4")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#followersdata").remove()}}}}}else{$(this).addClass("active");if($(this).hasClass("uploadinfocheckbox3")){if($(this).parent().hasClass("friendscontainer")){var d='<div class="peoplesdata formttl13" id="friendsdata" data-email="" data-id=""><div class="peoplesdatainside">'+t("friends")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(d)}}else{if($(this).hasClass("uploadinfocheckbox_friends_of_friends")){if($(this).parent().hasClass("friendscontainer")){var c='<div class="peoplesdata formttl13" id="friends_of_friends_data" data-email="" data-id=""><div class="peoplesdatainside">'+t("friends of friends")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(c)}}else{if($(this).hasClass("uploadinfocheckbox4")){if($(this).parent().hasClass("friendscontainer")){var c='<div class="peoplesdata formttl13" id="followersdata" data-email="" data-id=""><div class="peoplesdatainside">'+t("followers")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(c)}}}}}}}}}});$(document).on("click",".peoplesdataclose",function(){var b=$(this).parent();var c=b.parent().parent();b.remove();if(b.attr("data-id")!=""){SelectedUsersDelete(b.attr("data-id"),c.find(".addmore input"))}if(b.attr("id")=="friendsdata"){c.find(".uploadinfocheckbox3").removeClass("active")}else{if(b.attr("id")=="followersdata"){c.find(".uploadinfocheckbox4").removeClass("active")}else{if(b.attr("id")=="connectionsdata"){c.find(".uploadinfocheckbox5").removeClass("active")}else{if(b.attr("id")=="sponsorssdata"){c.find(".uploadinfocheckbox6").removeClass("active")}else{if(b.attr("id")=="friends_of_friends_data"){c.find(".uploadinfocheckbox_friends_of_friends").removeClass("active")}}}}}});$(document).on("click",".popup_delete_ok",function(){var e=$(this).parent();if((""+e.attr("id")=="popup_delete_album")){var b=1;if($(".uploadinfocheckbox_remove1").hasClass("active")){b=0}else{if($(".uploadinfocheckbox_remove2").hasClass("active")){b=1}else{return}}$(".overlay-loading-fix").show();var i=e.attr("data-id");var d=$("#catmenucontent").find("#"+i);$.post(ReturnLink("/ajax/ajax_catalogdelete.php"),{id:i,albumcontents:b},function(j){$(".slectcateg_select").find("#"+i).remove();if(d.find(".txtMN").hasClass("active")||b==1){$("#catAllmenu").click()}else{refreshMediaCount();refreshMediaCatalogs()}d.remove()})}else{if((""+e.attr("id")=="popup_delete_album_pic")){var h=1;if($(".uploadinfocheckbox_remove3").hasClass("active")){h=0}else{if($(".uploadinfocheckbox_remove4").hasClass("active")){h=1}else{return}}$(".overlay-loading-fix").show();var i=e.attr("data-id");var f=$("#catimagecontainer").find("#"+i);var c=catalogpressed.parent().attr("id");var g=new Array();g.push(i);$.post(ReturnLink("/ajax/ajax_deletepiccatalog.php"),{catid:c,idarr:g.join("/*/"),mediacontents:h},function(j){refreshMediaCount();refreshMediaCatalogs();getMediaImages()});if(parseInt($("#catselected").attr("data-val"))==2){$("#catselected").click()}removeButSelectedMenu()}}$(".fancybox-close").click()});$(".scroll-panemenu").jScrollPane({showArrows:true});$(".scroll-panemenu .jspVerticalBar").css("right",0+"px");$(".select3").selectbox();$(".select2").selectbox();$("#catAllplus").fancybox();$(".cataddselected").fancybox({padding:0,margin:0,afterShow:function(){enableSelectBoxes()}});refreshEditCat();refreshEditImg();$(document).on("click","#headbutinfo",function(){if(!$(this).hasClass("active")){$(this).addClass("active");var b=$("#headbutinfocontent").attr("data-width");$("#headbutinfocontent").animate({width:b+"px"},500)}});$(document).on("click","#headbutinfocontentclose",function(){$("#headbutinfocontent").animate({width:0+"px"},500);$("#headbutinfo").removeClass("active")});addListenerClose();$(document).on("click","#cataddbut",function(){var b=""+$("#cataddtxt").val();if(b!=""&&b!="name album..."){$(".overlay-loading-fix").show();$.post(ReturnLink("/ajax/ajax_addcatalog.php"),{txtcatadd:b},function(d){if(d!=false){$("#cataddtxt").val("name album...");$("#catmenucontent ul").prepend(d);var c=new Array(""+$("#catmenucontent ul li").length);$("#catAllmenu").html(sprintf(t("MY ALBUMS (%s)"),c));$(".fancybox-close").click();calldroppableslectitem();var e='<option value="" selected="selected">...</option>';$("#catmenucontent ul li").each(function(){var f=$(this);var g=f.attr("id");e+='<option value="'+g+'" id="'+g+'">'+f.find(".txtMN").html()+"</option>"});$(".slectcateg_select").html(e);$(".scroll-panemenu").jScrollPane({showArrows:true});$(".scroll-panemenu .jspVerticalBar").css("right",0+"px");$(".overlay-loading-fix").hide();refreshEditCat()}})}});$(document).on("click","#cataddbut1, #cataddtobut1, #cateditbut1, #cateditimgbut1, .popup_delete_cancel",function(){$(".fancybox-close").click()});$(document).on("click","#cataddtobut",function(){if(!$(this).hasClass("inactive")){var b=""+$(".slectcateg_select").val();var g=""+$("#cataddtotxt").val();if(g!=""&&g!="create album..."){$(".overlay-loading-fix").show();$.post(ReturnLink("/ajax/ajax_addcatalog.php"),{txtcatadd:g},function(h){if(h!=false){$("#cataddtotxt").val("create album...");$("#catmenucontent ul").prepend(h);$(".fancybox-close").click();calldroppableslectitem();var l='<option value="" selected="selected">...</option>';$("#catmenucontent ul li").each(function(){var m=$(this);var n=m.attr("id");l+='<option value="'+n+'" id="'+n+'">'+m.find(".txtMN").html()+"</option>"});$(".slectcateg_select").html(l);d=$("#catmenucontent ul li").first();var j=d.attr("id");$(".scroll-panemenu").jScrollPane({showArrows:true});$(".scroll-panemenu .jspVerticalBar").css("right",0+"px");refreshEditCat();var k=$("#catimagecontainer ul li.active").length;var i=new Array();$("#catimagecontainer ul li.active").each(function(){var m=$(this).attr("id");i.push(m)});$.ajax({url:ReturnLink("/ajax/ajax_addpiccatalog.php"),type:"post",data:{catid:j,idarr:i.join("/*/")},success:function(m){document.location.href=ReturnLink("/album-manage/"+ct_id)},error:function(o,m,n){}})}})}else{if(b!=""){$(".overlay-loading-fix").show();var e=parseInt(b);var d=$("#catmenucontent ul").find("#"+e);var f=$("#catimagecontainer ul li.active").length;var c=new Array();$("#catimagecontainer ul li.active").each(function(){var h=$(this).attr("id");c.push(h)});$.ajax({url:ReturnLink("/ajax/ajax_addpiccatalog.php"),type:"post",data:{catid:e,idarr:c.join("/*/")},success:function(h){document.location.href=ReturnLink("/album-manage/"+ct_id)},error:function(j,h,i){}})}}}});$("#searchbut").click(function(){var b=""+$("#srchtxt").val();removeButSelectedMenu();if(b!=""&&(parseInt($("#filterby").val())==1||parseInt($("#filterby").val())==0)){$(".overlay-loading-fix").show();globtxtsrch=b;currentPage=0;ct_id="";if(catalogpressed!=""){ct_id=catalogpressed.parent().attr("id")}globkeysrch=""+$("#filterby").val();frtxt="";totxt="";getMediaImages()}else{if(parseInt($("#filterby").val())==2&&($("#fromtxt").html()!=""||$("#totxt").html()!="")){$(".overlay-loading-fix").show();frtxt=""+$("#fromtxt").attr("data-cal");totxt=""+$("#totxt").attr("data-cal");b="";globtxtsrch=b;currentPage=0;ct_id="";if(catalogpressed!=""){ct_id=catalogpressed.parent().attr("id")}globkeysrch=""+$("#filterby").val();getMediaImages()}else{if(parseInt($("#filterby").val())==3&&b!=""){$(".overlay-loading-fix").show();globtxtsrch="";$.post(ReturnLink("/ajax/ajax_getsearchcatalog.php"),{txtsrch:b},function(c){if(catalogpressed!=""){catalogpressed=""}$("#catmenucontent ul").html(c);$(".scroll-panemenu").jScrollPane({showArrows:true});$(".scroll-panemenu .jspVerticalBar").css("right",0+"px");calldroppableslectitem();refreshEditCat();$(".overlay-loading-fix").hide()})}}}});$("#catAllmenu, #catAllnum").click(function(){$(".overlay-loading-fix").show();if(parseInt($("#catselected").attr("data-val"))==2){$("#catselected").click()}ct_id="";removeButSelectedMenu();$("#catmenucontent ul li .txtMN").removeClass("active");$("#catmenucontent ul li .txtMN").removeClass("active1");catalogpressed="";mediatype="a";$("#sortcmb").html('<select name="mediafilter" id="mediafilter" class="select2" style="width:136px;" onchange="doMediaFilter(this);"><option value="a" selected="selected">'+t("all")+'</option><option value="i">'+t("photos")+'</option><option value="v">'+t("videos")+"</option></select>");$(".select2").selectbox();$("#srchtxt").val("");$("#fromtxt").html("");$("#fromtxt").attr("data-cal","");$("#totxt").html("");$("#totxt").attr("data-cal","");globtxtsrch="";globkeysrch="";currentPage=0;$("#catimagecontainer").css("opacity",0);$.post(ReturnLink("/ajax/ajax_getpiccatalog.php"),{catid:"",currentPage:currentPage,txtsrch:globtxtsrch,globkeysrch:globkeysrch,mediatype:mediatype},function(b){$("#catsubcontainer").html(b);refreshEditImg();refreshMediaCount();initDocument();refreshMediaCatalogs()})});$(document).on("click","#catpagego",function(){var b=$("#catpagevaluetxt").val();if(b!=""){var c=parseInt($("#catPagecount").attr("data-count"));b=parseInt(b);if(b>c){b=c}if(b<=0){b=1}$(".overlay-loading-fix").show();if(parseInt($("#catselected").attr("data-val"))==2){$("#catselected").click()}ct_id="";if(catalogpressed!=""){ct_id=catalogpressed.parent().attr("id")}removeButSelectedMenu();currentPage=b-1;$("#catimagecontainer").css("opacity",0);getMediaImages()}});$(document).on("click","#catmenucontent ul li .clickMN",function(){$(".overlay-loading-fix").show();if(parseInt($("#catselected").attr("data-val"))==2){$("#catselected").click()}removeButSelectedMenu();$("#srchtxt").val("");$("#fromtxt").html("");$("#fromtxt").attr("data-cal","");$("#totxt").html("");$("#totxt").attr("data-cal","");$("#catmenucontent ul li .txtMN").removeClass("active");$("#catmenucontent ul li .txtMN").removeClass("active1");catalogpressed=$(this);$(this).addClass("active");ct_id=$(this).parent().attr("id");currentPage=0;globtxtsrch="";globkeysrch="";$("#catimagecontainer").css("opacity",0);frtxt="";totxt="";mediatype="a";$("#sortcmb").html('<select name="mediafilter" id="mediafilter" class="select2" style="width:136px;" onchange="doMediaFilter(this);"><option value="a" selected="selected">'+t("all")+'</option><option value="i">'+t("photos")+'</option><option value="v">'+t("videos")+"</option></select>");$(".select2").selectbox();getMediaImages()});Calendar.setup({inputField:"fromtxt",noScroll:true,trigger:"frombut",align:"B",onSelect:function(){var b=Calendar.intToDate(this.selection.get());TO_CAL.args.min=b;TO_CAL.redraw();$("#fromtxt").attr("data-cal",Calendar.printDate(b,"%Y-%m-%d"));addCalTo(this);this.hide()},dateFormat:"%d-%m-%Y"});TO_CAL=Calendar.setup({inputField:"totxt",noScroll:true,trigger:"tobut",align:"B",onSelect:function(b){var c=Calendar.intToDate(this.selection.get());$("#totxt").attr("data-cal",Calendar.printDate(c,"%Y-%m-%d"));addCalTo(this);this.hide()},dateFormat:"%d-%m-%Y"});$("#catselectall").click(function(){$("#catimagecontainer ul li").addClass("active");addButSelectedMenu();$("#catselected").html(t("Show Selected"));$("#catselected").attr("data-val",1);$("#catselected").addClass("inactive")});$("#catselected").click(function(){if(!$(this).hasClass("inactive")){var b=parseInt($(this).attr("data-val"));if(b==1){$("#catselectall").addClass("inactive");$(this).attr("data-val",2);$("#catselected").html(t("show all"));$("#catimagecontainer ul li").each(function(){if(!$(this).hasClass("active")){$(this).hide()}})}else{$("#catselectall").removeClass("inactive");$("#catselected").html(t("show selected"));$(this).attr("data-val",1);$("#catimagecontainer ul li").show()}}});$("#catunselected").click(function(){if(!$(this).hasClass("inactive")){if(parseInt($("#catselected").attr("data-val"))==2){$("#catselected").click()}removeButSelectedMenu();$("#catimagecontainer ul li").removeClass("active");$("#catimagecontainer ul li").find(".clsimg").hide();$("#catimagecontainer ul li").find(".albumimg").hide()}});$(document).on("mouseover","#catmenucontent ul li .txtMN",function(){$(this).addClass("active1");var b=$(this).offset().left-$("#catmenucontent").offset().left+17;var c=$(this).offset().top-$("#catmenucontent").offset().top+30;$(".albumMenuOver .albumMenuOverin").html($(this).find("span").html());$(".albumMenuOver").css("left",b+"px");$(".albumMenuOver").css("top",c+"px");$(".albumMenuOver").stop().show()});$(document).on("mouseout","#catmenucontent ul li .txtMN",function(){$(this).removeClass("active1");$(".albumMenuOver").hide()});$(document).on("mouseover",".albumMenuOver",function(){$(".albumMenuOver").show()});$(document).on("mouseout",".albumMenuOver",function(){$(".albumMenuOver").hide()});$(document).on("mouseover","#catAllplus",function(){$("#catAllplusover").show()});$(document).on("mouseout","#catAllplus",function(){$("#catAllplusover").hide()});$(document).on("mouseover","#catmenucontent ul li .editMN",function(){$("#editMNover").css("top",($(this).parent().offset().top-$("#catmenu").offset().top+36)+"px");$("#editMNover").show()});$(document).on("mouseout","#catmenucontent ul li .editMN",function(){$("#editMNover").hide()});$(document).on("mouseover","#catmenucontent ul li .clsMN",function(){$("#clsMNover").css("top",($(this).parent().offset().top-$("#catmenu").offset().top+33)+"px");$("#clsMNover").show()});$(document).on("mouseout","#catmenucontent ul li .clsMN",function(){$("#clsMNover").hide()});$(document).on("click","#catmenucontent ul li .clsMN",function(){$this=$(this);TTAlert({msg:t("are you sure you want to remove permanently this album?<br/>this action cannot be undone."),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(d){if(d){$(".overlay-loading-fix").show();var b=1;var c=$this.closest("li");var e=c.attr("id");$.post(ReturnLink("/ajax/ajax_catalogdelete.php"),{id:e,albumcontents:b},function(f){$(".slectcateg_select").find("#"+e).remove();if(c.find(".txtMN").hasClass("active")||b==1){$("#catAllmenu").click()}else{refreshMediaCount();refreshMediaCatalogs()}c.remove()})}}})});$(document).on("click",".UploadMediaLeftTF .privacyclass",function(){$(".privacyclass",$(this).parent().parent()).removeClass("active");$(this).addClass("active");var c=parseInt($(this).attr("data-value"));var b=$(this).parent().parent().parent();$(".uploadinfomandatory span",b).html("");switch(c){case USER_PRIVACY_PRIVATE:initResetSelectedUsers($(this).closest(".tableform").find(".peoplecontainer_custom"));$(".uploadinfomandatory",b).addClass("inactive");$(".uploadinfomandatorytitle",b).removeClass("inactive");break;case USER_PRIVACY_SELECTED:$(this).closest(".tableform").find(".peoplecontainer_custom").show();$(".uploadinfomandatory",b).addClass("inactive");$(".uploadinfomandatorytitle",b).removeClass("inactive");$(".uploadinfomandatorycategory",b).removeClass("inactive");$(".uploadinfomandatorycountry",b).removeClass("inactive");$(".uploadinfomandatorycitynameaccent",b).removeClass("inactive");break;default:initResetSelectedUsers($(this).closest(".tableform").find(".peoplecontainer_custom"));$(".uploadinfomandatory",b).addClass("inactive");$(".uploadinfomandatorytitle",b).removeClass("inactive");$(".uploadinfomandatorycategory",b).removeClass("inactive");$(".uploadinfomandatorycountry",b).removeClass("inactive");$(".uploadinfomandatorycitynameaccent",b).removeClass("inactive");break}});$(document).on("click","#uploadlistpopuppublishalbum #loglistalbumelected .ClearNewAlbumButton",function(){$(".fancybox-close").click()});$(document).on("click","#uploadlistpopuppublishalbum .UploadMediaRightTF #log_save_media",function(){var d="uploadlistpopuppublishalbum";if(verifyFormList(d)){var c=$(this).closest(".tableform");var f=c.find(".privacyclass.active").attr("data-value");var e=new Array();if(f==USER_PRIVACY_SELECTED){c.find(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var g=$(this);if(g.attr("id")=="friendsdata"){e.push({friends:1})}else{if(g.attr("id")=="friends_of_friends_data"){e.push({friends_of_friends:1})}else{if(g.attr("id")=="followersdata"){e.push({followers:1})}else{if(parseInt(g.attr("data-id"))!=0){e.push({id:g.attr("data-id")})}}}}})}if((f==USER_PRIVACY_SELECTED&&e.length==0)){c.find(".error_valid").html(t("Invalid privacy data"));return}var b=$(this);$.post(ReturnLink("/ajax/profile_media_save.php"),{privacyValue:f,privacyArray:e,vid:$("#uploadlistpopuppublishalbum").attr("data-id"),title:getObjectData($("#"+d+" input[name=title]")),cityname:$("#"+d+" input[name=cityname]").val(),cityid:$("#"+d+" input[name=cityname]").attr("data-id"),citynameaccent:$("#"+d+" input[name=citynameaccent]").val(),is_public:$("#"+d+" div.privacyclass.active").attr("data-value"),description:getObjectData($("#"+d+" textarea[name=description]")),category:$("#"+d+" select[name=category] option:selected").val(),placetakenat:getObjectData($("#"+d+" input[name=placetakenat]")),keywords:getObjectData($("#"+d+" input[name=keywords]")),country:$("#"+d+" select[name=country] option:selected").val(),location:$("#"+d+" input[name=location]").val()},function(g){if(g!=false){$(".fancybox-close").click()}})}});$(document).on("click","#uploadlistpopuppublishalbum .UploadMediaRightTF #loglistalbumelectedsave",function(){var d="uploadlistpopuppublishalbum";if(verifyFormList(d)){var c=$(this).closest(".tableform");var f=c.find(".privacyclass.active").attr("data-value");var e=new Array();if(f==USER_PRIVACY_SELECTED){c.find(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var g=$(this);if(g.attr("id")=="friendsdata"){e.push({friends:1})}else{if(g.attr("id")=="friends_of_friends_data"){e.push({friends_of_friends:1})}else{if(g.attr("id")=="followersdata"){e.push({followers:1})}else{if(parseInt(g.attr("data-id"))!=0){e.push({id:g.attr("data-id")})}}}}})}if((f==USER_PRIVACY_SELECTED&&e.length==0)){c.find(".error_valid").html(t("Invalid privacy data"));return}var b=$(this);$.post(ReturnLink("/ajax/ajax_updatealbumupload.php"),{privacyValue:f,privacyArray:e,catalog_id:$("#uploadlistpopuppublishalbum").attr("data-id"),title:getObjectData($("#"+d+" input[name=title]")),cityname:$("#"+d+" input[name=cityname]").val(),cityid:$("#"+d+" input[name=cityname]").attr("data-id"),citynameaccent:$("#"+d+" input[name=citynameaccent]").val(),is_public:$("#"+d+" div.privacyclass.active").attr("data-value"),description:getObjectData($("#"+d+" textarea[name=description]")),category:$("#"+d+" select[name=category] option:selected").val(),placetakenat:getObjectData($("#"+d+" input[name=placetakenat]")),keywords:getObjectData($("#"+d+" input[name=keywords]")),country:$("#"+d+" select[name=country] option:selected").val(),location:$("#"+d+" input[name=location]").val()},function(g){if(g!=false){$("#catmenucontent ul").find("#"+$("#uploadlistpopuppublishalbum").attr("data-id")).find(".txtMN span").html(getObjectData($("#"+d+" input[name=title]")));$(".slectcateg_select").find("#"+$("#uploadlistpopuppublishalbum").attr("data-id")).html(getObjectData($("#"+d+" input[name=title]")));$(".fancybox-close").click()}})}});calldragslectitem();initDocument()});function initDocument(){if($("#paging_content").length>0){$("#paging_content").css("width",(($("#paging_content").height()/17)*288)+"px");$("#paging_content").css("width",($("#paging_content ul li").last().offset().left-$("#paging_content ul").offset().left+$("#paging_content ul li").last().width()+3)+"px");$("#paging_content ul").css("height","17px");$("#paging_content ul").css("left",$("#catsubcontainer").attr("data-left")+"px");var a=($(".paging_content_item.active").offset().left-$("#paging_content ul").offset().left+parseInt($("#catsubcontainer").attr("data-left"))+$(".paging_content_item.active").width()+3);if(a>290){var b=($(".paging_content_item.active").offset().left-$("#paging_content ul").offset().left+$(".paging_content_item.active").width()+3);var c=286-b;if(c>0){c=0}$("#paging_content ul").css("left",c+"px");$("#catsubcontainer").attr("data-left",c)}else{if(a<16){var c=-($(".paging_content_item.active").offset().left-$("#paging_content ul").offset().left);if(c>0){c=0}$("#paging_content ul").css("left",c+"px");$("#catsubcontainer").attr("data-left",c)}}}}function refreshWindow(){var b=1220;var a=b-490;var c=Math.floor(a/146);$("#catsubcontainer").css("width",(c*146)+"px");$("#catHeader").css("width",((c*146)-1)+"px");$("#catcontainer").css("width",(c*146+260)+"px");$(".scroll-panemenu").jScrollPane({showArrows:true});$(".scroll-panemenu .jspVerticalBar").css("right",0+"px");$("#catcontainer").css("opacity",1)}$(window).keydown(function(a){keypressed=a.keyCode});$(window).keyup(function(a){keypressed=0});function calldragslectitem(){refreshWindow();$("#catimagecontainer ul li .selectitem").click(function(){$(this).off("mousemove");$(this).unbind("mousemove");if(dragbool){dragbool=false;return}if(keypressed==16){if(indexpressed!=-1){var d=indexpressed;var b=$(this).parent().index();if(d>b){d=b;b=indexpressed}for(var a=d;a<=b;a++){var c=$("#catimagecontainer ul li").eq(a);$(c).addClass("active")}}else{indexpressed=$(this).parent().index();$(this).parent().addClass("active")}}else{if($(this).parent().hasClass("active")){$(this).parent().removeClass("active")}else{$(this).parent().addClass("active")}indexpressed=$(this).parent().index();addButSelectedMenu();if($(this).parent().parent().find(".active").length==0){indexpressed=-1;if(parseInt($("#catselected").attr("data-val"))==2){$("#catselected").click()}removeButSelectedMenu()}}});$("#catimagecontainer ul li .selectitem").mouseover(function(){showOverPic($(this).parent())});$("#catimagecontainer ul li .clsimg, #catimagecontainer ul li .mediabuttons").mouseover(function(){showOverPic($(this).parent().parent());var a=$(this).offset().left-$("#ProfileHeaderInternal").offset().left-252;var b=$(this).offset().top-$("#ProfileHeaderInternal").offset().top-21;$(".ProfileHeaderOver .ProfileHeaderOverin").html($(this).attr("data-title"));$(".ProfileHeaderOver").css("left",a+"px");$(".ProfileHeaderOver").css("top",b+"px");$(".ProfileHeaderOver").stop().show()});$("#catimagecontainer ul li .selectitem, #catimagecontainer ul li .clsimg, #catimagecontainer ul li .mediabuttons").mouseout(function(){hideOverPic($(this).parent().parent());$(".ProfileHeaderOver").hide()});$("#catimagecontainer ul li .selectitem").mousedown(function(){frsposx=$(this).offset().left;frsposy=$(this).offset().top;$(this).bind("mousemove",movehid)});$("#catimagecontainer ul li .selectitem").mouseup(function(){dragbool=false;$(this).unbind("mousemove",movehid);$("#catimagecontainer ul li .hiddenimg").css("opacity",0)});$("#catimagecontainer ul li .hiddenimg").draggable({containment:"window",stack:"#catimagecontainer",cursor:"move",stop:dostopdrag,revert:true});calldroppableslectitem()}function movehid(b){var a=$(b.currentTarget);if(Math.abs(a.offset().left-frsposx)>50||Math.abs(a.offset().top-frsposy)>50){if(a.parent().hasClass("active")){a.parent().find(".hiddenimg .dragiconimg").html($("#catimagecontainer ul li.active").length);a.parent().find(".hiddenimg").css("opacity",1);dragbool=true}}}function dostopdrag(){$("#catimagecontainer ul li .selectitem").unbind("mousemove",movehid);$("#catimagecontainer ul li .hiddenimg").css("opacity",0)}function calldroppableslectitem(){$("#catmenucontent ul li .txtMN").droppable({accept:"#catimagecontainer ul li .hiddenimg",hoverClass:"active1",drop:handleCardDrop})}function addCalTo(a){if(new Date($("#fromtxt").attr("data-cal"))>new Date($("#totxt").attr("data-cal"))){$("#totxt").attr("data-cal",$("#fromtxt").attr("data-cal"));$("#totxt").html($("#fromtxt").html())}}function changeFilter(a){$("#srchtxt").val("");$("#fromtxt").html("");$("#fromtxt").attr("data-cal","");$("#totxt").html("");$("#totxt").attr("data-cal","");if(parseInt($(a).val())==2){$("#searchinput").hide();$(".calbut").show();$(".caltxt").show()}else{$(".calbut").hide();$(".caltxt").hide();$("#searchinput").show()}}function showOverPic(a){if(!dragbool){a.find(".mediabuttonsspace").show();a.find(".mediabuttons").show()}}function hideOverPic(a){a.find(".mediabuttonsspace").hide();a.find(".mediabuttons").hide()}function addButSelectedMenu(){$("#catselected").removeClass("inactive");$("#catunselected").removeClass("inactive");$("#cataddselected").removeClass("inactive");$("#cataddselected").addClass("cataddselected")}function removeButSelectedMenu(){$("#catselected").addClass("inactive");$("#catunselected").addClass("inactive");$("#cataddselected").addClass("inactive");$("#cataddselected").removeClass("cataddselected")}function addValue(a,b){if($(a).attr("value")==""){$(a).attr("value",b)}}function removeValue(a,b){if($(a).attr("value")==b){$(a).attr("value","")}}function addValue1(a){if($(a).attr("value")==""){$(a).attr("value",$(a).attr("data-val"))}}function removeValue1(a){if($(a).attr("value")==$(a).attr("data-val")){$(a).attr("value","")}}function checkSubmit(a){if(a&&a.keyCode==13){$("#searchbut").click()}}function checkSubmitcatadd(a){if(a&&a.keyCode==13){$("#cataddbut").click()}}function checkSubmitcataddto(a){if(a&&a.keyCode==13){$("#cataddtobut").click()}}function checkSubmitcatedit(a){if(a&&a.keyCode==13){$("#cateditbut").click()}}function checkSubmitcateditimg(a){if(a&&a.keyCode==13){$("#cateditimgbut").click()}}function checkSubmitcatpagevalue(a){if(a&&a.keyCode==13){$("#catpagego").click()}else{return isNumberKey(a)}}function isNumberKey(b){var a=(b.which)?b.which:b.keyCode;if(a>31&&(a<48||a>57)){return false}return true}function enableSelectBoxes(){}function enableSelectBoxes2(a){}function handleCardDrop(b,g){dragbool=true;$(".overlay-loading-fix").show();var d=$(this).parent();var f=d.attr("id");var a=g.draggable.parent().attr("id");g.draggable.parent().find(".hiddenimg").css("opacity",0);var e=$("#catimagecontainer ul li.active").length;var c=new Array();$("#catimagecontainer ul li.active").each(function(){var h=$(this).attr("id");c.push(h)});$.ajax({url:ReturnLink("/ajax/ajax_addpiccatalog.php"),type:"post",data:{catid:f,idarr:c.join("/*/")},success:function(h){document.location.href=ReturnLink("/album-manage/"+ct_id)},error:function(j,h,i){}})}function addListenerClose(){$("#catimagecontainer ul li .clsimg").click(function(){var b=$(this).parent().parent();var c="photo";if(b.find(".photovideoicon").attr("data-type")=="v"){c="video"}var a=new Array(c,"<br/>");TTAlert({msg:sprintf(t("are you sure you want to remove permanently this %s ? %s this action cannot be undone."),a),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(d){if(d){$(".overlay-loading-fix").show();var e=new Array();var f=b.attr("id");e.push(f);$.post(ReturnLink("/ajax/ajax_deletepicDB.php"),{idarr:e.join("/*/")},function(g){ct_id="";refreshMediaCount();getMediaImages()})}}});hideOverPic($(this).parent())});$("#catimagecontainer ul li .albumimg").click(function(){var a=$(this).parent().parent();TTAlert({msg:t("confirm to set album icon"),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(c){if(c){$(".overlay-loading-fix").show();var d=a.attr("id");var b=catalogpressed.parent().attr("id");$.post(ReturnLink("/ajax/ajax_addalbumicon.php"),{catid:b,id:d},function(e){$(".overlay-loading-fix").hide()})}}});hideOverPic($(this).parent())});$(".paging_content_item").click(function(){var a=$(this).attr("data-id");var b=parseInt($("#catPagecount").attr("data-count"));a=parseInt(a);if(a>b){a=b}if(a<=0){a=1}$(".overlay-loading-fix").show();if(parseInt($("#catselected").attr("data-val"))==2){$("#catselected").click()}ct_id="";if(catalogpressed!=""){ct_id=catalogpressed.parent().attr("id")}removeButSelectedMenu();currentPage=a-1;$("#catimagecontainer").css("opacity",0);getMediaImages()});$("#paging_container_last").click(function(){if(currentPage>=parseInt($("#catPagecount").attr("data-count"))-1){return}var a=$("#catPagecount").attr("data-count");a=parseInt(a);if(a<=0){a=1}$(".overlay-loading-fix").show();if(parseInt($("#catselected").attr("data-val"))==2){$("#catselected").click()}ct_id="";if(catalogpressed!=""){ct_id=catalogpressed.parent().attr("id")}removeButSelectedMenu();currentPage=a-1;$("#catimagecontainer").css("opacity",0);getMediaImages()});$("#paging_container_first").click(function(){if(parseInt($("#catPagecount").attr("data-page"))<=0){return}var a=1;a=parseInt(a);if(a<=0){a=1}$(".overlay-loading-fix").show();if(parseInt($("#catselected").attr("data-val"))==2){$("#catselected").click()}ct_id="";if(catalogpressed!=""){ct_id=catalogpressed.parent().attr("id")}removeButSelectedMenu();currentPage=a-1;$("#catimagecontainer").css("opacity",0);getMediaImages()});$("#paging_container_next").click(function(){if(!$(this).hasClass("inactive")&&currentPage<(parseInt($("#catPagecount").attr("data-count"))-1)){$(".overlay-loading-fix").show();if(parseInt($("#catselected").attr("data-val"))==2){$("#catselected").click()}removeButSelectedMenu();currentPage++;if(currentPage>parseInt($("#catPagecount").attr("data-count"))-1){currentPage=parseInt($("#catPagecount").attr("data-count"))-1}ct_id="";if(catalogpressed!=""){ct_id=catalogpressed.parent().attr("id")}$("#catimagecontainer").css("opacity",0);getMediaImages()}});$("#paging_container_prev").click(function(){if(!$(this).hasClass("inactive")&&currentPage>0){$(".overlay-loading-fix").show();if(parseInt($("#catselected").attr("data-val"))==2){$("#catselected").click()}removeButSelectedMenu();currentPage--;if(currentPage<0){currentPage=0}ct_id="";if(catalogpressed!=""){ct_id=catalogpressed.parent().attr("id")}$("#catimagecontainer").css("opacity",0);getMediaImages()}})}function refreshEditCat(){$(".editMN").each(function(){var a=$(this);var b=$(this).closest("li").attr("id");a.fancybox({padding:0,margin:0,beforeLoad:function(){$("#uploadlistpopuppublishalbum").html("");$("#uploadlistpopuppublishalbum .inputuploadformTF").val("");$("#uploadlistpopuppublishalbum #logalbumaddcountry, #newphototo #logalbumaddcategory").val("0");$("#uploadlistpopuppublishalbum .inputuploaddescriptionTF").val("");$("#uploadlistpopuppublishalbum textarea[name=description]").blur();$("#uploadlistpopuppublishalbum input[name=placetakenat]").blur();$("#uploadlistpopuppublishalbum input[name=keywords]").blur();albumclicked=a.closest("li");CatalogEdit(b)}})});$(".clsimg_album").each(function(){var a=$(this);a.fancybox({padding:0,margin:0,beforeLoad:function(){$("#popup_delete_album_pic").attr("data-id",a.parent().parent().attr("id"));$("#popup_delete_album_pic .uploadinfocheckbox_remove3").removeClass("active");$("#popup_delete_album_pic .uploadinfocheckbox_remove4").removeClass("active")}})})}function editAlbumText(){$("#catedit #cateditbut").click(function(){var a=$(this).attr("data-id");if(a!=""){if($("#catedittxt").val()!=""&&$("#catedittxt").val()!="edit title..."){$(".overlay-loading-fix").show();var b=$("#catedittxt").val();var c="";if($("#catedittxt1").val()!=""&&$("#catedittxt1").val()!="edit location..."){c=$("#catedittxt1").val()}$.post(ReturnLink("/ajax/ajax_editcatalog.php"),{id:a,txedt:b,txedt1:c},function(d){$("#catmenucontent ul").find("#"+a).find(".txtMN span").html(b);$(".fancybox-close").click();$(".slectcateg_select").find("#"+a).html(b);$(".overlay-loading-fix").hide()})}}})}function editImageText(){$("#cateditimg #cateditimgbut").click(function(){var b=$(this).attr("data-id");if(b!=""){var a=0;if($("#cateditimgtxt").val()==""||$("#cateditimgtxt").val()=="title of the photo"){a=1;$("#cateditimginput").addClass("err")}else{$("#cateditimginput").removeClass("err")}if($("#cateditimgtxt1").val()==""||$("#cateditimgtxt1").val()=="add description..."){a=1;$("#cateditimginput1").addClass("err")}else{$("#cateditimginput1").removeClass("err")}if($("#slectcateditimg").val()==""){a=1;$("#slectcateditimg").addClass("err")}else{$("#slectcateditimg").removeClass("err")}if($("#cateditimgtxt2").val()==""||$("#cateditimgtxt2").val()=="edit location..."){a=1;$("#cateditimginput2").addClass("err")}else{$("#cateditimginput2").removeClass("err")}if($("#cateditimgtxt3").val()==""||$("#cateditimgtxt3").val()=="add keywords..."){a=1;$("#cateditimginput3").addClass("err")}else{$("#cateditimginput3").removeClass("err")}if(a==1){return}$(".overlay-loading-fix").show();var c=$("#cateditimgtxt2").val();if(c==$("#cateditimgtxt2").attr("data-val")){c=""}$.post(ReturnLink("/ajax/ajax_editimage.php"),{id:b,title:$("#cateditimgtxt").val(),desc:$("#cateditimgtxt1").val(),cat:$("#slectcateditimg").val(),place:c,keywords:$("#cateditimgtxt3").val()},function(d){$(".fancybox-close").click();$(".overlay-loading-fix").hide()})}})}function refreshEditImg(){$(".vidimg").fancybox({transitionIn:"none",transitionOut:"none",autoScale:false,autoDimensions:false,width:694,minWidth:694,maxWidth:694,height:442,minHeight:442,maxHeight:442,padding:0,margin:0,type:"iframe",scrolling:"no"});$(".photoimg").fancybox();$(".editimg").each(function(){var a=$(this);var b=$(this).closest("li").attr("id");a.fancybox({padding:0,margin:0,beforeLoad:function(){$("#uploadlistpopuppublishalbum").html("");$("#uploadlistpopuppublishalbum .inputuploadformTF").val("");$("#uploadlistpopuppublishalbum #logalbumaddcountry, #newphototo #logalbumaddcategory").val("0");$("#uploadlistpopuppublishalbum .inputuploaddescriptionTF").val("");$("#uploadlistpopuppublishalbum textarea[name=description]").blur();$("#uploadlistpopuppublishalbum input[name=placetakenat]").blur();$("#uploadlistpopuppublishalbum input[name=keywords]").blur();albumclicked=a.closest("li");MediaEditData(b)}})})}function CatalogEdit(a){$.post(ReturnLink("/ajax/ajax_getlistalbumuploaddata.php"),{id:a},function(b){if(b!=false){$("#uploadlistpopuppublishalbum").html(b);resetSelectedUsers($("#uploadlistpopuppublishalbum #addmoretext_privacy"));$("#uploadlistpopuppublishalbum input[name=title]").blur();$("#uploadlistpopuppublishalbum textarea[name=description]").blur();$("#uploadlistpopuppublishalbum input[name=placetakenat]").blur();$("#uploadlistpopuppublishalbum input[name=keywords]").blur();$("#uploadlistpopuppublishalbum .uploadinfocheckboxcontainer").remove();addAutoCompleteList("uploadlistpopuppublishalbum");$("#uploadlistpopuppublishalbum").attr("data-id",a);var c=parseInt($("#uploadlistpopuppublishalbum .formcontainer").attr("data-value"));$("#uploadlistpopuppublishalbum #privacyclass_user"+c).click();if(c==USER_PRIVACY_SELECTED){$("#uploadlistpopuppublishalbum").find(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var d=$(this);if(d.attr("id")=="friendsdata"){}else{if(d.attr("id")=="friends_of_friends_data"){}else{if(d.attr("id")=="followersdata"){}else{if(parseInt(d.attr("data-id"))!=0){SelectedUsersAdd(d.attr("data-id"))}}}}})}addmoreusersautocomplete_custom_journal($("#uploadlistpopuppublishalbum #addmoretext_privacy"))}})}function MediaEditData(a){$.post(ReturnLink("/ajax/profile_media_details.php"),{id:a},function(b){if(b!=false){$("#uploadlistpopuppublishalbum").html(b);resetSelectedUsers($("#uploadlistpopuppublishalbum #addmoretext_privacy"));$("#uploadlistpopuppublishalbum input[name=title]").blur();$("#uploadlistpopuppublishalbum textarea[name=description]").blur();$("#uploadlistpopuppublishalbum input[name=placetakenat]").blur();$("#uploadlistpopuppublishalbum input[name=keywords]").blur();$("#uploadlistpopuppublishalbum .uploadinfocheckboxcontainer").remove();addAutoCompleteList("uploadlistpopuppublishalbum");$("#uploadlistpopuppublishalbum").attr("data-id",a);var c=parseInt($("#uploadlistpopuppublishalbum .formcontainer").attr("data-value"));$("#uploadlistpopuppublishalbum #privacyclass_user"+c).click();if(c==USER_PRIVACY_SELECTED){$("#uploadlistpopuppublishalbum").find(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var d=$(this);if(d.attr("id")=="friendsdata"){}else{if(d.attr("id")=="friends_of_friends_data"){}else{if(d.attr("id")=="followersdata"){}else{if(parseInt(d.attr("data-id"))!=0){SelectedUsersAdd(d.attr("data-id"))}}}}})}addmoreusersautocomplete_custom_journal($("#uploadlistpopuppublishalbum #addmoretext_privacy"))}})}function initResetSelectedUsers(a){a.hide();resetSelectedUsers(a.find(".addmore input"));a.find(".uploadinfocheckbox").removeClass("active");a.find(".addmore input").val("");a.find(".addmore input").blur();a.find(".peoplesdata").each(function(){var b=$(this);b.remove()})}function verifyFormList(d){var c=true;var a=$("#"+d);$(".uploadinfomandatory span",a).html("");$("input,select,textarea",a).removeClass("err").each(function(){var f=$(this).attr("name");var e=$(this).parent();if((f=="location")||(f=="location_name")||(f=="cityname")||(f=="status")||(f=="vid")||$(this).hasClass("filevalue")||(f=="filename")||(f=="addmoretext")||(f=="vpath")){}else{if(($(".uploadinfomandatory"+f,e).css("display")!="none"&&getObjectData($(this))=="")||(f=="category"&&!$(".uploadinfomandatorycategory",e).hasClass("inactive")&&$(this).val()=="0")||(f=="country"&&!$(".uploadinfomandatorycountry",e).hasClass("inactive")&&$(this).val()=="0")){$(".uploadinfomandatory"+f+" span",e).html(t("please fill this field correctly"));c=false}}});var b=$("input[name=cityname]",a).parent();if(getObjectData($("input[name=cityname]",a))==""&&!$(".uploadinfomandatorycitynameaccent",b).hasClass("inactive")&&$("input[name=cityname]",a).length>0){$(".uploadinfomandatorycitynameaccent span",b).html(t("please fill this field correctly"));c=false}if(!c){return false}else{return true}}function addAutoCompleteList(b){var a=$("input[name=citynameaccent]",$("#"+b));a.autocomplete({appendTo:"#contentcontainer",search:function(e,f){var c=$("select[name=country]",a.parent()).removeClass("err");var d=$("option:selected",c).val();if(d=="ZZ"){c.addClass("err");e.preventDefault()}else{a.autocomplete("option","source",ReturnLink("/ajax/uploadGetCities.php?cc="+d))}},select:function(c,d){a.val(d.item.value);$("input[name=cityname]",a.parent()).val(d.item.value);$("input[name=cityname]",a.parent()).attr("data-id",d.item.id);c.preventDefault()}})}function doMediaFilter(a){$(".overlay-loading-fix").show();mediatype=$(a).val();if(parseInt($("#filterby").val())==3){$("#srchtxt").val("")}globtxtsrch=""+$("#srchtxt").val();currentPage=0;ct_id="";if(catalogpressed!=""){ct_id=catalogpressed.parent().attr("id")}frtxt="";totxt="";if(parseInt($("#filterby").val())==2){frtxt=$("#fromtxt").html();totxt=$("#totxt").html()}globkeysrch=""+$("#filterby").val();getMediaImages()}function getMediaImages(){$.post(ReturnLink("/ajax/ajax_getpiccatalog.php"),{catid:ct_id,currentPage:currentPage,txtsrch:globtxtsrch,globkeysrch:globkeysrch,mediatype:mediatype,frtxt:frtxt,totxt:totxt},function(a){$("#catsubcontainer").html(a);currentPage=$("#catPagecount").attr("data-page");calldragslectitem();addListenerClose();refreshEditCat();initDocument();$(".overlay-loading-fix").hide();refreshEditImg()})}function refreshMediaCount(){$.post(ReturnLink("/ajax/ajax_imagecount.php"),{},function(b){var a=new Array(""+b);$("#catAllnum").html(sprintf(t("MEDIA (%s)"),a))})}function refreshMediaCatalogs(){$.post(ReturnLink("/ajax/ajax_getsearchcatalog.php"),{txtsrch:""},function(a){$("#catmenucontent ul").html(a);$("#catAllmenu").html("MY ALBUMS ("+$("#catmenucontent ul li").length+")");$(".scroll-panemenu").jScrollPane({showArrows:true});$(".scroll-panemenu .jspVerticalBar").css("right",0+"px");if(catalogpressed!=""){$("#catmenucontent ul").find("#"+catalogpressed.parent().attr("id")).find(".clickMN").addClass("active");catalogpressed=$("#catmenucontent ul").find("#"+catalogpressed.parent().attr("id")).find(".clickMN")}calldragslectitem();addListenerClose();refreshEditCat();$(".overlay-loading-fix").hide()})};