var shareFadeoutTimeout;$(document).ready(function(){if(parseInt($(".hotelsContainer").attr("data-logged"))!=0){InitChannelUploaderHome("uploadReview_Img","menu1",15,0)}$(".hotel_infos_imgbig").fancybox({helpers:{overlay:{closeClick:true}}});$(document).on("click",".photoremove",function(c){var b=$(this).closest(".photoitems");var d=b.attr("data-id");TTAlert({msg:t("are you sure you want to remove permanently this image?"),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(e){if(e){$(".upload-overlay-loading-fix").show();$.ajax({url:ReturnLink("/ajax/remove_discover_image.php"),data:{id:d,entity_type:$(".hotelsContainer").attr("data-type")},type:"post",success:function(f){$(".upload-overlay-loading-fix").hide();var h=null;try{h=$.parseJSON(f)}catch(g){return}if(h.status=="error"){TTAlert({msg:h.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{b.remove()}}})}}})});$(document).on("click",".remove_button_rev",function(){var b=$(this).closest(".social_data_all");TTAlert({msg:t("are you sure you want to remove this review"),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(c){if(c){$.ajax({url:ReturnLink("/ajax/ajax_remove_review.php"),data:{id:b.attr("data-id"),data_type:$(".hotelsContainer").attr("data-type")},type:"post",success:function(d){$(".upload-overlay-loading-fix").hide();var f=null;try{f=$.parseJSON(d)}catch(e){return}if(f.status=="error"){TTAlert({msg:f.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{b.remove()}}})}}})});$(document).on("click",".review-buts2 a",function(b){b.preventDefault();if($(".share_link_holder").css("display")!="none"){$(".share_link_holder").hide();$(this).removeClass("active")}else{$(this).addClass("active");$(".share_link_holder").show();shareFadeoutTimeout=setTimeout(function(){$(".share_link_holder").hide();$(".review-buts2 a").removeClass("active")},1500);$(".share_link_holder").unbind("mouseenter mouseleave").hover(function(){clearTimeout(shareFadeoutTimeout);$(".share_link_holder").stop(true,true);$(".share_link_holder").show()},function(){shareFadeoutTimeout=setTimeout(function(){$(".share_link_holder").hide();$(".review-buts2 a").removeClass("active")},500)})}});$(document).on("click",".review-buts0 a",function(b){b.preventDefault();$(".view-review").removeClass("active");$(this).addClass("active");$("#menu1").hide();$("#home").show()});$(document).on("click",".review-buts1 a",function(b){b.preventDefault();$(".view-review").removeClass("active");$(this).addClass("active");$("#home").hide();$("#menu1").show()});var a=parent.window.returnIframeDimensions();$(".showOnMap").fancybox({width:a[0],height:a[1],closeBtn:true,autoSize:false,autoScale:true,transitionIn:"elastic",transitionOut:"fadeOut",type:"iframe",padding:0,margin:0,scrolling:"no",helpers:{overlay:{closeClick:true}}});$(document).on("click",".addtomychannelBut",function(){var b=$("#channel_code").val();if(b==""){TTAlert({msg:t("please select one of your channels..."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}var c=$(".hotelsContainer").attr("data-id");var d=$(".hotelsContainer").attr("data-type");$(".upload-overlay-loading-fix").show();$.ajax({url:ReturnLink("/ajax/ajax_add_discover_tochannel.php"),data:{id:c,data_type:d,channel_id:b},type:"post",success:function(e){$(".upload-overlay-loading-fix").hide();var g=null;try{g=$.parseJSON(e)}catch(f){return}if(g.status=="error"){TTAlert({msg:g.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{$("#channel_code").find("#channel_code"+b).remove()}}})});$(document).on("click",".specificRate .eval_options_glob",function(){var b=$(this).index();if(parseInt($(".hotelsContainer").attr("data-logged"))===0){TTAlert({msg:t("you need to have a")+' <a class="black_link" href="'+ReturnLink("/register")+'">'+t("TT account")+"</a> "+t("in order to evaluate."),type:"action",btn1:t("cancel"),btn2:t("register"),btn2Callback:function(f){if(f){window.location.href=ReturnLink("/register")}}});return}var d=$(this);var c=d.closest(".specificRate");var e=$(this).attr("data-value");TTCallAPI({what:ReturnLink("/ajax/modal_newsfeed_rate.php"),data:{entity_id:$(".hotelsContainer").attr("data-id"),entity_type:c.attr("data-type"),score:e,globchannelid:null},ret:"json",callback:function(f){if(f.status=="error"){TTAlert({msg:f.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}c.find(".eval_options_glob").removeClass("active");d.addClass("active");c.find(".eval_options_glob").each(function(){var g=$(this).index();if(g<=b){$(this).addClass("active")}else{$(this).removeClass("active")}})}})});$(".revThemesOption span").click(function(){if(parseInt($(".hotelsContainer").attr("data-logged"))===0){TTAlert({msg:t("you need to have a")+' <a class="black_link" href="'+ReturnLink("/register")+'">'+t("TT account")+"</a> "+t("in order to select themes."),type:"action",btn1:t("cancel"),btn2:t("register"),btn2Callback:function(b){if(b){window.location.href=ReturnLink("/register")}}});return}$(this).toggleClass("active")});$(document).on("click",".submitReview",function(){if(parseInt($(".hotelsContainer").attr("data-logged"))===0){TTAlert({msg:t("you need to have a")+' <a class="black_link" href="'+ReturnLink("/register")+'">'+t("TT account")+"</a> "+t("in order to add reviews."),type:"action",btn1:t("cancel"),btn2:t("register"),btn2Callback:function(i){if(i){window.location.href=ReturnLink("/register")}}});return}var h=$(".rev_description").val();var f=new Array();var c=$(".rev_select").val();var d=new Array();var b=($(".certify.active").length==1);if(h===""){TTAlert({msg:t("Your review cannot be empty !"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(!b){TTAlert({msg:t("Your have to certify that this review is based on your own experience !"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}$(".revThemesOption.active").each(function(i){f.push($(this).attr("data-value"))});var g=f.join(",");$(".whatnear.active").each(function(i){var j=$(this).attr("data-value");d.push(j)});var e=d.join(",");$.ajax({url:ReturnLink("/ajax/ajax_add_review.php"),data:{id:$(".hotelsContainer").attr("data-id"),data_type:$(".hotelsContainer").attr("data-type"),txt:h,themes:g,date:c,near:e},type:"post",success:function(i){$(".upload-overlay-loading-fix").hide();var k=null;try{k=$.parseJSON(i)}catch(j){return}if(k.status=="error"){TTAlert({msg:k.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{TTAlert({msg:k.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:function(l){location.reload()}})}}})});$(document).on("mouseover",".specificRate .eval_options_glob",function(){var c=$(this).attr("data-text");var b=$(this).parent();b.find(".eval_options_over .eval_options_overtxt").html(c);b.find(".eval_options_over").show()});$(document).on("mouseout",".specificRate .eval_options_glob",function(){var b=$(this).parent();b.find(".eval_options_over").hide()});$(document).on("click",".review1 .opt",function(){if($(this).hasClass("active")){$(this).removeClass("active")}else{$(this).addClass("active")}});$(".slider-for").slick({slidesToShow:1,slidesToScroll:1,arrows:false,fade:true,asNavFor:".slider-nav"});$(".slider-nav").slick({slidesToShow:4,slidesToScroll:1,appendArrows:".slider-for",asNavFor:".slider-for",dots:false,centerMode:true,focusOnSelect:true});$(window).resize(function(){setTimeout(function(){updateGallery()},1000)});updateGallery()});function updateGallery(){$(".slider-for").removeClass("opacity0");$(".slider-for .slick-track .slick-slide").each(function(){var a=$(this);var g=a.width();var f=a.height();var c=$(".slider-for").width();var b=$(".slider-for").height();var e=0;var d=0;if(f<b){e=Math.round((b-f)/2)}if(g<c){d=Math.round((c-g)/2)}a.css("margin-top",e);a.css("margin-left",d)})}function updateImage(c,b,a){if(a=="uploadReview_Img"){$.ajax({url:ReturnLink("/ajax/add_discover_image.php"),data:{item_id:$(".hotelsContainer").attr("data-id"),filename:userGlobalDISName()+""+b,entity_type:$(".hotelsContainer").attr("data-type")},type:"post",success:function(d){$(".upload-overlay-loading-fix").hide();var f=null;try{f=$.parseJSON(d)}catch(e){return}if(f.status==="error"){TTAlert({msg:f.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}$(".yourPhotosContainer").prepend('<div class="col-xs-4 col-sm-4 col-md-3 col-lg-3 photoitems" data-id="'+f.id+'"><div class="photoremove">X remove</div><img src="'+ReturnLink("media/discover/thumb/"+userGlobalDISName()+b)+'" class="width100"/></div>')}})}closeFancyBox()};