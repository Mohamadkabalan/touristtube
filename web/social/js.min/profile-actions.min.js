var searchdescriptiontext="for better visibility and online search, please fill here";var albumclicked="";$(document).ready(function(){$("#container").on("click","div.DeleteAction",function(){var c=$(this).attr("rel");var b=t("are you sure you want to remove permanently this media?<br/>this action cannot be undone.");if(pagename=="videos"){b="are you sure you want to remove permanently this video?<br/>this action cannot be undone."}else{if(pagename=="photos"){b="are you sure you want to remove permanently this photo?<br/>this action cannot be undone."}}var a=$(this).closest(".element");TTAlert({msg:t(b),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(d){if(d){MediaDelete(c,a)}}})}).on("click","div.DeleteFavAction",function(){var a=$(this).attr("rel");TTAlert({msg:t("Really Delete Favorite?"),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(b){if(b){FavoriteDelete(a)}}})}).on("click","div.DeleteFavCamAction",function(){var a=$(this).attr("rel");TTAlert({msg:t("Really Delete Favorite?"),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(b){if(b){FavoriteCamDelete(a)}}})}).on("click","div.DeleteCatalogAction",function(){var b=$(this).attr("rel");var a=$(this).closest(".element_album");TTAlert({msg:t("are you sure you want to remove permanently this album?<br/>this action cannot be undone."),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(c){if(c){CatalogDelete(b,a)}}})});refreshEditMedia();refreshEditAlbums();$(document).on("click",".UploadMediaLeftTF .privacyclass",function(){$(".privacyclass",$(this).parent().parent()).removeClass("active");$(this).addClass("active");var b=parseInt($(this).attr("data-value"));var a=$(this).parent().parent().parent();$(".uploadinfomandatory span",a).html("");switch(b){case USER_PRIVACY_PRIVATE:initResetSelectedUsers($(this).closest(".tableform").find(".peoplecontainer_custom"));$(".uploadinfomandatory",a).addClass("inactive");$(".uploadinfomandatorytitle",a).removeClass("inactive");break;case USER_PRIVACY_SELECTED:$(this).closest(".tableform").find(".peoplecontainer_custom").show();$(".uploadinfomandatory",a).addClass("inactive");$(".uploadinfomandatorytitle",a).removeClass("inactive");$(".uploadinfomandatorycategory",a).removeClass("inactive");$(".uploadinfomandatorycountry",a).removeClass("inactive");$(".uploadinfomandatorycitynameaccent",a).removeClass("inactive");break;default:initResetSelectedUsers($(this).closest(".tableform").find(".peoplecontainer_custom"));$(".uploadinfomandatory",a).addClass("inactive");$(".uploadinfomandatorytitle",a).removeClass("inactive");$(".uploadinfomandatorycategory",a).removeClass("inactive");$(".uploadinfomandatorycountry",a).removeClass("inactive");$(".uploadinfomandatorycitynameaccent",a).removeClass("inactive");break}});$(document).on("click","#uploadlistpopuppublishalbum #loglistalbumelected .ClearNewAlbumButton",function(){$(".fancybox-close").click()});$(document).on("click","#uploadlistpopuppublishalbum .UploadMediaRightTF #loglistalbumelectedsave",function(){var c="uploadlistpopuppublishalbum";if(verifyFormList(c)){var b=$(this).closest(".tableform");var e=b.find(".privacyclass.active").attr("data-value");var d=new Array();if(e==USER_PRIVACY_SELECTED){b.find(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var f=$(this);if(f.attr("id")=="friendsdata"){d.push({friends:1})}else{if(f.attr("id")=="friends_of_friends_data"){d.push({friends_of_friends:1})}else{if(f.attr("id")=="followersdata"){d.push({followers:1})}else{if(parseInt(f.attr("data-id"))!=0){d.push({id:f.attr("data-id")})}}}}})}if((e==USER_PRIVACY_SELECTED&&d.length==0)){b.find(".error_valid").html(t("Invalid privacy data"));return}var a=$(this);$.post(ReturnLink("/ajax/ajax_updatealbumupload.php"),{privacyValue:e,privacyArray:d,catalog_id:$("#uploadlistpopuppublishalbum").attr("data-id"),title:getObjectData($("#"+c+" input[name=title]")),cityname:$("#"+c+" input[name=cityname]").val(),cityid:$("#"+c+" input[name=cityname]").attr("data-id"),citynameaccent:$("#"+c+" input[name=citynameaccent]").val(),is_public:$("#"+c+" div.privacyclass.active").attr("data-value"),description:getObjectData($("#"+c+" textarea[name=description]")),category:$("#"+c+" select[name=category] option:selected").val(),placetakenat:getObjectData($("#"+c+" input[name=placetakenat]")),keywords:getObjectData($("#"+c+" input[name=keywords]")),country:$("#"+c+" select[name=country] option:selected").val(),location:$("#"+c+" input[name=location]").val()},function(f){if(f!=false){albumclicked.find(".sorttilte").html($("#"+c+" input[name=title]").val());var g=getObjectData($("#"+c+" textarea[name=description]"));var j=g.replace(/\\n|\n/g,"<br />");var h=j.substring(0,100);var i=j.substring(0,80);if(j.length>100){h+="..."}if(j.length>80){i+="..."}albumclicked.find(".mediainfodesc1").html(h);albumclicked.find(".mediainfodesc").html(i);$(".fancybox-close").click()}})}});$(document).on("click","#uploadlistpopuppublishalbum .UploadMediaRightTF #log_save_media",function(){var c="uploadlistpopuppublishalbum";if(verifyFormList(c)){var b=$(this).closest(".tableform");var e=b.find(".privacyclass.active").attr("data-value");var d=new Array();if(e==USER_PRIVACY_SELECTED){b.find(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var f=$(this);if(f.attr("id")=="friendsdata"){d.push({friends:1})}else{if(f.attr("id")=="friends_of_friends_data"){d.push({friends_of_friends:1})}else{if(f.attr("id")=="followersdata"){d.push({followers:1})}else{if(parseInt(f.attr("data-id"))!=0){d.push({id:f.attr("data-id")})}}}}})}if((e==USER_PRIVACY_SELECTED&&d.length==0)){b.find(".error_valid").html(t("Invalid privacy data"));return}var a=$(this);$.post(ReturnLink("/ajax/profile_media_save.php"),{privacyValue:e,privacyArray:d,vid:$("#uploadlistpopuppublishalbum").attr("data-id"),title:getObjectData($("#"+c+" input[name=title]")),cityname:$("#"+c+" input[name=cityname]").val(),cityid:$("#"+c+" input[name=cityname]").attr("data-id"),citynameaccent:$("#"+c+" input[name=citynameaccent]").val(),is_public:$("#"+c+" div.privacyclass.active").attr("data-value"),description:getObjectData($("#"+c+" textarea[name=description]")),category:$("#"+c+" select[name=category] option:selected").val(),placetakenat:getObjectData($("#"+c+" input[name=placetakenat]")),keywords:getObjectData($("#"+c+" input[name=keywords]")),country:$("#"+c+" select[name=country] option:selected").val(),location:$("#"+c+" input[name=location]").val()},function(f){var i=null;try{i=$.parseJSON(f)}catch(h){$(".fancybox-close").click()}if(!i){$(".fancybox-close").click();return}if(i.status=="error"){TTAlert({msg:i.msg,type:"alert",btn1:"",btn2:t("ok")});$(".fancybox-close").click();return}albumclicked.find(".sorttilte").html(i.title);var g=i.description;var l=g.replace(/\\n|\n/g,"<br />");var j=l.substring(0,100);var k=l.substring(0,80);if(l.length>100){j+="..."}if(l.length>80){k+="..."}albumclicked.find(".mediainfodesc1").html(j);albumclicked.find(".mediainfodesc").html(k);$(".fancybox-close").click()})}});$(document).on("click",".uploadinfocheckbox",function(){if($(this).hasClass("active")){$(this).removeClass("active");if($(this).hasClass("uploadinfocheckbox3")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#friendsdata").remove()}}else{if($(this).hasClass("uploadinfocheckbox_friends_of_friends")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#friends_of_friends_data").remove()}}else{if($(this).hasClass("uploadinfocheckbox4")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#followersdata").remove()}}}}}else{$(this).addClass("active");if($(this).hasClass("uploadinfocheckbox3")){if($(this).parent().hasClass("friendscontainer")){var b='<div class="peoplesdata formttl13" id="friendsdata" data-email="" data-id=""><div class="peoplesdatainside">'+t("friends")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(b)}}else{if($(this).hasClass("uploadinfocheckbox_friends_of_friends")){if($(this).parent().hasClass("friendscontainer")){var a='<div class="peoplesdata formttl13" id="friends_of_friends_data" data-email="" data-id=""><div class="peoplesdatainside">'+t("friends of friends")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(a)}}else{if($(this).hasClass("uploadinfocheckbox4")){if($(this).parent().hasClass("friendscontainer")){var a='<div class="peoplesdata formttl13" id="followersdata" data-email="" data-id=""><div class="peoplesdatainside">'+t("followers")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(a)}}}}}});$(document).on("click",".peoplesdataclose",function(){var a=$(this).parent();var b=a.parent().parent();a.remove();if(a.attr("data-id")!=""){SelectedUsersDelete(a.attr("data-id"),b.find(".addmore input"))}if(a.attr("id")=="friendsdata"){b.find(".uploadinfocheckbox3").removeClass("active")}else{if(a.attr("id")=="followersdata"){b.find(".uploadinfocheckbox4").removeClass("active")}else{if(a.attr("id")=="connectionsdata"){b.find(".uploadinfocheckbox5").removeClass("active")}else{if(a.attr("id")=="sponsorssdata"){b.find(".uploadinfocheckbox6").removeClass("active")}else{if(a.attr("id")=="friends_of_friends_data"){b.find(".uploadinfocheckbox_friends_of_friends").removeClass("active")}}}}}})});function initResetSelectedUsers(a){a.hide();resetSelectedUsers(a.find(".addmore input"));a.find(".uploadinfocheckbox").removeClass("active");a.find(".addmore input").val("");a.find(".addmore input").blur();a.find(".peoplesdata").each(function(){var b=$(this);b.remove()})}function refreshEditAlbums(){$("a.EditCatalogActionButs").each(function(){var a=$(this);var b=$(this).attr("rel");a.fancybox({padding:0,margin:0,beforeLoad:function(){$("#uploadlistpopuppublishalbum").html("");$("#uploadlistpopuppublishalbum .inputuploadformTF").val("");$("#uploadlistpopuppublishalbum #logalbumaddcountry, #newphototo #logalbumaddcategory").val("0");$("#uploadlistpopuppublishalbum .inputuploaddescriptionTF").val("");$("#uploadlistpopuppublishalbum textarea[name=description]").blur();$("#uploadlistpopuppublishalbum input[name=placetakenat]").blur();$("#uploadlistpopuppublishalbum input[name=keywords]").blur();albumclicked=a.parent();CatalogEdit(b)}})})}function refreshEditMedia(){$("a.EditMediaActionButs").each(function(){var a=$(this);var b=$(this).attr("rel");a.fancybox({padding:0,margin:0,beforeLoad:function(){$("#uploadlistpopuppublishalbum").html("");$("#uploadlistpopuppublishalbum .inputuploadformTF").val("");$("#uploadlistpopuppublishalbum #logalbumaddcountry, #newphototo #logalbumaddcategory").val("0");$("#uploadlistpopuppublishalbum .inputuploaddescriptionTF").val("");$("#uploadlistpopuppublishalbum textarea[name=description]").blur();$("#uploadlistpopuppublishalbum input[name=placetakenat]").blur();$("#uploadlistpopuppublishalbum input[name=keywords]").blur();albumclicked=a.parent();MediaEditData(b)}})})}function CatalogDelete(a,b){$.ajax({url:ReturnLink("/ajax/catalog_delete.php"),data:{cid:a},type:"post",success:function(c){var e=null;try{e=$.parseJSON(c)}catch(d){return}if(!e){TTAlert({msg:t("Couldnt remove from favorites. Please try again later."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(e.status=="ok"){b.remove();one_object=1;var f=$("#page_nav a").attr("data-case");ProfilePage--;RebuildLink(f);displayMediaDataRelates()}else{TTAlert({msg:e.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})}function verifyFormList(d){var c=true;var a=$("#"+d);$(".uploadinfomandatory span",a).html("");$("input,select,textarea",a).removeClass("err").each(function(){var f=$(this).attr("name");var e=$(this).parent();if((f=="location")||(f=="location_name")||(f=="cityname")||(f=="status")||(f=="vid")||$(this).hasClass("filevalue")||(f=="filename")||(f=="addmoretext")||(f=="vpath")){}else{if(($(".uploadinfomandatory"+f,e).css("display")!="none"&&getObjectData($(this))=="")||(f=="category"&&!$(".uploadinfomandatorycategory",e).hasClass("inactive")&&$(this).val()=="0")||(f=="country"&&!$(".uploadinfomandatorycountry",e).hasClass("inactive")&&$(this).val()=="0")){$(".uploadinfomandatory"+f+" span",e).html(t("please fill this field correctly"));c=false}}});var b=$("input[name=cityname]",a).parent();if(getObjectData($("input[name=cityname]",a))==""&&!$(".uploadinfomandatorycitynameaccent",b).hasClass("inactive")&&$("input[name=cityname]",a).length>0){$(".uploadinfomandatorycitynameaccent span",b).html(t("please fill this field correctly"));c=false}if(!c){return false}else{return true}}function CatalogEdit(a){$.post(ReturnLink("/ajax/ajax_getlistalbumuploaddata.php"),{id:a},function(b){if(b!=false){$("#uploadlistpopuppublishalbum").html(b);resetSelectedUsers($("#uploadlistpopuppublishalbum #addmoretext_privacy"));$("#uploadlistpopuppublishalbum input[name=title]").blur();$("#uploadlistpopuppublishalbum textarea[name=description]").blur();$("#uploadlistpopuppublishalbum input[name=placetakenat]").blur();$("#uploadlistpopuppublishalbum input[name=keywords]").blur();$("#uploadlistpopuppublishalbum .uploadinfocheckboxcontainer").remove();addAutoCompleteList("uploadlistpopuppublishalbum");$("#uploadlistpopuppublishalbum").attr("data-id",a);var c=parseInt($("#uploadlistpopuppublishalbum .formcontainer").attr("data-value"));$("#uploadlistpopuppublishalbum #privacyclass_user"+c).click();if(c==USER_PRIVACY_SELECTED){$("#uploadlistpopuppublishalbum").find(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var d=$(this);if(d.attr("id")=="friendsdata"){}else{if(d.attr("id")=="friends_of_friends_data"){}else{if(d.attr("id")=="followersdata"){}else{if(parseInt(d.attr("data-id"))!=0){SelectedUsersAdd(d.attr("data-id"))}}}}})}addmoreusersautocomplete_custom_journal($("#uploadlistpopuppublishalbum #addmoretext_privacy"))}})}function MediaEditData(a){$.post(ReturnLink("/ajax/profile_media_details.php"),{id:a},function(b){if(b!=false){$("#uploadlistpopuppublishalbum").html(b);resetSelectedUsers($("#uploadlistpopuppublishalbum #addmoretext_privacy"));$("#uploadlistpopuppublishalbum input[name=title]").blur();$("#uploadlistpopuppublishalbum textarea[name=description]").blur();$("#uploadlistpopuppublishalbum input[name=placetakenat]").blur();$("#uploadlistpopuppublishalbum input[name=keywords]").blur();$("#uploadlistpopuppublishalbum .uploadinfocheckboxcontainer").remove();addAutoCompleteList("uploadlistpopuppublishalbum");$("#uploadlistpopuppublishalbum").attr("data-id",a);var c=parseInt($("#uploadlistpopuppublishalbum .formcontainer").attr("data-value"));$("#uploadlistpopuppublishalbum #privacyclass_user"+c).click();if(c==USER_PRIVACY_SELECTED){$("#uploadlistpopuppublishalbum").find(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var d=$(this);if(d.attr("id")=="friendsdata"){}else{if(d.attr("id")=="friends_of_friends_data"){}else{if(d.attr("id")=="followersdata"){}else{if(parseInt(d.attr("data-id"))!=0){SelectedUsersAdd(d.attr("data-id"))}}}}})}addmoreusersautocomplete_custom_journal($("#uploadlistpopuppublishalbum #addmoretext_privacy"))}})}function addAutoCompleteList(b){var a=$("input[name=citynameaccent]",$("#"+b));a.autocomplete({appendTo:"#contentcontainer",search:function(e,f){var c=$("select[name=country]",a.parent()).removeClass("err");var d=$("option:selected",c).val();if(d=="ZZ"){c.addClass("err");e.preventDefault()}else{a.autocomplete("option","source",ReturnLink("/ajax/uploadGetCities.php?cc="+d))}},select:function(c,d){a.val(d.item.value);$("input[name=cityname]",a.parent()).val(d.item.value);$("input[name=cityname]",a.parent()).attr("data-id",d.item.id);c.preventDefault()}})}function FavoriteDelete(a){$.ajax({url:ReturnLink("/ajax/profile_del_fav.php"),data:{vid:a},type:"post",success:function(b){$("body").css("cursor","");var d=null;try{d=$.parseJSON(b)}catch(c){return}if(!d){TTAlert({msg:t("Couldnt remove from favorites. Please try again later."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(d.status=="ok"){window.location.reload()}else{TTAlert({msg:d.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})}function FavoriteCamDelete(a){$.ajax({url:ReturnLink("/ajax/profile_del_fav_cam.php"),data:{vid:a},type:"post",success:function(b){$("body").css("cursor","");var d=null;try{d=$.parseJSON(b)}catch(c){return}if(!d){TTAlert({msg:t("Couldnt remove from favorites. Please try again later."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(d.status=="ok"){window.location.reload()}else{TTAlert({msg:d.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})}function MediaDelete(a,b){$.ajax({url:ReturnLink("/ajax/profile_del_media.php"),data:{vid:a},type:"post",success:function(c){$("body").css("cursor","");var e=null;try{e=$.parseJSON(c)}catch(d){return}if(!e){TTAlert({msg:t("Couldnt delete. Please try again later."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(e.status=="ok"){b.remove();one_object=1;var f=$("#page_nav a").attr("data-case");ProfilePage--;RebuildLink(f);displayMediaDataRelates()}else{TTAlert({msg:e.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})}function MediaEdit(b){var a=$("#dialog");if(a.length==0){a=$('<div id="dialog"/>');a.appendTo($("body"))}$("body").css("cursor","pointer");$.ajax({url:ReturnLink("/ajax/profile_media_details.php"),type:"post",data:{vid:b},success:function(c){a.html(c);$("input[name=save]",a).click(function(){MediaSave(function(d){a.dialog("close")})});a.dialog({zIndex:100,autoOpen:true,title:"Edit media",modal:true,draggable:false,minWidth:940,minHeight:410,resizable:false,close:function(d,e){$("input[name=citynameaccent]").autocomplete("close");$("input[name=placetakenat]").autocomplete("close");$("input[name=tripname]").autocomplete("close")}})}})}function AddAutomplete(){var a=$("input[name=citynameaccent]");a.autocomplete({search:function(e,f){var c=$("select[name=country]").removeClass("err");var d=$("option:selected",c).val();if(d=="ZZ"){c.addClass("err");e.preventDefault()}else{a.autocomplete("option","source",ReturnLink("/ajax/uploadGetCities.php?cc="+d))}},select:function(c,d){a.val(d.item.value);$("input[name=cityname]").val(d.item.value);$("input[name=cityname]").attr("data-id",d.item.id);c.preventDefault()}});var b=$("input[name=tripname]");b.autocomplete({source:userTrips,minLength:2})}function MediaSave(a){$.ajax({url:ReturnLink("/ajax/profile_media_save.php"),type:"post",data:{vid:$("input[name=vid]").val(),title:$("input[name=title]").val(),cityname:$("input[name=cityname]").val(),cityid:$("input[name=cityname]").attr("data-id"),citynameaccent:$("input[name=citynameaccent]").val(),is_public:$("input[name=is_public]:checked").val(),description:$("textarea[name=description]").val(),category:$("select[name=category] option:selected").val(),placetakenat:$("input[name=placetakenat]").val(),keywords:$("input[name=keywords]").val(),country:$("select[name=country] option:selected").val(),lattitude:$("input[name=lattitude]").val(),longitude:$("input[name=longitude]").val(),location:$("input[name=location]").val(),tripname:$("input[name=tripname]").val()},success:function(b){var e=null;try{e=$.parseJSON(b)}catch(d){TTAlert({msg:t("Couldn't Process Request. Please try again later."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(!e){TTAlert({msg:t("Couldn't Process Request. Please try again later."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(e.status=="ok"){a(b);var f=$("input[name=title]").val();var c=$("textarea[name=description]").val();var g=$("input[name=vid]").val();$("#cvideo_"+g+" strong.sorttilte").html(f);$("#cvideo_"+g+" div.mediainfodesc").html(c);$("#video_"+g+" strong.sorttilte").html(f);$("#video_"+g+" div.mediainfodesc").html(c)}else{TTAlert({msg:e.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})}function RebuildLink(b){var a;switch(b){case"videos":a=ReturnLink("parts/profile_vids.php?userId="+userId+"&page="+ProfilePage+"&ss="+ss);break;case"photos":a=ReturnLink("parts/profile_photos.php?userId="+userId+"&page="+ProfilePage+"&ss="+ss);break;case"albums":a=ReturnLink("parts/profile_albums.php?userId="+userId+"&page="+ProfilePage+"&ss="+ss);break;case"favorites":a=ReturnLink("parts/profile_favorites.php?page="+ProfilePage);break;case"newsfeed":a=ReturnLink("parts/profile_newsfeed.php?page="+ProfilePage);break}$("#page_nav a").attr("href",a)}function checkSubmit(a){if(a&&a.keyCode==13){$("#searchbut").click()}};