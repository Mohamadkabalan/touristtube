(function(d,e){typeof VisualEvent_Loader=="undefined"&&(d.VisualEvent_Loader=function(){if(!this instanceof VisualEvent_Loader){alert("VisualEvent loader warning: Must be initialised with the 'new' keyword.");return}this.s={loadingComplete:!1},this.dom={loading:e.createElement("div")},this._construct()},VisualEvent_Loader.prototype={_construct:function(){var a=this,b,g,h=d.location.protocol==="file:"?"http:":"";if(this.s.loadingComplete===!0){return 0}b=this.dom.loading,b.setAttribute("id","EventLoading"),b.appendChild(e.createTextNode("Loading Visual Event...")),g=b.style,g.position="fixed",g.bottom="0",g.left="0",g.color="white",g.padding="5px 10px",g.fontSize="11px",g.fontFamily='"Lucida Grande", Verdana, Arial, Helvetica, sans-serif',g.zIndex="55999",g.backgroundColor="#93a8cf",e.body.insertBefore(b,e.body.childNodes[0]),VisualEvent_Loader.jQueryPreLoaded=typeof jQuery=="undefined"?!1:!0;if(typeof VisualEvent=="object"){this._pollReady();return}setTimeout(function(){a._pollReady()},1000),this._loadFile(h+"//sprymedia.co.uk/VisualEvent/builds/VisualEvent-1366007672/css/VisualEvent.css","css"),typeof jQuery=="undefined"?this._loadFile(h+"//sprymedia.co.uk/VisualEvent/builds/VisualEvent-1366007672/js/VisualEvent-jQuery.js","js"):this._loadFile(h+"//sprymedia.co.uk/VisualEvent/builds/VisualEvent-1366007672/js/VisualEvent.js","js")},_loadFile:function(b,g){var h,i;g=="css"?(h=e.createElement("link"),h.type="text/css",h.rel="stylesheet",h.href=b,h.media="screen",e.getElementsByTagName("head")[0].appendChild(h)):g=="image"?(i=new Image(1,1),i.src=b):(h=e.createElement("script"),h.setAttribute("language","JavaScript"),h.setAttribute("src",b),h.setAttribute("charset","utf8"),e.body.appendChild(h))},_pollReady:function(){var c=this,g;typeof VisualEvent=="function"&&typeof VisualEventSyntaxHighlighter=="object"?this._complete():setTimeout(function(){c._pollReady()},100)},_complete:function(){var b=this;this.s.loadingComplete=!0,f=new VisualEvent,e.body.removeChild(this.dom.loading)}},VisualEvent_Loader.jQueryPreLoaded=!1);var f;typeof VisualEvent!="undefined"?VisualEvent.instance!==null?VisualEvent.close():f=new VisualEvent:f=new VisualEvent_Loader})(window,document);