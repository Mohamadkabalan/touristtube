Calendar=function(){function at(b){typeof b=="string"&&(b=document.getElementById(b));return b}function aq(d,e,f){for(f=0;f<d.length;++f){e(d[f])}}function ap(){var c=document.documentElement,d=document.body;return{x:c.scrollLeft||d.scrollLeft,y:c.scrollTop||d.scrollTop,w:c.clientWidth||window.innerWidth||d.clientWidth,h:c.clientHeight||window.innerHeight||d.clientHeight}}function ao(g){var h=0,i=0,j=/^div$/i.test(g.tagName),k,l;j&&g.scrollLeft&&(h=g.scrollLeft),j&&g.scrollTop&&(i=g.scrollTop),k={x:g.offsetLeft-h,y:g.offsetTop-i},g.offsetParent&&(l=ao(g.offsetParent),k.x+=l.x,k.y+=l.y);return k}function an(e,f){var g=ay?e.clientX+document.body.scrollLeft:e.pageX,h=ay?e.clientY+document.body.scrollTop:e.pageY;f&&(g-=f.x,h-=f.y);return{x:g,y:h}}function am(d,e){var f=d.style;e!=null&&(f.display=e?"":"none");return f.display!="none"}function al(c,d){d===""?ay?c.style.filter="":c.style.opacity="":d!=null?ay?c.style.filter="alpha(opacity="+d*100+")":c.style.opacity=d:ay?/alpha\(opacity=([0-9.])+\)/.test(c.style.opacity)&&(d=parseFloat(RegExp.$1)/100):d=parseFloat(c.style.opacity);return d}function aj(e,i,j){function n(){var a=e.len;e.onUpdate(j/a,k),j==a&&m(),++j}function m(){i&&(clearInterval(i),i=null),e.onStop(j/e.len,k)}function l(){i&&m(),j=0,i=setInterval(n,1000/e.fps)}function k(f,g,h,o){return o?h+f*(g-h):g+f*(h-g)}e=a5(e,{fps:50,len:15,onUpdate:ar,onStop:ar}),ay&&(e.len=Math.round(e.len/2)),l();return{start:l,stop:m,update:n,args:e,map:k}}function ai(d,e){if(!e(d)){for(var f=d.firstChild;f;f=f.nextSibling){f.nodeType==1&&ai(f,e)}}}function ah(d,e){var f=ag(arguments,2);return e==undefined?function(){return d.apply(this,f.concat(ag(arguments)))}:function(){return d.apply(e,f.concat(ag(arguments)))}}function ag(g,h){h==null&&(h=0);var i,j,k;try{i=Array.prototype.slice.call(g,h)}catch(l){i=Array(g.length-h);for(j=h,k=0;j<g.length;++j,++k){i[k]=g[j]}}return i}function ab(e,f,g){var h=null;document.createElementNS?h=document.createElementNS("http://www.w3.org/1999/xhtml",e):h=document.createElement(e),f&&(h.className=f),g&&g.appendChild(h);return h}function aa(e,f,g){if(f instanceof Array){for(var h=f.length;--h>=0;){aa(e,f[h],g)}}else{bq(f,g,e?g:null)}return e}function bs(c,d){return bq(c,d,d)}function bq(g,h,i){if(g){var j=g.className.replace(/^\s+|\s+$/,"").split(/\x20/),k=[],l;for(l=j.length;l>0;){j[--l]!=h&&k.push(j[l])}i&&k.push(i),g.className=k.join(" ")}return i}function bo(b){b=b||window.event,ay?(b.cancelBubble=!0,b.returnValue=!1):(b.preventDefault(),b.stopPropagation());return !1}function a9(e,g,h,i){if(e instanceof Array){for(var j=e.length;--j>=0;){a9(e[j],g,h)}}else{if(typeof g=="object"){for(var j in g){g.hasOwnProperty(j)&&a9(e,j,g[j],h)}}else{e.removeEventListener?e.removeEventListener(g,h,ay?!0:!!i):e.detachEvent?e.detachEvent("on"+g,h):e["on"+g]=null}}}function a7(e,g,h,i){if(e instanceof Array){for(var j=e.length;--j>=0;){a7(e[j],g,h,i)}}else{if(typeof g=="object"){for(var j in g){g.hasOwnProperty(j)&&a7(e,j,g[j],h)}}else{e.addEventListener?e.addEventListener(g,h,ay?!0:!!i):e.attachEvent?e.attachEvent("on"+g,h):e["on"+g]=h}}}function a5(e,f,g,h){h={};for(g in f){f.hasOwnProperty(g)&&(h[g]=f[g])}for(g in e){e.hasOwnProperty(g)&&(h[g]=e[g])}return h}function a3(c){if(/\S/.test(c)){c=c.toLowerCase();function d(a){for(var e=a.length;--e>=0;){if(a[e].toLowerCase().indexOf(c)==0){return e+1}}}return d(aN("smn"))||d(aN("mn"))}}function a1(c){if(c){if(typeof c=="number"){return aV(c)}if(!(c instanceof Date)){var d=c.split(/-/);return new Date(parseInt(d[0],10),parseInt(d[1],10)-1,parseInt(d[2],10),12,0,0,0)}}return c}function aZ(p,q){var r=p.getMonth(),s=p.getDate(),t=p.getFullYear(),u=aP(p),v=p.getDay(),w=p.getHours(),x=w>=12,y=x?w-12:w,z=aR(p),A=p.getMinutes(),B=p.getSeconds(),C=/%./g,D;y===0&&(y=12),D={"%a":aN("sdn")[v],"%A":aN("dn")[v],"%b":aN("smn")[r],"%B":aN("mn")[r],"%C":1+Math.floor(t/100),"%d":s<10?"0"+s:s,"%e":s,"%H":w<10?"0"+w:w,"%I":y<10?"0"+y:y,"%j":z<10?"00"+z:z<100?"0"+z:z,"%k":w,"%l":y,"%m":r<9?"0"+(1+r):1+r,"%o":1+r,"%M":A<10?"0"+A:A,"%n":"\n","%p":x?"PM":"AM","%P":x?"pm":"am","%s":Math.floor(p.getTime()/1000),"%S":B<10?"0"+B:B,"%t":"\t","%U":u<10?"0"+u:u,"%W":u<10?"0"+u:u,"%V":u<10?"0"+u:u,"%u":v+1,"%w":v,"%y":(""+t).substr(2,2),"%Y":t,"%%":"%"};return q.replace(C,function(b){return D.hasOwnProperty(b)?D[b]:b})}function aX(j,k,l){var m=j.getFullYear(),n=j.getMonth(),o=j.getDate(),p=k.getFullYear(),q=k.getMonth(),r=k.getDate();return m<p?-3:m>p?3:n<q?-2:n>q?2:l?0:o<r?-1:o>r?1:0}function aV(h,i,j,k,l){if(!(h instanceof Date)){h=parseInt(h,10);var m=Math.floor(h/10000);h=h%10000;var n=Math.floor(h/100);h=h%100,h=new Date(m,n-1,h,i==null?12:i,j==null?0:j,k==null?0:k,l==null?0:l)}return h}function aT(b){if(b instanceof Date){return 10000*b.getFullYear()+100*(b.getMonth()+1)+b.getDate()}if(typeof b=="string"){return parseInt(b,10)}return b}function aR(d){d=new Date(d.getFullYear(),d.getMonth(),d.getDate(),12,0,0);var e=new Date(d.getFullYear(),0,1,12,0,0),f=d-e;return Math.floor(f/86400000)}function aP(d){d=new Date(d.getFullYear(),d.getMonth(),d.getDate(),12,0,0);var e=d.getDay();d.setDate(d.getDate()-(e+6)%7+3);var f=d.valueOf();d.setMonth(0),d.setDate(4);return Math.round((f-d.valueOf())/604800000)+1}function aN(d,e){var f=aG.__.data[d];e&&typeof f=="string"&&(f=aL(f,e));return f}function aL(c,d){return c.replace(/\$\{([^:\}]+)(:[^\}]+)?\}/g,function(b,g,h){var i=d[g],j;h&&(j=h.substr(1).split(/\s*\|\s*/),i=(i>=j.length?j[j.length-1]:j[i]).replace(/##?/g,function(e){return e.length==2?"#":i}));return i})}function aJ(a){if(!this._menuAnim){a=a||window.event;var p=a.target||a.srcElement,q=p.getAttribute("dyc-btn"),r=a.keyCode,s=a.charCode||r,t=aF[r];if("year"==q&&r==13){var u=new Date(this.date);u.setDate(1),u.setFullYear(this._getInputYear()),this.moveTo(u,!0),br(this,!1);return bo(a)}if(this._menuVisible){if(r==27){br(this,!1);return bo(a)}}else{a.ctrlKey||(t=null),t==null&&!a.ctrlKey&&(t=aH[r]),r==36&&(t=0);if(t!=null){bp(this,t);return bo(a)}s=String.fromCharCode(s).toLowerCase();var v=this.els.yearInput,w=this.selection;if(s==" "){br(this,!0),this.focus(),v.focus(),v.select();return bo(a)}if(s>="0"&&s<="9"){br(this,!0),this.focus(),v.value=s,v.focus();return bo(a)}var x=aN("mn"),y=a.shiftKey?-1:this.date.getMonth(),z=0,A;while(++z<12){A=x[(y+z)%12].toLowerCase();if(A.indexOf(s)==0){var u=new Date(this.date);u.setDate(1),u.setMonth((y+z)%12),this.moveTo(u,!0);return bo(a)}}if(r>=37&&r<=40){var u=this._lastHoverDate;if(!u&&!w.isEmpty()){u=r<39?w.getFirstDate():w.getLastDate();if(u<this._firstDateVisible||u>this._lastDateVisible){u=null}}if(!u){u=r<39?this._lastDateVisible:this._firstDateVisible}else{var B=u;u=aV(u);var y=100;while(y-->0){switch(r){case 37:u.setDate(u.getDate()-1);break;case 38:u.setDate(u.getDate()-7);break;case 39:u.setDate(u.getDate()+1);break;case 40:u.setDate(u.getDate()+7)}if(!this.isDisabled(u)){break}}u=aT(u),(u<this._firstDateVisible||u>this._lastDateVisible)&&this.moveTo(u)}bq(this._getDateDiv(B),bs(this._getDateDiv(u),"DynarchCalendar-hover-date")),this._lastHoverDate=u;return bo(a)}if(r==13&&this._lastHoverDate){w.type==ac.SEL_MULTIPLE&&(a.shiftKey||a.ctrlKey)?(a.shiftKey&&this._selRangeStart&&(w.clear(!0),w.selectRange(this._selRangeStart,this._lastHoverDate)),a.ctrlKey&&w.set(this._selRangeStart=this._lastHoverDate,!0)):w.reset(this._selRangeStart=this._lastHoverDate);return bo(a)}r==27&&!this.args.cont&&this.hide()}}}function aD(){this.refresh();var d=this.inputField,e=this.selection;if(d){var f=e.print(this.dateFormat);/input|textarea/i.test(d.tagName)?d.value=f:d.innerHTML=f}this.callHooks("onSelect",this,e)}function aB(f){f=f||window.event;var g=av(f);if(g){var h=g.getAttribute("dyc-btn"),i=g.getAttribute("dyc-type"),j=f.wheelDelta?f.wheelDelta/120:-f.detail/3;j=j<0?-1:j>0?1:0,this.args.reverseWheel&&(j=-j);if(/^(time-(hour|min))/.test(i)){switch(RegExp.$1){case"time-hour":this.setHours(this.getHours()+j);break;case"time-min":this.setMinutes(this.getMinutes()+this.args.minuteStep*j)}bo(f)}else{/Y/i.test(h)&&(j*=2),bp(this,-j),bo(f)}}}function az(f,g){g=g||window.event;var h=av(g);if(h){var i=h.getAttribute("dyc-type");if(i&&!h.getAttribute("disabled")){if(!f||!this._bodyAnim||i!="date"){var j=h.getAttribute("dyc-cls");j=j?ax(j,0):"DynarchCalendar-hover-"+i,(i!="date"||this.selection.type)&&aa(f,h,j),i=="date"&&(aa(f,h.parentNode.parentNode,"DynarchCalendar-hover-week"),this._showTooltip(h.getAttribute("dyc-date"))),/^time-hour/.test(i)&&aa(f,this.els.timeHour,"DynarchCalendar-hover-time"),/^time-min/.test(i)&&aa(f,this.els.timeMinute,"DynarchCalendar-hover-time"),bq(this._getDateDiv(this._lastHoverDate),"DynarchCalendar-hover-date"),this._lastHoverDate=null}}}f||this._showTooltip()}function ax(c,d){return"DynarchCalendar-"+c.split(/,/)[d]}function av(d){var e=d.target||d.srcElement,f=e;while(e&&e.getAttribute&&!e.getAttribute("dyc-type")){e=e.parentNode}return e.getAttribute&&e||f}function af(d){d=d||window.event;var e=this.els.topCont.style,f=an(d,this._mouseDiff);e.left=f.x+"px",e.top=f.y+"px"}function ad(a,e){e=e||window.event;var n=av(e);if(n&&!n.getAttribute("disabled")){var o=n.getAttribute("dyc-btn"),p=n.getAttribute("dyc-type"),q=n.getAttribute("dyc-date"),r=this.selection,s,t={mouseover:bo,mousemove:bo,mouseup:function(c){var d=n.getAttribute("dyc-cls");d&&bq(n,ax(d,1)),clearTimeout(s),a9(document,t,!0),t=null}};if(a){setTimeout(ah(this.focus,this),1);var u=n.getAttribute("dyc-cls");u&&bs(n,ax(u,1));if("menu"==o){this.toggleMenu()}else{if(n&&/^[+-][MY]$/.test(o)){if(bp(this,o)){var v=ah(function(){bp(this,o,!0)?s=setTimeout(v,40):(t.mouseup(),bp(this,o))},this);s=setTimeout(v,350),a7(document,t,!0)}else{t.mouseup()}}else{if("year"==o){this.els.yearInput.focus(),this.els.yearInput.select()}else{if(p=="time-am"){a7(document,t,!0)}else{if(/^time/.test(p)){var v=ah(function(b){a8.call(this,b),s=setTimeout(v,100)},this,p);a8.call(this,p),s=setTimeout(v,350),a7(document,t,!0)}else{q&&r.type&&(r.type==ac.SEL_MULTIPLE?e.shiftKey&&this._selRangeStart?r.selectRange(this._selRangeStart,q):(!e.ctrlKey&&!r.isSelected(q)&&r.clear(!0),r.set(q,!0),this._selRangeStart=q):(r.set(q),this.moveTo(aV(q),2)),n=this._getDateDiv(q),az.call(this,!0,{target:n})),a7(document,t,!0)}}}}}ay&&t&&/dbl/i.test(e.type)&&t.mouseup(),!this.args.fixed&&/^(DynarchCalendar-(topBar|bottomBar|weekend|weekNumber|menu(-sep)?))?$/.test(n.className)&&!this.args.cont&&(t.mousemove=ah(af,this),this._mouseDiff=an(e,ao(this.els.topCont)),a7(document,t,!0))}else{if("today"==o){!this._menuVisible&&r.type==ac.SEL_SINGLE&&r.set(new Date),this.moveTo(new Date,!0),br(this,!1)}else{if(/^m([0-9]+)/.test(o)){var q=new Date(this.date);q.setDate(1),q.setMonth(RegExp.$1),q.setFullYear(this._getInputYear()),this.moveTo(q,!0),br(this,!1)}else{p=="time-am"&&this.setHours(this.getHours()+12)}}}ay||bo(e)}}function br(e,f){e._menuVisible=f,aa(f,e.els.title,"DynarchCalendar-pressed-title");var g=e.els.menu;aA&&(g.style.height=e.els.main.offsetHeight+"px");if(!e.args.animation){am(g,f),e.focused&&e.focus()}else{e._menuAnim&&e._menuAnim.stop();var h=e.els.main.offsetHeight;aA&&(g.style.width=e.els.topBar.offsetWidth+"px"),f&&(g.firstChild.style.marginTop=-h+"px",e.args.opacity>0&&al(g,0),am(g,!0)),e._menuAnim=aj({onUpdate:function(a,b){g.firstChild.style.marginTop=b(ak.accel_b(a),-h,0,!f)+"px",e.args.opacity>0&&al(g,b(ak.accel_b(a),0,0.85,!f))},onStop:function(){e.args.opacity>0&&al(g,0.85),g.firstChild.style.marginTop="",e._menuAnim=null,f||(am(g,!1),e.focused&&e.focus())}})}}function bp(e,f,g){this._bodyAnim&&this._bodyAnim.stop();var h;if(f!=0){h=new Date(e.date),h.setDate(1);switch(f){case"-Y":case -2:h.setFullYear(h.getFullYear()-1);break;case"+Y":case 2:h.setFullYear(h.getFullYear()+1);break;case"-M":case -1:h.setMonth(h.getMonth()-1);break;case"+M":case 1:h.setMonth(h.getMonth()+1)}}else{h=new Date}return e.moveTo(h,!g)}function a8(b){switch(b){case"time-hour+":this.setHours(this.getHours()+1);break;case"time-hour-":this.setHours(this.getHours()-1);break;case"time-min+":this.setMinutes(this.getMinutes()+this.args.minuteStep);break;case"time-min-":this.setMinutes(this.getMinutes()-this.args.minuteStep);break;default:return}}function a6(){this._bluringTimeout=setTimeout(ah(a4,this),50)}function a4(){this.focused=!1,bq(this.els.main,"DynarchCalendar-focused"),this._menuVisible&&br(this,!1),this.args.cont||this.hide(),this.callHooks("onBlur",this)}function a2(){this._bluringTimeout&&clearTimeout(this._bluringTimeout),this.focused=!0,bs(this.els.main,"DynarchCalendar-focused"),this.callHooks("onFocus",this)}function a0(e){var f=ab("div"),g=e.els={},h={mousedown:ah(ad,e,!0),mouseup:ah(ad,e,!1),mouseover:ah(az,e,!0),mouseout:ah(az,e,!1),keypress:ah(aJ,e)};e.args.noScroll||(h[aC?"DOMMouseScroll":"mousewheel"]=ah(aB,e)),ay&&(h.dblclick=h.mousedown,h.keydown=h.keypress),f.innerHTML=aO(e),ai(f.firstChild,function(c){var d=aY[c.className];d&&(g[d]=c),ay&&c.setAttribute("unselectable","on")}),a7(g.main,h),a7([g.focusLink,g.yearInput],e._focusEvents={focus:ah(a2,e),blur:ah(a6,e)}),e.moveTo(e.date,!1),e.setTime(null,!0);return g.topCont}function aW(e){function h(){g.showTime&&(f.push("<td>"),aU(e,f),f.push("</td>"))}var f=[],g=e.args;f.push("<table",aI," style='width:100%'><tr>"),g.timePos=="left"&&h(),g.bottomBar&&(f.push("<td>"),f.push("<table",aI,"><tr><td>","<div dyc-btn='today' dyc-cls='hover-bottomBar-today,pressed-bottomBar-today' dyc-type='bottomBar-today' ","class='DynarchCalendar-bottomBar-today'>",aN("today"),"</div>","</td></tr></table>"),f.push("</td>")),g.timePos=="right"&&h(),f.push("</tr></table>");return f.join("")}function aU(c,d){d.push("<table class='DynarchCalendar-time'"+aI+"><tr>","<td rowspan='2'><div dyc-type='time-hour' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-hour'></div></td>","<td dyc-type='time-hour+' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-up'></td>","<td rowspan='2' class='DynarchCalendar-time-sep'></td>","<td rowspan='2'><div dyc-type='time-min' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-minute'></div></td>","<td dyc-type='time-min+' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-up'></td>"),c.args.showTime==12&&d.push("<td rowspan='2' class='DynarchCalendar-time-sep'></td>","<td rowspan='2'><div class='DynarchCalendar-time-am' dyc-type='time-am' dyc-cls='hover-time,pressed-time'></div></td>"),d.push("</tr><tr>","<td dyc-type='time-hour-' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-down'></td>","<td dyc-type='time-min-' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-down'></td>","</tr></table>")}function aS(g){var h=["<table height='100%'",aI,"><tr><td>","<table style='margin-top: 1.5em'",aI,">","<tr><td colspan='3'><input dyc-btn='year' class='DynarchCalendar-menu-year' size='6' value='",g.date.getFullYear(),"' /></td></tr>","<tr><td><div dyc-type='menubtn' dyc-cls='hover-navBtn,pressed-navBtn' dyc-btn='today'>",aN("goToday"),"</div></td></tr>","</table>","<p class='DynarchCalendar-menu-sep'>&nbsp;</p>","<table class='DynarchCalendar-menu-mtable'",aI,">"],i=aN("smn"),j=0,k=h.length,l;while(j<12){h[k++]="<tr>";for(l=4;--l>0;){h[k++]="<td><div dyc-type='menubtn' dyc-cls='hover-navBtn,pressed-navBtn' dyc-btn='m"+j+"' class='DynarchCalendar-menu-month'>"+i[j++]+"</div></td>"}h[k++]="</tr>"}h[k++]="</table></td></tr></table>";return h.join("")}function aQ(b){return"<div unselectable='on'>"+aZ(b.date,b.args.titleFormat)+"</div>"}function aO(c){var d=["<table class='DynarchCalendar-topCont'",aI,"><tr><td>","<div class='DynarchCalendar'>",ay?"<a class='DynarchCalendar-focusLink' href='#'></a>":"<button class='DynarchCalendar-focusLink'></button>","<div class='DynarchCalendar-topBar'>","<div dyc-type='nav' dyc-btn='-Y' dyc-cls='hover-navBtn,pressed-navBtn' ","class='DynarchCalendar-navBtn DynarchCalendar-prevYear'><div></div></div>","<div dyc-type='nav' dyc-btn='+Y' dyc-cls='hover-navBtn,pressed-navBtn' ","class='DynarchCalendar-navBtn DynarchCalendar-nextYear'><div></div></div>","<div dyc-type='nav' dyc-btn='-M' dyc-cls='hover-navBtn,pressed-navBtn' ","class='DynarchCalendar-navBtn DynarchCalendar-prevMonth'><div></div></div>","<div dyc-type='nav' dyc-btn='+M' dyc-cls='hover-navBtn,pressed-navBtn' ","class='DynarchCalendar-navBtn DynarchCalendar-nextMonth'><div></div></div>","<table class='DynarchCalendar-titleCont'",aI,"><tr><td>","<div dyc-type='title' dyc-btn='menu' dyc-cls='hover-title,pressed-title' class='DynarchCalendar-title'>",aQ(c),"</div></td></tr></table>","<div class='DynarchCalendar-dayNames'>",aK(c),"</div>","</div>","<div class='DynarchCalendar-body'></div>"];(c.args.bottomBar||c.args.showTime)&&d.push("<div class='DynarchCalendar-bottomBar'>",aW(c),"</div>"),d.push("<div class='DynarchCalendar-menu' style='display: none'>",aS(c),"</div>","<div class='DynarchCalendar-tooltip'></div>","</div>","</td></tr></table>");return d.join("")}function aM(j,v,w){v=v||j.date,w=w||j.fdow,v=new Date(v.getFullYear(),v.getMonth(),v.getDate(),12,0,0,0);var x=v.getMonth(),y=[],z=0,A=j.args.weekNumbers;v.setDate(1);var B=(v.getDay()-w)%7;B<0&&(B+=7),v.setDate(0-B),v.setDate(v.getDate()+1);var C=new Date,D=C.getDate(),E=C.getMonth(),F=C.getFullYear();y[z++]="<table class='DynarchCalendar-bodyTable'"+aI+">";for(var G=0;G<6;++G){y[z++]="<tr class='DynarchCalendar-week",G==0&&(y[z++]=" DynarchCalendar-first-row"),G==5&&(y[z++]=" DynarchCalendar-last-row"),y[z++]="'>",A&&(y[z++]="<td class='DynarchCalendar-first-col'><div class='DynarchCalendar-weekNumber'>"+aP(v)+"</div></td>");for(var H=0;H<7;++H){var I=v.getDate(),J=v.getMonth(),K=v.getFullYear(),L=10000*K+100*(J+1)+I,M=j.selection.isSelected(L),N=j.isDisabled(v);y[z++]="<td class='",H==0&&!A&&(y[z++]=" DynarchCalendar-first-col"),H==0&&G==0&&(j._firstDateVisible=L),H==6&&(y[z++]=" DynarchCalendar-last-col",G==5&&(j._lastDateVisible=L)),M&&(y[z++]=" DynarchCalendar-td-selected"),y[z++]="'><div dyc-type='date' unselectable='on' dyc-date='"+L+"' ",N&&(y[z++]="disabled='1' "),y[z++]="class='DynarchCalendar-day",aN("weekend").indexOf(v.getDay())>=0&&(y[z++]=" DynarchCalendar-weekend"),J!=x&&(y[z++]=" DynarchCalendar-day-othermonth"),I==D&&J==E&&K==F&&(y[z++]=" DynarchCalendar-day-today"),N&&(y[z++]=" DynarchCalendar-day-disabled"),M&&(y[z++]=" DynarchCalendar-day-selected"),N=j.args.dateInfo(v),N&&N.klass&&(y[z++]=" "+N.klass),y[z++]="'>"+I+"</div></td>",v=new Date(K,J,I+1,12,0,0,0)}y[z++]="</tr>"}y[z++]="</table>";return y.join("")}function aK(e){var f=["<table",aI,"><tr>"],g=0;e.args.weekNumbers&&f.push("<td><div class='DynarchCalendar-weekNumber'>",aN("wk"),"</div></td>");while(g<7){var h=(g+++e.fdow)%7;f.push("<td><div",aN("weekend").indexOf(h)>=0?" class='DynarchCalendar-weekend'>":">",aN("sdn")[h],"</div></td>")}f.push("</tr></table>");return f.join("")}function ac(a){a=a||{},this.args=a=a5(a,{animation:!aA,cont:null,bottomBar:!0,date:!0,fdow:aN("fdow"),min:null,max:null,reverseWheel:!1,selection:[],selectionType:ac.SEL_SINGLE,weekNumbers:!1,align:"Bl/ / /T/r",inputField:null,trigger:null,dateFormat:"%Y-%m-%d",fixed:!1,opacity:ay?1:3,titleFormat:"%b %Y",showTime:!1,timePos:"right",time:!0,minuteStep:5,noScroll:!1,disabled:ar,checkRange:!1,dateInfo:ar,onChange:ar,onSelect:ar,onTimeChange:ar,onFocus:ar,onBlur:ar}),this.handlers={};var e=this,f=new Date;a.min=a1(a.min),a.max=a1(a.max),a.date===!0&&(a.date=f),a.time===!0&&(a.time=f.getHours()*100+Math.floor(f.getMinutes()/a.minuteStep)*a.minuteStep),this.date=a1(a.date),this.time=a.time,this.fdow=a.fdow,aq("onChange onSelect onTimeChange onFocus onBlur".split(/\s+/),function(b){var c=a[b];c instanceof Array||(c=[c]),e.handlers[b]=c}),this.selection=new ac.Selection(a.selection,a.selectionType,aD,this);var h=a0(this);a.cont&&at(a.cont).appendChild(h),a.trigger&&this.manageFields(a.trigger,a.inputField,a.dateFormat)}var ae=navigator.userAgent,au=/opera/i.test(ae),aw=/Konqueror|Safari|KHTML/i.test(ae),ay=/msie/i.test(ae)&&!au&&!/mac_powerpc/i.test(ae),aA=ay&&/msie 6/i.test(ae),aC=/gecko/i.test(ae)&&!aw&&!au&&!ay,aE=ac.prototype,aG=ac.I18N={};ac.SEL_NONE=0,ac.SEL_SINGLE=1,ac.SEL_MULTIPLE=2,ac.SEL_WEEK=3,ac.dateToInt=aT,ac.intToDate=aV,ac.printDate=aZ,ac.formatString=aL,ac.i18n=aN,ac.LANG=function(d,e,f){aG.__=aG[d]={name:e,data:f}},ac.setup=function(a){return new ac(a)},aE.moveTo=function(l,v){var w=this;l=a1(l);var x=aX(l,w.date,!0),y,z=w.args,A=z.min&&aX(l,z.min),B=z.max&&aX(l,z.max);z.animation||(v=!1),aa(A!=null&&A<=1,[w.els.navPrevMonth,w.els.navPrevYear],"DynarchCalendar-navDisabled"),aa(B!=null&&B>=-1,[w.els.navNextMonth,w.els.navNextYear],"DynarchCalendar-navDisabled"),A<-1&&(l=z.min,y=1,x=0),B>1&&(l=z.max,y=2,x=0),w.date=l,w.refresh(!!v),w.callHooks("onChange",w,l,v);if(v&&(x!=0||v!=2)){w._bodyAnim&&w._bodyAnim.stop();var C=w.els.body,D=ab("div","DynarchCalendar-animBody-"+bn[x],C),E=C.firstChild,F=al(E)||0.7,G=y?ak.brakes:x==0?ak.shake:ak.accel_ab2,H=x*x>4,I=H?E.offsetTop:E.offsetLeft,J=D.style,K=H?C.offsetHeight:C.offsetWidth;x<0?K+=I:x>0?K=I-K:(K=Math.round(K/7),y==2&&(K=-K));if(!y&&x!=0){var L=D.cloneNode(!0),M=L.style,N=2*K;L.appendChild(E.cloneNode(!0)),M[H?"marginTop":"marginLeft"]=K+"px",C.appendChild(L)}E.style.visibility="hidden",D.innerHTML=aM(w),w._bodyAnim=aj({onUpdate:function(c,d){var e=G(c);if(L){var h=d(e,K,N)+"px"}if(y){J[H?"marginTop":"marginLeft"]=d(e,K,0)+"px"}else{if(H||x==0){J.marginTop=d(x==0?G(c*c):e,0,K)+"px",x!=0&&(M.marginTop=h)}if(!H||x==0){J.marginLeft=d(e,0,K)+"px",x!=0&&(M.marginLeft=h)}}w.args.opacity>2&&L&&(al(L,1-e),al(D,e))},onStop:function(a){C.innerHTML=aM(w,l),w._bodyAnim=null}})}w._lastHoverDate=null;return A>=-1&&B<=1},aE.isDisabled=function(c){var d=this.args;return d.min&&aX(c,d.min)<0||d.max&&aX(c,d.max)>0||d.disabled(c)},aE.toggleMenu=function(){br(this,!this._menuVisible)},aE.refresh=function(c){var d=this.els;c||(d.body.innerHTML=aM(this)),d.title.innerHTML=aQ(this),d.yearInput.value=this.date.getFullYear()},aE.redraw=function(){var c=this,d=c.els;c.refresh(),d.dayNames.innerHTML=aK(c),d.menu.innerHTML=aS(c),d.bottomBar&&(d.bottomBar.innerHTML=aW(c)),ai(d.topCont,function(a){var b=aY[a.className];b&&(d[b]=a),a.className=="DynarchCalendar-menu-year"?(a7(a,c._focusEvents),d.yearInput=a):ay&&a.setAttribute("unselectable","on")}),c.setTime(null,!0)},aE.setLanguage=function(a){var d=ac.setLanguage(a);d&&(this.fdow=d.data.fdow,this.redraw())},ac.setLanguage=function(c){var d=aG[c];d&&(aG.__=d);return d},aE.focus=function(){try{this.els[this._menuVisible?"yearInput":"focusLink"].focus()}catch(b){}a2.call(this)},aE.blur=function(){this.els.focusLink.blur(),this.els.yearInput.blur(),a4.call(this)},aE.showAt=function(i,j,k){this._showAnim&&this._showAnim.stop(),k=k&&this.args.animation;var l=this.els.topCont,m=this,n=this.els.body.firstChild,o=n.offsetHeight,p=l.style;p.position="absolute",p.left=i+"px",p.top=j+"px",p.zIndex=10000,p.display="",k&&(n.style.marginTop=-o+"px",this.args.opacity>1&&al(l,0),this._showAnim=aj({onUpdate:function(c,d){n.style.marginTop=-d(ak.accel_b(c),o,0)+"px",m.args.opacity>1&&al(l,c)},onStop:function(){m.args.opacity>1&&al(l,""),m._showAnim=null}}))},aE.hide=function(){var f=this.els.topCont,g=this,h=this.els.body.firstChild,i=h.offsetHeight,j=ao(f).y;this.args.animation?(this._showAnim&&this._showAnim.stop(),this._showAnim=aj({onUpdate:function(a,b){g.args.opacity>1&&al(f,1-a),h.style.marginTop=-b(ak.accel_b(a),0,i)+"px",f.style.top=b(ak.accel_ab(a),j,j-10)+"px"},onStop:function(){f.style.display="none",h.style.marginTop="",g.args.opacity>1&&al(f,""),g._showAnim=null}})):f.style.display="none",this.inputField=null},aE.popup=function(j,k){function q(a){var d={x:r.x,y:r.y};if(!a){return d}/B/.test(a)&&(d.y+=j.offsetHeight),/b/.test(a)&&(d.y+=j.offsetHeight-o.y),/T/.test(a)&&(d.y-=o.y),/l/.test(a)&&(d.x-=o.x-j.offsetWidth),/L/.test(a)&&(d.x-=o.x),/R/.test(a)&&(d.x+=j.offsetWidth),/c/i.test(a)&&(d.x+=(j.offsetWidth-o.x)/2),/m/i.test(a)&&(d.y+=(j.offsetHeight-o.y)/2);return d}j=at(j),k||(k=this.args.align),k=k.split(/\x2f/);var l=ao(j),m=this.els.topCont,n=m.style,o,p=ap();n.visibility="hidden",n.display="",this.showAt(0,0),document.body.appendChild(m),o={x:m.offsetWidth,y:m.offsetHeight};var r=l;r=q(k[0]),r.y<p.y&&(r.y=l.y,r=q(k[1])),r.x+o.x>p.x+p.w&&(r.x=l.x,r=q(k[2])),r.y+o.y>p.y+p.h&&(r.y=l.y,r=q(k[3])),r.x<p.x&&(r.x=l.x,r=q(k[4])),this.showAt(r.x,r.y,!0),n.visibility="",this.focus()},aE.manageFields=function(a,f,g){var h=this;f=at(f),a=at(a),/^button$/i.test(a.tagName)&&a.setAttribute("type","button"),a7(a,"click",function(){h.inputField=f,h.dateFormat=g;if(h.selection.type==ac.SEL_SINGLE){var b,c,d,e;b=/input|textarea/i.test(f.tagName)?f.value:f.innerText||f.textContent,b&&(c=/(^|[^%])%[bBmo]/.exec(g),d=/(^|[^%])%[de]/.exec(g),c&&d&&(e=c.index<d.index),b=Calendar.parseDate(b,e),b&&(h.selection.set(b,!1,!0),h.args.showTime&&(h.setHours(b.getHours()),h.setMinutes(b.getMinutes())),h.moveTo(b)))}h.popup(a)})},aE.callHooks=function(e){var f=ag(arguments,1),g=this.handlers[e],h=0;for(;h<g.length;++h){g[h].apply(this,f)}},aE.addEventListener=function(c,d){this.handlers[c].push(d)},aE.removeEventListener=function(e,f){var g=this.handlers[e],h=g.length;while(--h>=0){g[h]===f&&g.splice(h,1)}},aE.getTime=function(){return this.time},aE.setTime=function(f,g){if(this.args.showTime){f=f!=null?f:this.time,this.time=f;var h=this.getHours(),i=this.getMinutes(),j=h<12;this.args.showTime==12&&(h==0&&(h=12),h>12&&(h-=12),this.els.timeAM.innerHTML=aN(j?"AM":"PM")),h<10&&(h="0"+h),i<10&&(i="0"+i),this.els.timeHour.innerHTML=h,this.els.timeMinute.innerHTML=i,g||this.callHooks("onTimeChange",this,f)}},aE.getHours=function(){return Math.floor(this.time/100)},aE.getMinutes=function(){return this.time%100},aE.setHours=function(b){b<0&&(b+=24),this.setTime(100*(b%24)+this.time%100)},aE.setMinutes=function(b){b<0&&(b+=60),b=Math.floor(b/this.args.minuteStep)*this.args.minuteStep,this.setTime(100*this.getHours()+b%60)},aE._getInputYear=function(){var b=parseInt(this.els.yearInput.value,10);isNaN(b)&&(b=this.date.getFullYear());return b},aE._showTooltip=function(e){var f="",g,h=this.els.tooltip;e&&(e=aV(e),g=this.args.dateInfo(e),g&&g.tooltip&&(f="<div class='DynarchCalendar-tooltipCont'>"+aZ(e,g.tooltip)+"</div>")),h.innerHTML=f};var aI=" align='center' cellspacing='0' cellpadding='0'",aY={"DynarchCalendar-topCont":"topCont","DynarchCalendar-focusLink":"focusLink",DynarchCalendar:"main","DynarchCalendar-topBar":"topBar","DynarchCalendar-title":"title","DynarchCalendar-dayNames":"dayNames","DynarchCalendar-body":"body","DynarchCalendar-menu":"menu","DynarchCalendar-menu-year":"yearInput","DynarchCalendar-bottomBar":"bottomBar","DynarchCalendar-tooltip":"tooltip","DynarchCalendar-time-hour":"timeHour","DynarchCalendar-time-minute":"timeMinute","DynarchCalendar-time-am":"timeAM","DynarchCalendar-navBtn DynarchCalendar-prevYear":"navPrevYear","DynarchCalendar-navBtn DynarchCalendar-nextYear":"navNextYear","DynarchCalendar-navBtn DynarchCalendar-prevMonth":"navPrevMonth","DynarchCalendar-navBtn DynarchCalendar-nextMonth":"navNextMonth"},bn={"-3":"backYear","-2":"back",0:"now",2:"fwd",3:"fwdYear"},aF={37:-1,38:-2,39:1,40:2},aH={33:-1,34:1};aE._getDateDiv=function(d){var e=null;if(d){try{ai(this.els.body,function(a){if(a.getAttribute("dyc-date")==d){throw e=a}})}catch(f){}}return e},(ac.Selection=function(e,f,g,h){this.type=f,this.sel=e instanceof Array?e:[e],this.onChange=ah(g,h),this.cal=h}).prototype={get:function(){return this.type==ac.SEL_SINGLE?this.sel[0]:this.sel},isEmpty:function(){return this.sel.length==0},set:function(a,f,g){var h=this.type==ac.SEL_SINGLE;a instanceof Array?(this.sel=a,this.normalize(),g||this.onChange(this)):(a=aT(a),h||!this.isSelected(a)?(h?this.sel=[a]:this.sel.splice(this.findInsertPos(a),0,a),this.normalize(),g||this.onChange(this)):f&&this.unselect(a,g))},reset:function(){this.sel=[],this.set.apply(this,arguments)},countDays:function(){var g=0,h=this.sel,i=h.length,j,k,l;while(--i>=0){j=h[i],j instanceof Array&&(k=aV(j[0]),l=aV(j[1]),g+=Math.round(Math.abs(l.getTime()-k.getTime())/86400000)),++g}return g},unselect:function(j,k){j=aT(j);var l=!1;for(var m=this.sel,n=m.length,o;--n>=0;){o=m[n];if(o instanceof Array){if(j>=o[0]&&j<=o[1]){var p=aV(j),q=p.getDate();if(j==o[0]){p.setDate(q+1),o[0]=aT(p),l=!0}else{if(j==o[1]){p.setDate(q-1),o[1]=aT(p),l=!0}else{var r=new Date(p);r.setDate(q+1),p.setDate(q-1),m.splice(n+1,0,[aT(r),o[1]]),o[1]=aT(p),l=!0}}}}else{j==o&&(m.splice(n,1),l=!0)}}l&&(this.normalize(),k||this.onChange(this))},normalize:function(){this.sel=this.sel.sort(function(c,d){c instanceof Array&&(c=c[0]),d instanceof Array&&(d=d[0]);return c-d});for(var h=this.sel,i=h.length,j,k;--i>=0;){j=h[i];if(j instanceof Array){if(j[0]>j[1]){h.splice(i,1);continue}j[0]==j[1]&&(j=h[i]=j[0])}if(k){var l=k,m=j instanceof Array?j[1]:j;m=aV(m),m.setDate(m.getDate()+1),m=aT(m);if(m>=l){var n=h[i+1];j instanceof Array&&n instanceof Array?(j[1]=n[1],h.splice(i+1,1)):j instanceof Array?(j[1]=k,h.splice(i+1,1)):n instanceof Array?(n[0]=j,h.splice(i,1)):(h[i]=[j,n],h.splice(i+1,1))}}k=j instanceof Array?j[0]:j}},findInsertPos:function(e){for(var f=this.sel,g=f.length,h;--g>=0;){h=f[g],h instanceof Array&&(h=h[0]);if(h<=e){break}}return g+1},clear:function(b){this.sel=[],b||this.onChange(this)},selectRange:function(a,g){a=aT(a),g=aT(g);if(a>g){var h=a;a=g,g=h}var i=this.cal.args.checkRange;if(!i){return this._do_selectRange(a,g)}try{aq((new ac.Selection([[a,g]],ac.SEL_MULTIPLE,ar)).getDates(),ah(function(b){if(this.isDisabled(b)){i instanceof Function&&i(b,this);throw"OUT"}},this.cal)),this._do_selectRange(a,g)}catch(j){}},_do_selectRange:function(c,d){this.sel.push([c,d]),this.normalize(),this.onChange(this)},isSelected:function(d){for(var e=this.sel.length,f;--e>=0;){f=this.sel[e];if(f instanceof Array&&d>=f[0]&&d<=f[1]||d==f){return !0}}return !1},getFirstDate:function(){var b=this.sel[0];b&&b instanceof Array&&(b=b[0]);return b},getLastDate:function(){if(this.sel.length>0){var b=this.sel[this.sel.length-1];b&&b instanceof Array&&(b=b[1]);return b}},print:function(h,i){var j=[],k=0,l,m=this.cal.getHours(),n=this.cal.getMinutes();i||(i=" -> ");while(k<this.sel.length){l=this.sel[k++],l instanceof Array?j.push(aZ(aV(l[0],m,n),h)+i+aZ(aV(l[1],m,n),h)):j.push(aZ(aV(l,m,n),h))}return j},getDates:function(f){var g=[],h=0,i,j;while(h<this.sel.length){j=this.sel[h++];if(j instanceof Array){i=aV(j[0]),j=j[1];while(aT(i)<j){g.push(f?aZ(i,f):new Date(i)),i.setDate(i.getDate()+1)}}else{i=aV(j)}g.push(f?aZ(i,f):i)}return g}},ac.isUnicodeLetter=function(b){return b.toUpperCase()!=b.toLowerCase()},ac.parseDate=function(a,p,q){if(!/\S/.test(a)){return""}a=a.replace(/^\s+/,"").replace(/\s+$/,""),q=q||new Date;var r=null,s=null,t=null,u=null,v=null,w=null,x=a.match(/([0-9]{1,2}):([0-9]{1,2})(:[0-9]{1,2})?\s*(am|pm)?/i);x&&(u=parseInt(x[1],10),v=parseInt(x[2],10),w=x[3]?parseInt(x[3].substr(1),10):0,a=a.substring(0,x.index)+a.substr(x.index+x[0].length),x[4]&&(x[4].toLowerCase()=="pm"&&u<12?u+=12:x[4].toLowerCase()=="am"&&u>=12&&(u-=12)));var y=function(){function F(c){l.push(c)}function E(){var c="";while(o()&&/[0-9]/.test(o())){c+=n()}if(C(o())){return D(c)}return parseInt(c,10)}function D(c){while(o()&&C(o())){c+=n()}return c}function o(){return a.charAt(b)}function n(){return a.charAt(b++)}var b=0,l=[],m,C=ac.isUnicodeLetter;while(b<a.length){m=o(),C(m)?F(D("")):/[0-9]/.test(m)?F(E()):n()}return l}(),z=[];for(var A=0;A<y.length;++A){var B=y[A];/^[0-9]{4}$/.test(B)?(r=parseInt(B,10),s==null&&t==null&&p==null&&(p=!0)):/^[0-9]{1,2}$/.test(B)?(B=parseInt(B,10),B<60?B<0||B>12?B>=1&&B<=31&&(t=B):z.push(B):r=B):s==null&&(s=a3(B))}z.length<2?z.length==1&&(t==null?t=z.shift():s==null&&(s=z.shift())):p?(s==null&&(s=z.shift()),t==null&&(t=z.shift())):(t==null&&(t=z.shift()),s==null&&(s=z.shift())),r==null&&(r=z.length>0?z.shift():q.getFullYear()),r<30?r+=2000:r<99&&(r+=1900),s==null&&(s=q.getMonth()+1);return r!=null&&s!=null&&t!=null?new Date(r,s-1,t,u,v,w):null};var ak={elastic_b:function(b){return 1-Math.cos(-b*5.5*Math.PI)/Math.pow(2,7*b)},magnetic:function(b){return 1-Math.cos(b*b*b*10.5*Math.PI)/Math.exp(4*b)},accel_b:function(b){b=1-b;return 1-b*b*b*b},accel_a:function(b){return b*b*b},accel_ab:function(b){b=1-b;return 1-Math.sin(b*b*Math.PI/2)},accel_ab2:function(b){return(b/=0.5)<1?0.5*b*b:-0.5*(--b*(b-2)-1)},brakes:function(b){b=1-b;return 1-Math.sin(b*b*Math.PI)},shake:function(b){return b<0.5?-Math.cos(b*11*Math.PI)*b*b:(b=1-b,Math.cos(b*11*Math.PI)*b*b)}},ar=new Function;return ac}();