var reviews_page=0;function setGuests(){var a="";if($("#guests_sel").val()===""){a=$("#guests_sel_rooms").val()+"-"+$("#guests_sel_adults").val()+"-"+$("#guests_sel_children").val()}else{a=$("#guests_sel").val()}$("#guests").val(a)}function setGuestsFields(){var b=$("#guests").val();if(b=="1-1-0"||b=="1-2-0"){$(".guestSelectGroup").hide();$("#guests_sel").val(b)}else{$(".guestSelectGroup").show();$("#guests_sel").val("");var a=b.split("-");$("#guests_sel_rooms").val(a[0]);$("#guests_sel_adults").val(a[1]);$("#guests_sel_children").val(a[2])}}function setCurrency(b,c,d,e,a){$.fancybox.close();$(".changeCurrencyBtn").html(a)}$(document).ready(function(){var a=false;initSocialActions();initReviewsDocuments();$(".more").click(function(){var d=$(this);var e=d.prev();var f=e.find("div.stanTXT").height();if(a){e.stop().animate({height:101},500,function(){d.html(t("> more"))});a=false}else{e.stop().animate({height:f},500,function(){d.html(t("< less"))});a=true}});var b=false;$(".more2").click(function(){var d=$(this);var e=d.prev();var f=e.find("div.stanTXT").height();if(b){e.stop().animate({height:54},500,function(){d.html(t("> more"))});b=false}else{e.stop().animate({height:f},500,function(){d.html(t("< less"))});b=true}});$(document).on("click",".account-btn-cancel",function(){$(".fancybox-close").click()});$(document).on("click","#saveabout",function(){$(".sharePopUpRapper_error").html("");var f=$("#thotel").attr("data-id");var e=$(this);var d=e.parent().parent();var g=getObjectData(d.find(".sharePopUpTextArea"));var h=new Array();d.find(".peoplecontainer .peoplesdata").each(function(){var i=$(this);if(i.attr("id")=="friendsdata"){h.push({friends:1})}else{if(i.attr("id")=="followersdata"){h.push({followers:1})}else{if(i.attr("id")=="friends_of_friends_data"){h.push({friendsandfollowers:1})}else{if(i.attr("data-email")!=""){h.push({email:i.attr("data-email")})}else{if(parseInt(i.attr("data-id"))!=0){h.push({id:i.attr("data-id")})}}}}}});if(h.length==0){$(".sharePopUpRapper_error").html(t("Invalid share data"));return}TTCallAPI({what:"social/share",data:{entity_type:SOCIAL_ENTITY_HOTEL,entity_id:f,share_with:h,share_type:SOCIAL_SHARE_TYPE_SHARE,msg:g,channel_id:null,addToFeeds:1},callback:function(i){$(".fancybox-close").click()}})});$(document).on("click",".reviews_more",function(){reviews_page++;getMoreReviews()});if($("#addmoretext_privacy").length>0){addmoreusersautocomplete_custom_journal($("#addmoretext_privacy"))}$(document).on("click",".uploadinfocheckbox",function(){if($(this).hasClass("active")){$(this).removeClass("active");if($(this).hasClass("uploadinfocheckbox3")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#friendsdata").remove()}}else{if($(this).hasClass("uploadinfocheckbox_friends_of_friends")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#friends_of_friends_data").remove()}}else{if($(this).hasClass("uploadinfocheckbox4")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#followersdata").remove()}}}}}else{$(this).addClass("active");if($(this).hasClass("uploadinfocheckbox3")){if($(this).parent().hasClass("friendscontainer")){var e='<div class="peoplesdata formttl13" id="friendsdata" data-email="" data-id=""><div class="peoplesdatainside">'+t("friends")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(e)}}else{if($(this).hasClass("uploadinfocheckbox_friends_of_friends")){if($(this).parent().hasClass("friendscontainer")){var d='<div class="peoplesdata formttl13" id="friends_of_friends_data" data-email="" data-id=""><div class="peoplesdatainside">'+t("friends of friends")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(d)}}else{if($(this).hasClass("uploadinfocheckbox4")){if($(this).parent().hasClass("friendscontainer")){var d='<div class="peoplesdata formttl13" id="followersdata" data-email="" data-id=""><div class="peoplesdatainside">'+t("followers")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(d)}}}}}});$(document).on("click","#reviewFormSubmit0",function(){TTAlert({msg:t("you need to have a")+' <a class="black_link" href="'+ReturnLink("/register")+'">'+t("TT account")+"</a> "+t("in order to write a review."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})});$(document).on("click","#reviewFormSubmit1",function(){var e="";var d=$("#thotel").attr("data-id");if($("#reviewVal").val()==""){e=t("Your review cannot be empty ! <br />")}else{if(!$(".reviewCheckbox").hasClass("uploadinfocheckboxpicactive")){e=t("Your have to certify that this review is based on your own experience !")}}if(e!=""){TTAlert({msg:e,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{TTCallAPI({what:"user/reviews/add",data:{entity_type:SOCIAL_ENTITY_HOTEL,item_id:d,title:"",description:$("#reviewVal").val()},callback:function(f){if(f.status==="error"){TTAlert({msg:f.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}window.location.reload()}})}});$(".shareThis").fancybox({padding:0,margin:0,beforeLoad:function(){resetSelectedUsers();$("#sharePopUp .peoplecontainer .peoplesdata").each(function(){$(this).remove()});$("#sharePopUp .uploadinfocheckbox").removeClass("active")}});autocompleteHotels($("#destinationInput"));$(document).on("click",".changeSearch",function(){$(".basicSearchPart").show()});$(document).on("click",".hideSearchPart",function(){$(".basicSearchPart").hide()});$(".reviewCheckbox").click(function(){var d=$(this);if(d.hasClass("uploadinfocheckboxpicactive")){d.removeClass("uploadinfocheckboxpicactive")}else{d.addClass("uploadinfocheckboxpicactive")}});$(document).on("click",".thumbsForwardEnable,.thumbsBackEnable",function(){var d=$(this).attr("data-hotel");var e=$(this).attr("data-page");$.post(ReturnLink("/ajax/ajax_thotel_media.php"),{hotel:d,to:e},function(f){var h=null;try{h=$.parseJSON(f)}catch(g){return}if(h.error){TTAlert({msg:h.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{$(".hotelListPhotosContainer").html(h.media)}})});$(".searchButton").click(function(){var i=$("#destinationInput").val();if(i==""){TTAlert({msg:t("You have to specify a destination"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}var h="";var d=$("#fromtxt").attr("data-cal");var e=$("#totxt").attr("data-cal");var f=$("#destinationInput").attr("data-hotel");var g="";if(typeof d!=="undefined"&&d!==""){g+="/from/"+d;if(typeof e!=="undefined"&&e!==""){g+="/to/"+e}}if($("#guests").val()!=""){h+="/room/"+$("#guests").val()}if($("#destinationInput").attr("data-city")!=""){h+="/C/"+$("#destinationInput").attr("data-city")}if($("#destinationInput").attr("data-state-code")!=""){h+="/ST/"+$("#destinationInput").attr("data-state-code")}if($("#destinationInput").attr("data-code")!=""){h+="/CO/"+$("#destinationInput").attr("data-code")}if(f!=""&&parseInt(f)>0){var j=ReturnLink("/thotel/id/"+parseInt(f)+"/s/"+i+h+g);document.location.href=j}else{var j=ReturnLink("/hotel-search/"+i+h+g);window.open(j,"_blank")}});$(".hotelRoomGallerySmall").click(function(){var e=$(this).attr("data-val");var d=$(this).closest(".hotelRoomBlock");if(d.hasClass("hotelRoomBlockClosed")){d.removeClass("hotelRoomBlockClosed");d.prev().addClass("hotelRoomBlockHeadActive")}$(this).parent().next().find(".hotelRoomGalleryBig").attr("src",e)});$(".evalOptionContainer_hotel").click(function(){if(!$(this).hasClass("active")){var d=$(this);var e=$(this).attr("data-value");TTCallAPI({what:ReturnLink("/ajax/modal_newsfeed_rate.php"),data:{entity_id:$("#thotel").attr("data-id"),entity_type:$("#thotel").attr("data-type"),score:e,globchannelid:null},ret:"json",callback:function(f){if(f.status=="error"){TTAlert({msg:f.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}$(".evalOptionContainer").removeClass("active");d.addClass("active")}})}});$(".hotelRoomBlockHead").click(function(){var d=$(this);if(!d.hasClass("hotelRoomBlockHeadActive")){d.addClass("hotelRoomBlockHeadActive");d.next().removeClass("hotelRoomBlockClosed")}else{d.removeClass("hotelRoomBlockHeadActive");d.next().addClass("hotelRoomBlockClosed")}});$(".hotelFacilitiesHeadContainer").click(function(){var e=$(this);var d=e.closest(".hotelFacilities");if(!e.hasClass("hotelFacilitiesHeadContainerActive")){e.addClass("hotelFacilitiesHeadContainerActive");d.find(".hotelFacilitiesBody").show()}else{e.removeClass("hotelFacilitiesHeadContainerActive");d.find(".hotelFacilitiesBody").hide()}});$(".hotelPoliciesHeadContainer").click(function(){var d=$(this);if(!d.hasClass("hotelPoliciesHeadContainerActive")){d.addClass("hotelPoliciesHeadContainerActive");$(".hotelPoliciesBody").show()}else{d.removeClass("hotelPoliciesHeadContainerActive");$(".hotelPoliciesBody").hide()}});$(".reviewComment").focus(function(){$(this).val("")});$(".reviewComment").blur(function(){if($(this).val()==""){$(this).val("Write a comment...")}});$(document).on("click",".hotelListPic",function(){var d=$(this).attr("data-src");$(".hotelBigImg").css("width",$(this).attr("data-w"));$(".hotelBigImg").css("height",$(this).attr("data-h"));$(".hotelBigImg").attr("src","");$(".hotelBigImg").attr("src",d)});var c=parent.window.returnIframeDimensions();$(".showOnMap").fancybox({width:c[0],height:c[1],closeBtn:true,autoSize:false,autoScale:true,transitionIn:"elastic",transitionOut:"fadeOut",type:"iframe",padding:0,margin:0,scrolling:"no",helpers:{overlay:{closeClick:true}}});$("#activetubers").on("mouseover","img",function(f){if(!$(this).data("title")){$(this).data("title",$(this).attr("title"));$(this).attr("title","")}var i=$(this).data("title");var d=(i!=="")?"<br/>"+i:"";$("body").append("<div id='preview'><img src='"+$(this).attr("data-src")+"' alt='Image preview' style='width: 100px;height: 100px;'/>"+d+"</div>");var h=$(this).offset().top;var g=$(this).offset().left+28;$("#preview").css("top",h+"px").css("left",g+"px").css({position:"absolute",border:"1px solid #ccc",background:"#333","font-size":"12px",padding:"5px",display:"none",color:"#fff","z-index":10000,"text-align":"center"}).fadeIn("fast")}).on("mouseout","img",function(){$("#preview").remove()}).mousemove(function(d){});$(document).on("change","#guests_sel",function(){if($(this).val()==""){$(".guestSelectGroup").show()}else{$(".guestSelectGroup").hide()}setGuests()});setGuestsFields();$(document).on("change","#guests_sel_rooms,#guests_sel_adults,#guests_sel_children",function(){setGuests()});$("#guests_sel").change();InitCalendar()});function InitCalendar(){Calendar.setup({inputField:"fromtxt",noScroll:true,trigger:"fromtxt",align:"B",onSelect:function(){var a=Calendar.intToDate(this.selection.get());TO_CAL.args.min=a;TO_CAL.redraw();$("#fromtxt").attr("data-cal",Calendar.printDate(a,"%Y-%m-%d"));addCalToEvent(this);this.hide()},dateFormat:"%d / %m / %Y"});TO_CAL=Calendar.setup({inputField:"totxt",noScroll:true,trigger:"totxt",align:"B",onSelect:function(){var a=Calendar.intToDate(this.selection.get());$("#totxt").attr("data-cal",Calendar.printDate(a,"%Y-%m-%d"));addCalToEvent(this);this.hide()},dateFormat:"%d / %m / %Y"})}function addCalToEvent(a){if(new Date($("#fromtxt").attr("data-cal"))>new Date($("#totxt").attr("data-cal"))){$("#totxt").attr("data-cal",$("#fromtxt").attr("data-cal"));$("#totxt").val($("#fromtxt").val())}}function getMoreReviews(){$(".upload-overlay-loading-fix").show();$.ajax({url:ReturnLink("/ajax/ajax_load_reviews.php"),data:{page:reviews_page,entity_id:$("#thotel").attr("data-id"),entity_type:$("#thotel").attr("data-type")},type:"post",success:function(a){$(".upload-overlay-loading-fix").hide();var e=null;try{e=$.parseJSON(a)}catch(c){return}if(e.error){TTAlert({msg:e.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{var d=e.data;var b=e.count;$(".hotelReviews").append(d);initReviewsDocuments();initCommentData();if(b-reviews_page*6>6){$(".reviews_more").show()}else{$(".reviews_more").hide()}}}})}function initReviewsDocuments(){$(".social_data_all").each(function(b,a){if($(this).find(".social_not_refreshed").length>0){initComments($(this));initLikes($(this));initShares($(this))}})};