var uploaderPDF=null;var requirements_met=true;var upload_started;function InitChannelUploaderPDF(b){uploaderPDF=new plupload.Uploader({runtimes:"html5,flash",button_browse_hover:true,max_file_size:100+"mb",container:"uploadContainer"+b,browse_button:"uploadBtn"+b,url:ReturnLink("/channel-upload-file.php"),flash_swf_url:ReturnLink("/js/plupload/plupload.flash.swf"),multi_selection:false,multipart_params:{channel_id:globchannelid,which_uploader:b,SID:$("#SID").val()},filters:[{title:"Image files",extensions:"pdf"},],init:a});uploaderPDF.bind("Init",function(d,c){if((c.runtime=="flash")&&!swfobject.hasFlashPlayerVersion("10")){requirements_met=false;if(pagename!="brochure"){TTAlert({msg:t("Please update your flash installation to at least version 10"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{$("#brochureerror").html(t("Please update your flash installation to at least version 10"))}}});uploaderPDF.init();function a(c){c.bind("FilesAdded",function(e,d){e.settings.multipart_params={channel_id:globchannelid,which_uploader:b,SID:$("#SID").val()};if(!requirements_met){if(pagename!="brochure"){TTAlert({msg:t("Please update your flash installation to at least version 10"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{$("#brochureerror").html(t("Please update your flash installation to at least version 10"))}return false}setTimeout(function(){c.start()},100);$.each(d,function(h,g){var f=g.id;addAction(g,f,b);$("#uploadContainer"+b+" .filediv").html('<div class="filename"></div><div class="progressbar"><span class="progressvalue"></span><div class="progress"></div></div><span class="status" ></span><span class="cancel" >&nbsp;</span><span class="pause" >&nbsp;</span><span class="resume" >&nbsp;</span><div class="pdf_icon"></div>');$("#uploadContainer"+b).find("span.progressvalue").text("0%")})});c.bind("UploadFile",function(f,e){var d=e.id;upload_started=1;$("#uploadContainer"+b+" .pause").show();$("#uploadContainer"+b+" span.status").html(t("Uploading ..."));$("#uploadContainer"+b).find("span.progressvalue").text("0%")});c.bind("UploadProgress",function(f,e){var d=e.id;$("#uploadContainer"+b).find("div.progress").css("width",e.percent+"%");$("#uploadContainer"+b).find("div.progress").css("background-color","#f0bf1b");$("#uploadContainer"+b).find("span.progressvalue").text(e.percent+"%")});c.bind("Error",function(e,d){if(pagename!="brochure"){if(d.code==-600){TTAlert({msg:d.message+"<br/>maximum size: "+imgsize+"mb",type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{if(d.file&&d.file.name){TTAlert({msg:t("Error: ")+d.file.name+" "+d.message,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{TTAlert({msg:t("Error: ")+d.message,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}}else{if(d.code==-600){$("#brochureerror").html(d.message+"<br/>maximum size: "+imgsize+"mb")}else{if(d.file&&d.file.name){$("#brochureerror").html(t("Error: ")+d.file.name+" "+d.message)}else{$("#brochureerror").html(t("Error: ")+d.message)}}}c.refresh()});c.bind("FileUploaded",function(j,f,i){upload_started=0;var e=f.id;var g=$("#uploadContainer"+b);var h;try{h=$.parseJSON(i.response)}catch(d){return}if(h.status!=="ok"){if(pagename!="brochure"){TTAlert({msg:h.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{$("#brochureerror").html(h.error)}}else{g.find("div.progress").css({width:"100%","background-color":"#73c563","background-image":"none"});g.find("span.progressvalue").text("100%").css({color:"#686868"});g.addClass("success").find("span.status").html('<span class="status2">'+t("Upload Complete")+"</span>");g.find(".pause").hide();g.find(".resume").hide();g.find(".cancel").hide();g.find(".pdf_icon").show();g.attr("data-pdf",h.name)}})}}function addAction(a,b,c){$(document).on("click",".pause",function(){var e=uploaderPDF.getFile(b);if(!e||e.status!=plupload.UPLOADING){return}var d=$(this);d.hide();$(".resume").show();$("span.status").html(t("Paused"));$("div.progress").css("width",0+"%");$("span.progressvalue").text(0+"%");PauseUpload()});$(document).on("click",".resume",function(){var d=uploaderPDF.getFile(b);if(!d||d.status==plupload.UPLOADING){return}$(this).hide();$(".pause").show();$("span.status").html(t("Uploading"));ResumeUpload()});$(document).on("click",".cancel",function(){var d=uploaderPDF.getFile(b);if(!d){}else{if(d.status==plupload.UPLOADING){uploaderPDF.stop();uploaderPDF.removeFile(a)}else{uploaderPDF.removeFile(a)}}$("#uploadContainer"+c+" .filediv").html("")})}function PauseUpload(){uploaderPDF.stop()}function ResumeUpload(){uploaderPDF.start()};