var restaurant_page=0;var TO_CAL;var destination;var country_code;var state_code;var time_val;var date_val;var persons_val;var city_code;var resto_code;var tuberEvals;var priceRange;var orderBy="id";var direction="DESC";function returnLink(a){return a}function checkboxVal(b){var a=new Array();$("."+b).each(function(){if($(this).hasClass("checkboxActive")){var c=$(this).attr("data-value");a.push(c)}});return a}function getCurrentTime(){var c=new Date();var a=c.getHours();if(a<10){a="0"+a}var b=c.getMinutes();if(b<10){b="0"+b}var d=a+":"+b;return d}function navigatePhotos(b,a,c){if(c!=""){$.post(ReturnLink("/ajax/ajax_restaurant_search_media.php"),{restaurant:b,from:a,to:c},function(d){var f=null;try{f=$.parseJSON(d)}catch(e){return}if(f.error){TTAlert({msg:f.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{$(".smallImgListCont[data-value='"+b+"']").html(f.media);$(".smallImgPrev[data-value='"+b+"']").attr("data-page",c);$(".smallImgPrev[data-value='"+b+"']").attr("data-to",f.mediaPrev);$(".smallImgNext[data-value='"+b+"']").attr("data-page",c);$(".smallImgNext[data-value='"+b+"']").attr("data-to",f.mediaNext)}})}}function redirectToTRestaurant(b,a,f,e){var c=ReturnLink("/trestaurant/id/"+parseInt(b));if(a!=""){c+="/d/"+a}if(f!=""){c+="/t/"+f}if(e!=""){c+="/persons/"+e}document.location.href=c}function setCurrency(a,c,d,e,b){$.fancybox.close();$(".budgetCheckboxGroup").html(a);$(".changeCurrencyBtn").html(b);filterSearch()}function filterSearch(){destination=$(".destinationInput").val();country_code=$(".destinationInput").attr("data-code");state_code=$(".destinationInput").attr("data-state-code");city_code=$(".destinationInput").attr("data-city");if(typeof $(".destinationInput").attr("data-hotel")!=="undefined"&&$(".destinationInput").attr("data-hotel")!="false"){resto_code=$(".destinationInput").attr("data-hotel")}else{resto_code=""}date_val=$("#fromtxt").attr("data-cal");time_val=$("#defaultEntry").val();persons_val=$("#nbOfPersons_sel").val();priceRange=checkboxVal("budgetCheckbox");if(resto_code!=""&&resto_code!="undefined"){redirectToTRestaurant(resto_code,date_val,time_val,persons_val)}else{initRestaurantSearch(false)}}function initRestaurantSearch(a){if(!a){a=0;restaurant_page=0;$(".allHotelsContainer").html("")}else{restaurant_page++}$(".upload-overlay-loading-fix").show();$.post(ReturnLink("/ajax/ajax_restaurant_search.php"),{orderBy:orderBy,direction:direction,restaurant_page:restaurant_page,destination:destination,country_code:country_code,state_code:state_code,persons:persons_val,d:date_val,t:time_val,city_code:city_code,tuberEvals:tuberEvals},function(d){var k=null;try{k=$.parseJSON(d)}catch(e){$(".upload-overlay-loading-fix").hide();return}if(k.error){TTAlert({msg:k.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{$(".allHotelsContainer").append(k.restaurants);$(".hotelSearchHeadRightDesc").html(k.restaurantSearchHeadRightDesc);$(".globDescContainerLeft").html(k.destinationDesc);$(".globDescContainerRightPrecent").html(k.percent);if(k.restaurantsCount>(9*(restaurant_page+1))){$(".buttonmorebigcontainer").show()}else{$(".buttonmorebigcontainer").hide()}$(".sortingOpt").removeClass("sortingActive");$(".sortElt").removeClass("sortingActive");$(".sortingOpt[data-value='"+orderBy+"']").addClass("sortingActive");$(".sortElt[data-value='"+orderBy+"'][data-direction='"+direction+"']").addClass("sortingActive");var b=$(".leftBlockMap");var c=b.attr("id");var f=new google.maps.MarkerImage(ReturnLink("/images/pin_rest.png"));var j=[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}];var h={center:new google.maps.LatLng(k.latitude,k.longitude),zoom:12,disableDefaultUI:true,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:j};var g=new google.maps.Map(document.getElementById(c),h);var i=new google.maps.Marker({position:new google.maps.LatLng(k.latitude,k.longitude),map:g,icon:f,title:destination})}$(".upload-overlay-loading-fix").hide()})}$(document).ready(function(){autocompleteRestaurants($("#destinationInput"));filterSearch();$(".searchButton").click(function(){filterSearch()});if($("#defaultEntry").val()===""){$("#defaultEntry").val(getCurrentTime())}$("#defaultEntry").timeEntry({show24Hours:true});$(".sortElt").click(function(){orderBy=$(this).attr("data-value");direction=$(this).attr("data-direction");filterSearch()});$(document).on("click",".cuisineMoreLess",function(){var a=$(this);var c="";var b="";var d="";c=$(this).attr("data-value");b=$(this).html();d=$(this).attr("data-other");if(c=="more"){$(".cuisineCheckboxSmallGroup").hide();$(".cuisineCheckboxFullGroup").show();a.html(d);a.attr("data-value","less");a.attr("data-other",b)}else{$(".cuisineCheckboxFullGroup").hide();$(".cuisineCheckboxSmallGroup").show();a.html(d);a.attr("data-value","more");a.attr("data-other",b)}});$(document).on("click","#hotel_load_more",function(a){a.preventDefault();initRestaurantSearch(true)});$(document).on("click",".smallImgPrev,.smallImgNext",function(){var a="";var c="";var b=0;a=$(this).attr("data-page");c=$(this).attr("data-to");b=$(this).attr("data-value");navigatePhotos(b,a,c)});$(".cuisineCheckbox").click(function(){var b=new Array();var c=$(this);var a=c.attr("data-value");if(c.hasClass("checkboxActive")){$(".cuisineCheckbox[data-value='"+a+"']").removeClass("checkboxActive");b=checkboxVal("cuisineCheckbox");$(".checkboxActive").removeClass("checkboxActive");b.forEach(function(d){$(".cuisineCheckbox[data-value='"+d+"']").addClass("checkboxActive")})}else{c.addClass("checkboxActive");b=checkboxVal("cuisineCheckbox");$(".checkboxActive").removeClass("checkboxActive");b.forEach(function(d){$(".cuisineCheckbox[data-value='"+d+"']").addClass("checkboxActive")})}});$(".offerCheckbox,.menuCheckbox,.serviceCheckbox,.cardCheckbox,.withCheckbox,.restrictionCheckbox,.mealCheckbox,.occasionCheckbox,.tuberCheckbox").click(function(){var a=$(this);if(a.hasClass("checkboxActive")){a.removeClass("checkboxActive")}else{a.addClass("checkboxActive")}});$("body").on("click",".openHotelCollapsePart",function(){$(this).parent().hide().prev().show()});$("body").on("click",".smallImg",function(){var a=$(this).closest(".aHotelContainer");var b=$(this).attr("data-value");a.find(".LargeSizeImg").css("width",$(this).attr("data-w"));a.find(".LargeSizeImg").css("height",$(this).attr("data-h"));a.find(".LargeSizeImg").attr("src","");a.find(".LargeSizeImg").attr("src",b)});$(".checkOnMap").fancybox({width:800,height:600,closeBtn:true,autoSize:false,autoScale:true,transitionIn:"elastic",transitionOut:"fadeOut",type:"iframe",padding:0,margin:0,scrolling:"no"});$(".changeCurrency").fancybox({width:888,height:650,closeBtn:true,autoSize:false,autoScale:true,transitionIn:"elastic",transitionOut:"fadeOut",type:"iframe",padding:0,margin:0,scrolling:"no"});InitCalendar()});function InitCalendar(){Calendar.setup({inputField:"fromtxt",noScroll:true,trigger:"fromtxt",align:"B",onSelect:function(){var a=Calendar.intToDate(this.selection.get());$("#fromtxt").attr("data-cal",Calendar.printDate(a,"%Y-%m-%d"));this.hide()},dateFormat:"%d / %m / %Y"})}function addCalToEvent(a){if(new Date($("#fromtxt").attr("data-cal"))>new Date($("#totxt").attr("data-cal"))){$("#totxt").attr("data-cal",$("#fromtxt").attr("data-cal"));$("#totxt").html($("#fromtxt").html())}};