var currentcategory="";var currentPage=0;$(document).ready(function(){autocompleteDiscover($("#citySearch"));$(document).on("click",".search-button",function(){var d=$("#citySearch").val();if(d==""){return}var b=""+($("#citySearch").attr("data-code")).toUpperCase();var c=parseInt($("#citySearch").attr("data-iscountry"));var a=parseInt($("#citySearch").attr("data-id"));if(a!=0&&a!=""){d="C/"+a}if(c==0&&b!=""){d+="/CO/"+b}else{if(c==1&&b!=""){d="CO/"+b}}if(d!=""){window.location.href=ReturnLink("/things-to-do-search/"+d)}});$(document).on("click",".bagcontainer_a0",function(a){event.preventDefault();TTAlert({msg:$.i18n._("you have to sign in, in order to access a tuber page"),type:"action",btn1:t("cancel"),btn2:"register",btn2Callback:function(b){if(b){window.location.href=ReturnLink("/register")}}})});$(document).on("click",".hotelsplus",function(){var b=$(this);if(b.hasClass("stationBagAct")){return}if(b.hasClass("inactive")){TTAlert({msg:t("you need to have a")+' <a class="black_link" href="'+ReturnLink("/register")+'">'+t("TT account")+"</a> "+t("in order to add items to your bag."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}var a=b.closest(".topThingsToDo_all");var f=a.attr("data-id");var c=""+(a.attr("data-city"));var d=""+(a.attr("data-country"));var e=a.attr("data-type");TTCallAPI({what:"/user/bag/add",data:{item_id:f,entity_type:e,data_city:c,data_country:d},callback:function(h){if(h.status==="error"){TTAlert({msg:h.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}var g=parseInt($(".bag_count").attr("data-count"))+1;$(".bag_count").attr("data-count",g);if(g>99){g="99+"}$(".bag_count").html(g);b.removeClass("hotelsplus");b.addClass("stationBagAct")}})});$(document).on("click",".thingsToDoStepplus",function(){var b=$(this);if(b.hasClass("stationBag")){return}if(b.hasClass("inactive")){TTAlert({msg:t("you need to have a")+' <a class="black_link" href="'+ReturnLink("/register")+'">'+t("TT account")+"</a> "+t("in order to add items to your bag."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}var a=b.closest(".thingsToDoStep_poi_info");var f=a.attr("data-id");var c=""+($(".thingsToDohead").attr("data-city"));var d=""+($(".thingsToDohead").attr("data-country"));var e=a.attr("data-type");TTCallAPI({what:"/user/bag/add",data:{item_id:f,entity_type:e,data_city:c,data_country:d},callback:function(h){if(h.status==="error"){TTAlert({msg:h.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}var g=parseInt($(".bag_count").attr("data-count"))+1;$(".bag_count").attr("data-count",g);if(g>99){g="99+"}$(".bag_count").html(g);b.removeClass("thingsToDoStepplus");b.addClass("stationBag")}})});$("#loadmore").click(function(a){a.preventDefault();a.stopImmediatePropagation();currentPage++;displaydatarelated()});$(document).on("click",".thingsToDoStep_category",function(){if($(this).hasClass("active")){return}currentPage=0;$(".thingsToDoStep_category").removeClass("active");$(this).addClass("active");currentcategory=$(this).attr("data-label");$(".thingsToDoStep_right_part").html("");displaydatarelated()})});function checkSubmitcatadd(a){if(a&&a.keyCode==13){$(".discover_button").click()}}function displaydatarelated(){$(".upload-overlay-loading-fix-file").show();var a=""+($(".thingsToDohead").attr("data-city"));var b=""+($(".thingsToDohead").attr("data-country"));$.post(ReturnLink("/ajax/ajax_getthingstodosearch.php"),{data_city:a,data_country:b,page:currentPage,currentcategory:currentcategory},function(c){var e=null;try{e=$.parseJSON(c)}catch(d){}if(!e){return}$(".thingsToDoStep_right_part").append(e.data);if(e.tohideLoad==1){$("#loadmore").addClass("displaynone")}else{$("#loadmore").removeClass("displaynone")}$(".upload-overlay-loading-fix-file").hide()})};