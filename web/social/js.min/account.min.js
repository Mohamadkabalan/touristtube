var theAction="";function CloseAccordion(a){a.click()}function ChangeTo(b,a){if(b=="closed"){a.attr("rel","openned");a.css({"background-color":"#838383"});a.animate({width:"140px",height:"130px"},500,function(){})}else{if(b=="openned"){a.attr("rel","closed");a.animate({width:"20px",height:"20px"},500,function(){a.css({"background-color":"#FFFFFF"})})}}}function checkSubmitsignInbtn(a){if(a&&a.keyCode==13){$("#signInbtn_settings").click()}}function clearForm(){$("#SEmailField").val("");$("#SPasswordField").val("");$("#SEmailField").blur();$("#SPasswordField").blur()}function ChangeCheckBox(a,b){if(b=="1"){a.addClass("checkboxActive");a.attr("data-value",1)}else{a.removeClass("checkboxActive");a.attr("data-value",0)}}function checkCityData(a){$(a).attr("data-id","")}$(document).ready(function(){$(".account-btn-cancel").click(function(){var a=$(this);var b=a.closest("div.AccountInfo_item");if(b.length>0){if(b.hasClass("active")){b.find(".AccountTitle").click()}}else{document.location.reload()}});$(document).on("change",".AccountCountrySelect",function(){var a=$(this).closest(".AccountInfo_item");a.find("input[name=city]").val("");a.find("input[name=city]").attr("data-id","")});$(document).on("click",".tellWhy",function(){$("#deleteTellContainer").toggle()});$(document).on("click","#deleteTellContainer .deleteTellOpt:last,#deleteTellContainer .deleteTellOpt:last .contentPrivacyLabel",function(){if($("#deleteTellContainer .deleteTellOpt:last").attr("data-value")=="1"){$("#reportcontainer").show()}else{$("#reportcontainer").hide()}});$(document).on("click",".fb_disconnect",function(){TTCallAPI({what:"user/fb_disconnect",data:{},callback:function(a){if(a.status==="error"){TTAlert({msg:a.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}document.location.href=ReturnLink("/account/sharing")}})});$(document).on("click",".peoplesdataclose",function(){var a=$(this).parent();var b=a.parent().parent();a.remove();if(a.attr("data-id")!=""){SelectedUsersDelete(a.attr("data-id"),b.find(".addmore input"))}if(a.attr("id")=="friendsdata"){b.find(".uploadinfocheckbox3").removeClass("active")}else{if(a.attr("id")=="followersdata"){b.find(".uploadinfocheckbox4").removeClass("active")}else{if(a.attr("id")=="connectionsdata"){b.find(".uploadinfocheckbox5").removeClass("active")}else{if(a.attr("id")=="sponsorssdata"){b.find(".uploadinfocheckbox6").removeClass("active")}else{if(a.attr("id")=="friends_of_friends_data"){b.find(".uploadinfocheckbox_friends_of_friends").removeClass("active")}}}}}});$(".privacy_select").change(function(){var a=parseInt($(this).val());if(a==USER_PRIVACY_SELECTED){$(this).parent().find(".privacy_picker").removeClass("displaynone")}else{initResetSelectedUsers($(this).parent().find(".addmore input"));$(this).parent().find(".uploadinfocheckbox").removeClass("active");$(this).parent().find(".addmore input").val("");$(this).parent().find(".addmore input").blur();$(this).parent().find(".peoplesdata").each(function(){var b=$(this);b.remove()});$(this).parent().find(".privacy_picker").addClass("displaynone")}initResetIcon($(this).parent().find(".privacy_icon"));$(this).parent().find(".privacy_icon").addClass("privacy_icon"+a)});$(".AccountTitle").click(function(){var a=$(this);var b=a.closest("div.AccountInfo_item");if(b.hasClass("active")){b.find("#privacy_close_button").click();b.removeClass("active");b.find(".privacy-account").hide();b.find(".account_toshow").hide()}else{b.addClass("active");b.find(".privacy-account").show();b.find(".account_toshow").show()}});$(".personalCheckbox").click(function(){var a=$(this);if(a.hasClass("checkboxActive")){a.removeClass("checkboxActive");a.attr("data-value","0")}else{a.addClass("checkboxActive");a.attr("data-value","1")}});$(".learnmore").fancybox({padding:0,width:"1025px",margin:0});$("#confirmaccount").fancybox({padding:0,width:"347px",margin:0,beforeLoad:function(){clearForm()}});$(".btn").click(function(){var a=$(this);$(".btn").parent().parent().css("z-index",1000);a.parent().parent().css("z-index",1260);$(".btn").each(function(){var d=$(this).parent();if($(this).get(0)!=a.get(0)){d.attr("rel","closed");d.animate({width:"20px",height:"20px"},500,function(){d.css({"background-color":"#FFFFFF"})})}});var b=a.parent();var c=b.attr("rel");ChangeTo(c,b)});$(".list li").click(function(){var a=$(this);var b=a.attr("rel");var c=a.closest("div.accountprivacy");var d=c.attr("rel");ChangeTo(d,c);c.attr("value",b)});$("#saveabout").click(function(){var b=$("#website_url").val();var a=$("#small_description").val();$.ajax({url:ReturnLink("/ajax/account_info.php"),data:{website_url:b,small_description:a,flag:"about"},type:"post",success:function(c){var e=null;try{e=$.parseJSON(c)}catch(d){}if(!e){return}if(e.status=="ok"){$("#website_url").val(e.website_url);$("#small_description").val(e.small_description);TTAlert({msg:e.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{TTAlert({msg:e.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})});$("#savepersonal").click(function(){var h=$("input[name=fname]").val();var l=$("input[name=lname]").val();var g=$("input[name=employment]").val();var j=$("input[name=high_education]").val();var m=$("#useUsername").attr("data-value");var n=$("input[name=YourUserName]").val();var k=$("select[name=intrestedin]").val();var f=getObjectData($("#email"));if(!validateEmail(f)){TTAlert({msg:t("Please insert a correct email."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return false}var e=$("input[name=dob]").attr("data-value");var a=$("#display_age").attr("data-value");var d=$("#display_yearage").attr("data-value");var i=$("input[name=gender]:checked").val();var b=$("#display_gender").attr("data-value");var c=$("#display_interest").attr("data-value");$.ajax({url:ReturnLink("/ajax/account_info.php"),data:{fname:h,lname:l,employment:g,high_education:j,useUsername:m,YourUserName:n,intrestedin:k,email:f,dob:e,display_age:a,display_yearage:d,gender:i,display_gender:b,display_interest:c,flag:"personal"},type:"post",success:function(o){var q=null;try{q=$.parseJSON(o)}catch(p){}if(!q){return}if(q.status=="ok"){$("#fname").val(q.fname);$("#lname").val(q.lname);$("#employment").val(q.employment);$("#high_education").val(q.high_education);var r=q.display_fullname;ChangeCheckBox($("#useUsername"),r);$("#YourUserName").val(q.YourUserName);$("#intrestedin").val(q.intrestedin);$("#email").val(q.email);$("#dob").val(q.dob);$("#dob").attr("data-value",q.dob);ChangeCheckBox($("#display_age"),q.display_age);ChangeCheckBox($("#display_yearage"),q.display_yearage);$(".gender").removeAttr("checked");$('.gender[value="'+q.gender+'"]').attr("checked","checked");ChangeCheckBox($("#display_gender"),q.display_gender);ChangeCheckBox($("#display_interest"),q.display_interest);TTAlert({msg:q.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{TTAlert({msg:q.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})});$("#savelocation").click(function(){var d=$("input[name=hometown]").val();var a=$("input[name=city]").val();var b=$("input[name=city]").attr("data-id");var c=$("select[name=country]").val();if(b==""&&a.length>0){TTAlert({msg:t("invalid city name"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}$.ajax({url:ReturnLink("/ajax/account_info.php"),data:{hometown:d,city:a,cityid:b,country:c,flag:"location"},type:"post",success:function(e){var g=null;try{g=$.parseJSON(e)}catch(f){}if(!g){return}if(g.status=="ok"){$("#hometown").val(g.hometown);$("#city").val(g.city);$("#country").val(g.country);TTAlert({msg:g.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{TTAlert({msg:g.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})});$("#CloseAccountBtn").click(function(){if($("#deactivate_account").hasClass("checkboxActive")){theAction="deactivate";$("#confirmaccount").click()}else{var a=$("#stop_emails").attr("data-value");if(a==0){a=1}else{a=0}$.ajax({url:ReturnLink("/ajax/account_unsubscribe.php"),data:{stopemail:a},type:"post",success:function(b){var d=null;try{d=$.parseJSON(b)}catch(c){return}if(!d){TTAlert({msg:t("Couldnt save please try again later"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}TTAlert({msg:d.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}})}});$(document).on("click","#sendReport",function(){if($(".deleteTellOpt").hasClass("checkboxActive")){var b=$("#reportdesc").val();if($("#deleteTellContainer .deleteTellOpt:last").hasClass("checkboxActive")&&b==""){TTAlert({msg:t("Please write your Report"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}var a=SOCIAL_ENTITY_PROFILE_ACCOUNT;var d=new Array();$(".deleteTellOpt.checkboxActive").each(function(){var e=$(this);d.push(e.attr("data-id"))});var c=d.join(",");TTCallAPI({what:"user/report/add",data:{entity_type:a,entity_id:report_entity_id,msg:b,reason:c},callback:function(e){$(".upload-overlay-loading-fix").hide();if(e.status==="error"){TTAlert({msg:e.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}TTAlert({msg:e.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});$("#deleteTellContainer").hide();$("#tellWhy").hide();$("#confirmDelete,#confirmDeleteBtns").show()}})}else{TTAlert({msg:t("Please choose one of the above proposed options to Report"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}});$(document).on("click","#confirmDeleteBtns .accountbut2",function(){if($("#confirmDelete").attr("data-value")==="0"){TTAlert({msg:t("Please check to confirm your action."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}else{TTAlert({msg:t("Are you sure you want to delete your account? This action cannot be undone."),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(a){if(a){theAction="delete";$("#confirmaccount").click()}}})}});$(document).on("click","#confirmDeleteBtns .accountbut1",function(){$("#tellWhy").show();$("#confirmDelete,#confirmDeleteBtns").hide()});$("#AccountMgmtSave").click(function(){var e=$("input[name=uname]").val();var b=$("input[name=new_pass]").val();var c=$("input[name=new_pass2]").val();var d=$("input[name=old_pass]").val();$("input[name=uname]").removeClass("InputErr");$("input[name=old_pass]").removeClass("InputErr");$("input[name=new_pass]").removeClass("InputErr");$("input[name=new_pass2]").removeClass("InputErr");var a=5;if(d.length==0){TTAlert({msg:t("Please specify old password"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});$("input[name=old_pass]").addClass("InputErr");return}else{if((b.length<a)){TTAlert({msg:sprintf(t("Password must be minimum %s characters long"),[a]),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});$("input[name=new_pass]").addClass("InputErr");return}else{if((b!=c)){TTAlert({msg:t("passwords mismatch"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});$("input[name=new_pass]").addClass("InputErr");$("input[name=new_pass2]").addClass("InputErr");return}}}$(this).attr("disabled","disabled");$.ajax({url:ReturnLink("/ajax/account_manage.php"),data:{uname:e,new_pass:b,old_pass:d},type:"post",success:function(f){$("#AccountMgmtSave").removeAttr("disabled");$("body").css("cursor","");var h=null;try{h=$.parseJSON(f)}catch(g){return}if(!h){TTAlert({msg:t("Couldnt save please try again later"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(h.status=="ok"){$("#WelcomeUserName").html(e);TTAlert({msg:t("Information saved!"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{if(h.error_no==0){$("input[name=uname]").addClass("InputErr")}else{if(h.error_no==1){$("input[name=old_pass]").addClass("InputErr")}else{if(h.error_no==2){$("input[name=new_pass]").addClass("InputErr")}}}TTAlert({msg:h.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}if((h.status=="ok")||((h.status!="ok")&&(h.error_no!=0))){$("#WelcomeUserName a").html($("input[name=uname]").val())}}})});$(document).on("click","#signInbtn_settings",function(){var c=getObjectData($("#SEmailField"));var d=getObjectData($("#SPasswordField"));var a=theAction;$("#SPasswordField, #SEmailField").removeClass("InputErr");if(c.length==0||!(c.match(/([\<])([^\>]{1,})*([\>])/i)==null)){$("#SEmailField").focus().addClass("InputErr");return false}else{if(d.length==0||!(d.match(/([\<])([^\>]{1,})*([\>])/i)==null)){$("#SPasswordField").focus().addClass("InputErr");return false}else{$(".upload-overlay-loading-fix").show();var b="EmailField="+c+"&PasswordField="+d+"&action="+a;$.ajax({type:"POST",url:ReturnLink("/ajax/account_check_user.php"),data:b,success:function(f){var g=null;try{g=$.parseJSON(f)}catch(e){$(".upload-overlay-loading-fix").hide();return}$.fancybox.close();if(!g){$(".upload-overlay-loading-fix").hide();TTAlert({msg:t("invalid username or password, please try again"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(g.status=="ok"){document.location.href=ReturnLink("/logout")}else{$(".upload-overlay-loading-fix").hide();TTAlert({msg:g.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})}}});$(document).on("click",".signInbtn1",function(){closeFancyBox()});$("#SendInviteBtn").click(function(){var d=false;$("input[name=remail]").removeClass("InputErr");if(!emailIsValid($("input[name=remail]").val())||$("input[name=remail]").val()==""){$("input[name=remail]").addClass("InputErr");TTAlert({msg:t("Please specify a valid email address"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(d){return}var e=$("input[name=rname]").val();var c=$("input[name=remail]").val();var b=$("input[name=rname]").attr("data-value");var a=$("input[name=remail]").attr("data-value");$("#SendInviteBtn").attr("disabled","disabled");$.ajax({url:ReturnLink("/ajax/account_invite.php"),data:{name:e,email:c},type:"post",success:function(f){$("#SendInviteBtn").removeAttr("disabled");$("body").css("cursor","");var i=null;try{i=$.parseJSON(f)}catch(g){return}if(!i){TTAlert({msg:t("Couldnt perform operation. please try again later"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(i.status=="ok"){TTAlert({msg:i.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});var h=parseInt($("#SentInvites").text());$("#SentInvites").html(h+1);$(".invited").prepend(i.li);if(i.last=="1"){$("#e2 .AccountOrder").html("1");$(".AccountInfo_item:first").hide()}$("input[name=rname]").val(b);$("input[name=remail]").val(a)}else{TTAlert({msg:i.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})});$(document).on("click","#privacy_picker .uploadinfocheckbox",function(){if($(this).hasClass("active")){$(this).removeClass("active");if($(this).hasClass("uploadinfocheckbox3")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#friendsdata").remove()}}else{if($(this).hasClass("uploadinfocheckbox_friends_of_friends")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#friends_of_friends_data").remove()}}else{if($(this).hasClass("uploadinfocheckbox4")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#followersdata").remove()}}}}}else{if($(this).hasClass("uploadinfocheckbox3")){if($(this).parent().hasClass("friendscontainer")){var b='<div class="peoplesdata formttl13" id="friendsdata" data-email="" data-id=""><div class="peoplesdatainside">'+t("friends")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(b)}}else{if($(this).hasClass("uploadinfocheckbox_friends_of_friends")){if($(this).parent().hasClass("friendscontainer")){var a='<div class="peoplesdata formttl13" id="friends_of_friends_data" data-email="" data-id=""><div class="peoplesdatainside">'+t("friends of friends")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(a)}}else{if($(this).hasClass("uploadinfocheckbox4")){if($(this).parent().hasClass("friendscontainer")){var a='<div class="peoplesdata formttl13" id="followersdata" data-email="" data-id=""><div class="peoplesdatainside">'+t("followers")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(a)}}}}$(this).addClass("active")}})});function initResetIcon(a){a.removeClass("privacy_icon1");a.removeClass("privacy_icon2");a.removeClass("privacy_icon3");a.removeClass("privacy_icon4");a.removeClass("privacy_icon5");a.removeClass("privacy_icon6")}function updateImage(c,b,a){if(a=="account_pic"){document.location.reload()}closeFancyBox()}function initResetSelectedUsers(a){resetSelectedUsers(a)}function initPrivacyBox(b,a){var c=parseInt(b.find("#privacy_select").val());b.find("#privacy_select").change();if(c==USER_PRIVACY_SELECTED){b.show();b.find(".peoplecontainer .emailcontainer .peoplesdata").each(function(){var d=$(this);if(d.attr("id")=="friendsdata"){}else{if(d.attr("id")=="friends_of_friends_data"){}else{if(d.attr("id")=="followersdata"){}else{if(parseInt(d.attr("data-id"))!=0){if(b.hasClass("privacy_box0")){SelectedUsersAdd(d.attr("data-id"),$("#addmoretext_zero"))}else{if(b.hasClass("privacy_box1")){SelectedUsersAdd(d.attr("data-id"),$("#addmoretext_first"))}else{if(b.hasClass("privacy_box2")){SelectedUsersAdd(d.attr("data-id"),$("#addmoretext_second"))}else{if(b.hasClass("privacy_box3")){SelectedUsersAdd(d.attr("data-id"),$("#addmoretext_third"))}else{if(b.hasClass("privacy_box4")){SelectedUsersAdd(d.attr("data-id"),$("#addmoretext_forth"))}else{SelectedUsersAdd(d.attr("data-id"),$("#addmoretext_fifth"))}}}}}}}}}});if(!a){b.hide()}}}function InitCalendar(){Calendar.setup({inputField:"dob",noScroll:true,trigger:"dob",align:"B",onSelect:function(a){var b=Calendar.intToDate(a.selection.get());var c=Calendar.printDate(b,"%Y-%m-%d");$("#dob").attr("data-value",c);$("#dob").val(c);this.hide()},dateFormat:"%Y-%m-%d"})}function initPersonalInfo(){$(".privacy-account").mouseover(function(){var a=$("#AccountInfo").offset().left+255;var b=$("#AccountInfo").offset().top+22;var c=$(this).offset().left-a;var d=$(this).offset().top-b;$(".privacybuttonsOver .ProfileHeaderOverin").html($(this).attr("data-title"));$(".privacybuttonsOver").css("left",c+"px");$(".privacybuttonsOver").css("top",d+"px");$(".privacybuttonsOver").stop().show()});$(".privacy-account").mouseout(function(){$(".privacybuttonsOver").hide()});InitCalendar();$(".privacy_down_arrow").click(function(){var a=$(this);var b=a.closest("div.AccountInfo_item");if(!b.hasClass("active")){b.find(".AccountTitle").click()}b.find("#privacy_box").show()});$(".privacy_close_button").click(function(){var a=$(this);var b=a.closest("div.AccountInfo_item");b.find("#privacy_box").hide()});$(document).on("click",".private_save_buts",function(){var a=$(this).parent();var c=a.closest("div.AccountInfo_item");var e=parseInt(a.find("#privacy_select").val());var d=new Array();if(e==USER_PRIVACY_SELECTED){a.find(".peoplecontainer .emailcontainer .peoplesdata").each(function(){var f=$(this);if(f.attr("id")=="friendsdata"){d.push({friends:1})}else{if(f.attr("id")=="friends_of_friends_data"){d.push({friends_of_friends:1})}else{if(f.attr("id")=="followersdata"){d.push({followers:1})}else{if(parseInt(f.attr("data-id"))!=0){d.push({id:f.attr("data-id")})}}}}})}if((e==USER_PRIVACY_SELECTED&&d.length>0)||e!=USER_PRIVACY_SELECTED){var b=a.attr("data-type");TTCallAPI({what:"user/privacy_extand/add",data:{privacyValue:e,privacyArray:d,entity_type:b,entity_id:0},callback:function(g){if(g.status==="error"){TTAlert({msg:g.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}var f=c.find(".privacy-account");f.attr("class","privacy-account privacy_icon"+a.find("#privacy_select").val());f.attr("data-title",a.find("#privacy_select option:selected").text());a.find("#privacy_close_button").click()}})}else{TTAlert({msg:t("Invalid privacy data"),type:"alert",btn1:t("ok")})}});addmoreusersautocomplete_custom_journal($("#addmoretext_first"));initResetSelectedUsers($("#addmoretext_first"));addmoreusersautocomplete_custom_journal($("#addmoretext_second"));initResetSelectedUsers($("#addmoretext_second"));addmoreusersautocomplete_custom_journal($("#addmoretext_third"));initResetSelectedUsers($("#addmoretext_third"));initPrivacyBox($(".privacy_box1"),false);initPrivacyBox($(".privacy_box2"),false);initPrivacyBox($(".privacy_box3"),false)}function addAutoCompleteList(b){var a=$("input[name=city]",$("#"+b));a.autocomplete({appendTo:"#"+b,search:function(e,f){var c=$("#country");var d=c.val();if(d=="ZZ"){c.addClass("err");e.preventDefault()}else{a.autocomplete("option","source",ReturnLink("/ajax/uploadGetCities.php?cc="+d))}},select:function(c,d){a.val(d.item.value);a.attr("data-id",d.item.id);c.preventDefault()}})}function undoTTNotificationsData(d,a){$(".upload-overlay-loading-fix").show();var c=d.attr("data-id");var b=parseInt(d.attr("data-channel"));$.ajax({url:ReturnLink("/ajax/info_newsfeed_update.php"),data:{id:c,action:a,ischannel:b},type:"post",success:function(e){$(".upload-overlay-loading-fix").hide();if(e){if(a=="unhide"||a=="unhide_all"){d.closest(".list_notifications_item").remove()}}}})}function initAccountNotification(){$(document).on("click",".list_item_undo",function(){var b=$(this);var a="unhide";undoTTNotificationsData(b,a)});$(document).on("click",".account-btn-save",function(){var a=$(this).closest(".formContainer");var e=new Array();var c=new Array();var g=new Array();e.push(parseInt(a.find("#select1").val()));c.push(a.find("#select1").attr("data-value"));g.push(parseInt(a.find("#select1").attr("data-type")));e.push(parseInt(a.find("#select2").val()));c.push(a.find("#select2").attr("data-value"));g.push(parseInt(a.find("#select2").attr("data-type")));a.find(".uploadinfocheckbox").each(function(){var i=$(this);c.push(i.attr("data-value"));g.push(parseInt(i.attr("data-type")));if(i.hasClass("active")){e.push(1)}else{e.push(0)}});var f=e.join("/*/");var d=c.join("/*/");var h=g.join("/*/");var b=""+$("#emailnotifications1").val();updateTuberOtherEmail(b);updateNotificationsForm(f,d,h,false)})}function updateNotificationsForm(b,c,d,a){$(".upload-overlay-loading-fix").show();$.ajax({url:ReturnLink("/ajax/info_notification_manage.php"),data:{value:b,data:c,type:d},type:"post",success:function(e){$(".upload-overlay-loading-fix").hide();var g=null;try{g=$.parseJSON(e)}catch(f){return}if(!g){TTAlert({msg:t("couldnt save please try again later"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(a){if(g.status=="ok"){TTAlert({msg:t("information saved!"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{TTAlert({msg:g.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}}})}function updateTuberOtherEmail(a){$.ajax({url:ReturnLink("/ajax/info_notification_otheremail.php"),data:{data:a},type:"post",success:function(b){var d=null;try{d=$.parseJSON(b)}catch(c){return}if(!d){TTAlert({msg:t("couldnt save please try again later"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(d.status=="ok"){TTAlert({msg:t("information saved!"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{TTAlert({msg:d.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})}function initAccountPrivacy(){$(document).on("click",".show_item_undo",function(){var b=$(this);var a="unhide_all";undoTTNotificationsData(b,a)});$(document).on("click","#AccountStanDiv3 .uploadinfocheckbox",function(){var a=$(this);if(a.hasClass("active")){a.removeClass("active")}else{a.addClass("active")}});$("#search_tuber").autocomplete({delay:5,appendTo:"#contact_privacy_container",search:function(b,d){var c="u";var a="&t="+c;$("#search_tuber").autocomplete("option","source",ReturnLink("/ajax/media-autocomplete.php")+a)},focus:function(a,b){return false},select:function(a,c){var d=c.item.id;var b=c.item.value_display;$("#search_tuber").val(b);$("#search_tuber").attr("data-id",d);$("#search_tuber").attr("data-us",b);a.preventDefault()}}).data("ui-autocomplete")._renderItem=function(b,a){return $("<li></li>").data("item.autocomplete",a).append("<a>"+a.label+"</a>").appendTo(b)};$("#profile_block_user").click(function(){var b=$("#search_tuber").attr("data-id");var a=getObjectData($("#search_tuber"));if(a!=""&&parseInt(b)>0&&$("#search_tuber").attr("data-us")==a){userBlockTuber($("#search_tuber"))}else{$("#search_tuber").attr("data-id","");$("#search_tuber").attr("data-us","");TTAlert({msg:t("invalid user"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}});$("#ContactSave").click(function(){$(this).attr("disabled","disabled");savePrivacyObjects($(".privacy_box5"));var a=$("input[name=contact_privacy]:checked").val();var b=$("input[name=search_engine]:checked").val();$.ajax({url:ReturnLink("/ajax/account_privacy.php"),data:{contact_privacy:a,search_engine:b,flag:"contact"},type:"post",success:function(c){$("#ContactSave").removeAttr("disabled");$("body").css("cursor","");var e=null;try{e=$.parseJSON(c)}catch(d){return}if(!e){TTAlert({msg:t("couldnt save please try again later"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(e.status=="ok"){TTAlert({msg:t("information saved!"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{TTAlert({msg:e.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})});$(document).on("click","#privacySave",function(){savePrivacyObjects($(".privacy_box0"));savePrivacyObjects($(".privacy_box1"));savePrivacyObjects($(".privacy_box2"));savePrivacyObjects($(".privacy_box3"));savePrivacyObjects($(".privacy_box4"));var a=$(this).closest("#ContentPrivacy").find("#AccountStanDiv3");var d=new Array();var b=new Array();var f=new Array();a.find(".uploadinfocheckbox").each(function(){var h=$(this);b.push(h.attr("data-value"));f.push(parseInt(h.attr("data-type")));if(h.hasClass("active")){d.push(1)}else{d.push(0)}});var e=d.join("/*/");var c=b.join("/*/");var g=f.join("/*/");updateNotificationsForm(e,c,g,true)});addmoreusersautocomplete_custom_journal($("#addmoretext_zero"));initResetSelectedUsers($("#addmoretext_zero"));addmoreusersautocomplete_custom_journal($("#addmoretext_first"));initResetSelectedUsers($("#addmoretext_first"));addmoreusersautocomplete_custom_journal($("#addmoretext_second"));initResetSelectedUsers($("#addmoretext_second"));addmoreusersautocomplete_custom_journal($("#addmoretext_third"));initResetSelectedUsers($("#addmoretext_third"));addmoreusersautocomplete_custom_journal($("#addmoretext_forth"));initResetSelectedUsers($("#addmoretext_forth"));addmoreusersautocomplete_custom_journal($("#addmoretext_fifth"));initResetSelectedUsers($("#addmoretext_fifth"));$(".AccountStanDiv2").parent().show();initPrivacyBox($(".privacy_box0"),true);initPrivacyBox($(".privacy_box1"),true);initPrivacyBox($(".privacy_box2"),true);initPrivacyBox($(".privacy_box3"),true);initPrivacyBox($(".privacy_box4"),true);initPrivacyBox($(".privacy_box5"),true);$(".AccountStanDiv2").parent().hide()}function savePrivacyObjects(b){var d=parseInt(b.find("#privacy_select").val());var c=new Array();if(d==USER_PRIVACY_SELECTED){b.find(".peoplecontainer .emailcontainer .peoplesdata").each(function(){var e=$(this);if(e.attr("id")=="friendsdata"){c.push({friends:1})}else{if(e.attr("id")=="friends_of_friends_data"){c.push({friends_of_friends:1})}else{if(e.attr("id")=="followersdata"){c.push({followers:1})}else{if(parseInt(e.attr("data-id"))!=0){c.push({id:e.attr("data-id")})}}}}})}if((d==USER_PRIVACY_SELECTED&&c.length>0)||d!=USER_PRIVACY_SELECTED){var a=b.attr("data-type");TTCallAPI({what:"user/privacy_extand/add",data:{privacyValue:d,privacyArray:c,entity_type:a,entity_id:0},callback:function(e){}})}}function userBlockTuber(a){$(".chat-overlay-loading-fix").show();$.ajax({url:ReturnLink("/ajax/profile_friend.php"),data:{fid:a.attr("data-id"),op:"block_frnd"},type:"post",success:function(b){$(".chat-overlay-loading-fix").hide();var d=null;try{d=$.parseJSON(b)}catch(c){$(".chat-overlay-loading-fix").hide();return}if(!d){$(".chat-overlay-loading-fix").hide();TTAlert({msg:t("Couldn't process. please try again later"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(d.status=="ok"){a.attr("data-id","");a.val("");a.blur()}else{TTAlert({msg:d.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}$(".chat-overlay-loading-fix").hide()}})}function checkSubmitInvite(a){if(a&&a.keyCode==13){$("#SendInviteBtn").click()}};