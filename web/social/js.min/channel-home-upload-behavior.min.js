var uploaderHome=null;var requirements_met=true;var upload_started;function InitChannelUploaderHome(g,c,f,b){var e="Image files";var d="jpg,gif,png,tiff,tif,bmp,jpeg";if(g=="videos_posts"||g=="TT_videos_posts"){e="Video files";d="wmv,mov,flv,mp4,avi,mts,m4v"}if(g=="postMediaPV"||g=="CHpostMediaPV"){e="Video or Image files";d="jpg,gif,png,tiff,tif,bmp,jpeg,wmv,mov,flv,mp4,avi,mts,m4v"}if(b==1){uploaderHome=new plupload.Uploader({runtimes:"html5,flash",button_browse_hover:true,max_file_size:f+"mb",container:c,browse_button:g,drop_element:g,url:ReturnLink("/channel-upload-file.php"),flash_swf_url:ReturnLink("/js/plupload/plupload.flash.swf"),multi_selection:false,multipart_params:{channel_id:channelGlobalID(),user_id:userGlobalID(),discover_nam:userGlobalDISName(),which_uploader:g,SID:$("#SID").val()},filters:[{title:e,extensions:d},],init:a})}else{uploaderHome=new plupload.Uploader({runtimes:"html5,flash",button_browse_hover:true,max_file_size:f+"mb",container:c,browse_button:g,url:ReturnLink("/channel-upload-file.php"),flash_swf_url:ReturnLink("/js/plupload/plupload.flash.swf"),multi_selection:false,multipart_params:{channel_id:channelGlobalID(),user_id:userGlobalID(),discover_nam:userGlobalDISName(),which_uploader:g,SID:$("#SID").val()},filters:[{title:e,extensions:d},],init:a})}uploaderHome.bind("Init",function(i,h){if((h.runtime=="flash")&&!swfobject.hasFlashPlayerVersion("10")){requirements_met=false;if(g!="uploadBtnbrochure"&&g!="uploadBtnevent"){TTAlert({msg:t("Please update your flash installation to at least version 10"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{$("#brochureerror").html(t("Please update your flash installation to at least version 10"))}}});uploaderHome.init();function a(h){h.bind("FilesAdded",function(j,i){j.settings.multipart_params={channel_id:channelGlobalID(),user_id:userGlobalID(),discover_nam:userGlobalDISName(),which_uploader:g,SID:$("#SID").val()};if(!requirements_met){if(g!="uploadBtnbrochure"&&g!="uploadBtnevent"){TTAlert({msg:t("Please update your flash installation to at least version 10"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{$("#brochureerror").html(t("Please update your flash installation to at least version 10"))}return false}setTimeout(function(){h.start()},100);$.each(i,function(m,l){var k=l.id;if(g=="photos_posts"||g=="photos_posts"||g=="videos_posts"||g=="uploadReview_Img"||g=="TT_photos_posts"||g=="flashPhoto"||g=="TT_videos_posts"||g=="postMediaPV"||g=="CHpostMediaPV"||g=="TT_uploadBtnevent"){$(".upload-overlay-loading-fix-file").show()}else{if(g=="editChannelRight_data6"){$(".upload-overlay-loading-fix").show()}}})});h.bind("UploadFile",function(k,j){var i=j.id;upload_started=1;if(g=="photos_posts"||g=="videos_posts"||g=="TT_photos_posts"||g=="uploadReview_Img"||g=="flashPhoto"||g=="TT_videos_posts"||g=="postMediaPV"||g=="CHpostMediaPV"||g=="TT_uploadBtnevent"){$(".upload-overlay-loading-fix-file").show()}else{if(g=="editChannelRight_data6"){$(".upload-overlay-loading-fix").show()}}});h.bind("UploadProgress",function(k,j){var i=j.id;if(g=="photos_posts"||g=="videos_posts"||g=="TT_photos_posts"||g=="uploadReview_Img"||g=="flashPhoto"||g=="TT_videos_posts"||g=="postMediaPV"||g=="CHpostMediaPV"||g=="TT_uploadBtnevent"){$(".upload-overlay-loading-fix-file span").html(j.percent+"%")}else{if(pagename=="event"||pagename=="channel-add-brochure"){$(".upload-overlay-loading-fix").show()}}});h.bind("Error",function(j,i){if(g=="photos_posts"||g=="videos_posts"||g=="TT_photos_posts"||g=="uploadReview_Img"||g=="flashPhoto"||g=="TT_videos_posts"||g=="postMediaPV"||g=="CHpostMediaPV"||g=="TT_uploadBtnevent"){$(".upload-overlay-loading-fix-file").hide()}else{if(pagename=="event"||pagename=="channel-add-brochure"){$(".upload-overlay-loading-fix").hide()}else{if(g=="editChannelRight_data6"){$(".upload-overlay-loading-fix").hide()}}}if(g!="uploadBtnbrochure"&&g!="uploadBtnevent"){if(i.code==-600){TTAlert({msg:i.message+"<br/>maximum size: "+f+"mb",type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{if(i.file&&i.file.name){TTAlert({msg:t("Error: ")+i.file.name+" "+i.message,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{TTAlert({msg:t("Error: ")+i.message,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}}else{if(i.code==-600){$("#brochureerror").html(i.message+"<br/>maximum size: "+f+"mb")}else{if(i.file&&i.file.name){$("#brochureerror").html(t("Error: ")+i.file.name+" "+i.message)}else{$("#brochureerror").html(t("Error: ")+i.message)}}}h.refresh()});h.bind("FileUploaded",function(p,k,o){if(g=="photos_posts"||g=="videos_posts"||g=="TT_photos_posts"||g=="uploadReview_Img"||g=="flashPhoto"||g=="TT_videos_posts"||g=="postMediaPV"||g=="CHpostMediaPV"||g=="TT_uploadBtnevent"){$(".upload-overlay-loading-fix-file").hide()}else{if(pagename=="event"||pagename=="channel-add-brochure"){$(".upload-overlay-loading-fix").hide()}else{if(g=="editChannelRight_data6"){$(".upload-overlay-loading-fix").hide()}}}upload_started=0;var j=k.id;var l;try{l=$.parseJSON(o.response)}catch(i){return}if(l.status!=="ok"){if(g!="uploadBtnbrochure"&&g!="uploadBtnevent"){TTAlert({msg:l.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{$("#brochureerror").html(l.error)}}else{$("#picfancyboxbutton").fancybox({width:l.stanwidth,height:l.stanheight+30,transitionIn:"none",transitionOut:"none",autoSize:true,type:"iframe",padding:0,margin:0,helpers:{overlay:{closeClick:false}}});if(l.which_uploader=="videos_posts"||l.which_uploader=="TT_videos_posts"||(l.is_video==1&&(l.which_uploader=="postMediaPV"||l.which_uploader=="CHpostMediaPV"))){$("#picfancyboxbutton").fancybox({padding:0,margin:0,width:375,height:146,transitionIn:"none",transitionOut:"none",autoSize:true,type:"iframe",helpers:{overlay:{closeClick:false}}});$("#picfancyboxbutton").attr("href",ReturnLink("/ajax/showthumb_post.php?path="+l.path+"&code="+l.code+"&name="+l.name+"&type="+l.which_uploader));$("#picfancyboxbutton").click()}else{if(l.which_uploader=="postMediaPV"||l.which_uploader=="CHpostMediaPV"){var n=ReturnLink(l.path+"thumb/"+l.name);var m='<img src="'+n+"?x="+Math.random()+'" width="86" height="48"/>';parent.window.updateImagePOST(m,l.name,l.path,l.which_uploader,0)}else{$("#picfancyboxbutton").fancybox({padding:0,margin:0,width:l.stanwidth,height:l.stanheight+30,transitionIn:"none",transitionOut:"none",autoSize:true,type:"iframe",helpers:{overlay:{closeClick:false}}});if(l.which_uploader=="uploadReview_Img"){$("#picfancyboxbutton").attr("href",ReturnLink("/ajax/channel-fancy.php?path="+l.path+"&code="+l.code+"&name="+l.name+"&type="+l.which_uploader+"&h="+l.stanheight+"&discover_nam="+l.discover_nam))}else{$("#picfancyboxbutton").attr("href",ReturnLink("/ajax/channel-fancy.php?path="+l.path+"&code="+l.code+"&name="+l.name+"&type="+l.which_uploader+"&h="+l.stanheight))}$("#picfancyboxbutton").click()}}}})}};