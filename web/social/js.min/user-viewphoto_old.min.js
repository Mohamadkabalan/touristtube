var privacyValue=-1;var privacyArray=new Array();var $modal_image=null;var $modal_content_container=null;$(document).ready(function(b){$modal_content_container=$("#imgInside").parent();$modal_image=$("#imgInside");$(".exportVideo").on("click",function(){if(checkArray(SelectionArray)!=0){$(".save-thumb").hide();$(".delThumbs").hide();$(".save-thumb-separator").hide();$(".save-thumb-message").show();$.post(ReturnLink("/ajax/ajax_edit_video.php"),{frames:SelectionArray,allf:AllFrames,id:$(".all_container").attr("data-id")},function(d){SelectionArray=[];parent.window.closeFancyExportVideo($(".all_container").attr("data-export"))})}});$(document).on("click",".imageitem",function(){$this=$(this).find(".thumb-pic-img");var e=$this.attr("rel");var d=e-1;if(!$this.hasClass("selected")){$(this).find(".yellowborder").addClass("active");$this.addClass("selected");if(jQuery.inArray(e,SelectionArray)==-1){SelectionArray[d]=e}$(".delThumbs").addClass("active")}else{$(this).find(".yellowborder").removeClass("active");$this.removeClass("selected");SelectionArray[d]="";var f=true;$(".yellowborder.active").each(function(){if($(this).closest(".imageitem").css("display")!="none"){f=false}});if(f){$(".delThumbs").removeClass("active")}else{$(".delThumbs").addClass("active")}}});$(".delThumbs").on("click",function(){DeletedArray=[];$(".imageitem .thumb-pic-img").each(function(){var d=$(this).attr("rel");if(jQuery.inArray(d,SelectionArray)!=-1){$(this).parent().css("display","none");DeletedArray.push(d)}});if(DeletedArray.length!=0){$(".undoThumbs").css("display","block")}$(".delThumbs").removeClass("active")});$(".undoThumbs").on("click",function(){SelectionArray=[];$(".imageitem .thumb-pic-img").each(function(){var d=$(this).attr("rel");if(jQuery.inArray(d,DeletedArray)!=-1){$(this).parent().css("display","block");$(this).next().removeClass("active")}});$(".imageitem .thumb-pic-img").removeClass("selected")});$(".edit_input").blur();addAutoCompleteList();if(parseInt(channelid)==0){addmoreusersautocomplete_custom_journal($("#addmoretext_custum_privacy_detailed"))}$(document).on("click",".top_arrow",function(){$(".hidden_buttons").toggle()});$(document).on("click",".overdatabutenable",function(){var d=$(this);var e=$(".all_container").attr("data-id");var f=$(".all_container").attr("data-type");if(String(""+d.attr("data-status"))=="1"){enableSharesComments_log(e,f,0);d.attr("data-status","0");d.find(".overdatabutntficon").addClass("inactive")}else{enableSharesComments_log(e,f,1);d.attr("data-status","1");d.find(".overdatabutntficon").removeClass("inactive")}});$(document).on("click","#canceleventdata",function(){$(".error_valid_privacy").html("");parent.window.closeFancy()});$(document).on("click","#add_but",function(){parent.window.addMediaUpload($(".all_container").attr("data-upuri"))});$(document).on("click","#remove_button",function(){parent.window.addMediaRemove($(".all_container").attr("data-link"))});$(document).on("click","#cancel_custom_privacy",function(){$(".error_valid_privacy").html("");$(".peoplecontainer_custom").addClass("displaynone");$(".info_pop_container").show()});$(document).on("click","#saveeventdata_edit",function(){var f="right_container";if(verifyFormList(f)){var e=$(this).closest("#right_container");if(parseInt(channelid)==0){privacyValue=parseInt($(".privacyclass.active").attr("data-value"))}else{privacyValue=USER_PRIVACY_PUBLIC}if((privacyValue==USER_PRIVACY_SELECTED&&privacyArray.length==0)){$(".error_valid").html(t("Invalid privacy data"));return}var d=$(this);$.post(ReturnLink("/ajax/profile_media_save.php"),{privacyValue:privacyValue,privacyArray:privacyArray,vid:$(".all_container").attr("data-id"),title:getObjectData($("#edit_title")),cityname:$("#edit_cityname").val(),cityid:$("#edit_cityname").attr("data-id"),citynameaccent:$("#edit_citynameaccent").val(),is_public:$(".privacyclass.active").attr("data-value"),description:getObjectData($("#edit_description")),category:$("#edit_category").val(),placetakenat:getObjectData($("#edit_placetakenat")),keywords:getObjectData($("#edit_keywords")),country:$("#edit_country").val(),location:""},function(g){if(g!=false){parent.window.closeFancyReload(is_album)}})}});$(document).on("click","#photo_but",function(){if(!$(this).hasClass("active")){$(this).addClass("active");$("#info_but").removeClass("active");$("#edit_info_part").hide();$("#edit_photo_part").show()}});$(document).on("click","#info_but",function(){if(!$(this).hasClass("active")){$(this).addClass("active");$("#photo_but").removeClass("active");$("#edit_info_part").show();$("#edit_photo_part").hide()}});$(document).on("click","#save_photo_edit",function(){var d=$("#imgPhoto").css("left");var e=$("#imgPhoto").css("top");d=parseInt(d.substring(0,d.length-2));e=parseInt(e.substring(0,e.length-2));d=parseInt(d*$("#imgPhoto").data("ow")/$("#imgPhoto").width());e=parseInt(e*$("#imgPhoto").data("oh")/$("#imgPhoto").height());ImageEditor.processImage("action=save&x="+Math.abs(d)+"&y="+Math.abs(e));setTimeout(function(){parent.window.closeFancyReload(is_album)},1000)});$(document).on("click","#okeventdata",function(){var d=$(this).parent().parent();$(".error_valid_privacy").html("");privacyValue=parseInt($(".privacyclass.active").attr("data-value"));privacyArray=new Array();if(privacyValue==USER_PRIVACY_SELECTED){d.find(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var e=$(this);if(e.attr("id")=="friendsdata"){privacyArray.push({friends:1})}else{if(e.attr("id")=="friends_of_friends_data"){privacyArray.push({friends_of_friends:1})}else{if(e.attr("id")=="followersdata"){privacyArray.push({followers:1})}else{if(parseInt(e.attr("data-id"))!=0){privacyArray.push({id:e.attr("data-id")})}}}}})}if((privacyValue==USER_PRIVACY_SELECTED&&privacyArray.length>0)||privacyValue!=USER_PRIVACY_SELECTED){$(".peoplecontainer_custom").addClass("displaynone");$(".info_pop_container").show()}else{$(".error_valid_privacy").html(t("Invalid privacy data"))}});$(document).on("click",".privacyclass",function(){$(".privacyclass",$(this).parent().parent()).removeClass("active");$(this).addClass("active");var e=parseInt($(this).attr("data-value"));var d=$("#right_container");$(".uploadinfomandatory span",d).html("");switch(e){case USER_PRIVACY_PRIVATE:initResetSelectedUsers($(this).closest(".tableform").find(".peoplecontainer_custom"));$(".peoplecontainer_custom").addClass("displaynone");$(".info_pop_container").show();$(".uploadinfomandatory",d).addClass("inactive");$(".uploadinfomandatorytitle",d).removeClass("inactive");break;case USER_PRIVACY_SELECTED:$(this).closest(".tableform").find(".peoplecontainer_custom").show();$(".peoplecontainer_custom").removeClass("displaynone");$(".info_pop_container").hide();$(".uploadinfomandatory",d).addClass("inactive");$(".uploadinfomandatorytitle",d).removeClass("inactive");$(".uploadinfomandatorycategory",d).removeClass("inactive");$(".uploadinfomandatorycountry",d).removeClass("inactive");$(".uploadinfomandatorycitynameaccent",d).removeClass("inactive");break;default:initResetSelectedUsers($(this).closest(".tableform").find(".peoplecontainer_custom"));$(".peoplecontainer_custom").addClass("displaynone");$(".info_pop_container").show();$(".uploadinfomandatory",d).addClass("inactive");$(".uploadinfomandatorytitle",d).removeClass("inactive");$(".uploadinfomandatorycategory",d).removeClass("inactive");$(".uploadinfomandatorycountry",d).removeClass("inactive");$(".uploadinfomandatorycitynameaccent",d).removeClass("inactive");break}});$(document).on("click",".peoplesdataclose",function(){var d=$(this).parent();var e=d.parent().parent();d.remove();if(d.attr("data-id")!=""){SelectedUsersDelete(d.attr("data-id"),e.find(".addmore input"))}if(d.attr("id")=="friendsdata"){e.find(".uploadinfocheckbox3").removeClass("active")}else{if(d.attr("id")=="friends_of_friends_data"){e.find(".uploadinfocheckbox_friends_of_friends").removeClass("active")}else{if(d.attr("id")=="followersdata"){e.find(".uploadinfocheckbox4").removeClass("active")}}}});$(document).on("click",".uploadinfocheckbox",function(){if($(this).hasClass("active")){$(this).removeClass("active");if($(this).hasClass("uploadinfocheckbox3")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#friendsdata").remove()}}else{if($(this).hasClass("uploadinfocheckbox_friends_of_friends")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#friends_of_friends_data").remove()}}else{if($(this).hasClass("uploadinfocheckbox4")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#followersdata").remove()}}}}}else{if($(this).hasClass("uploadinfocheckbox3")){if($(this).parent().hasClass("friendscontainer")){var e='<div class="peoplesdata formttl13" id="friendsdata" data-email="" data-id=""><div class="peoplesdatainside">'+t("friends")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(e)}}else{if($(this).hasClass("uploadinfocheckbox_friends_of_friends")){if($(this).parent().hasClass("friendscontainer")){var d='<div class="peoplesdata formttl13" id="friends_of_friends_data" data-email="" data-id=""><div class="peoplesdatainside">'+t("friends of friends")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(d)}}else{if($(this).hasClass("uploadinfocheckbox4")){if($(this).parent().hasClass("friendscontainer")){var d='<div class="peoplesdata formttl13" id="followersdata" data-email="" data-id=""><div class="peoplesdatainside">'+t("followers")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(d)}}}}$(this).addClass("active")}});$(document).on("click","#chk-constrain",function(){if($("#chk-constrain").hasClass("active")){$(this).removeClass("active");$(this).parent().attr("title","Activate Constraint")}else{$(this).addClass("active");$(this).parent().attr("title","Deactivate Constraint")}});$(document).on("click","#edit_photo_rotate_left",function(){ImageEditor.rotate(90)});$(document).on("click","#edit_photo_rotate_right",function(){ImageEditor.rotate(270)});$(document).on("click","#edit_photo_undo",function(){ImageEditor.undo()});$(document).on("click","#edit_photo_redo",function(){ImageEditor.redo()});$(document).on("change","#edit_photo_effect",function(){var d=$("#edit_photo_effect").val();if(d==="grayscale"){ImageEditor.grayscale()}else{if(d==="sepia"){ImageEditor.sepia()}else{if(d==="pencil"){ImageEditor.pencil()}else{if(d==="emboss"){ImageEditor.emboss()}else{if(d==="sblur"){ImageEditor.sblur()}else{if(d==="smooth"){ImageEditor.smooth()}else{if(d==="invert"){ImageEditor.invert()}else{if(d==="brighten"){ImageEditor.brighten()}else{if(d==="darken"){ImageEditor.darken()}}}}}}}}}});$(document).on("click","#edit_photo_reset",function(){ImageEditor.viewOriginal();$("#edit_photo_effect").val("")});$(document).on("change","#edit_photo_width",(function(){ImageEditor.txtWidthKeyup();ImageEditor.resize()}));$(document).on("change","#edit_photo_height",function(){ImageEditor.txtHeightKeyup();ImageEditor.resize()});var c=parseInt($("#right_container").attr("data-value"));$("#privacyclass_user"+c).click();if(c==USER_PRIVACY_SELECTED){$("#right_container").find(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var d=$(this);if(d.attr("id")=="friendsdata"){}else{if(d.attr("id")=="friends_of_friends_data"){}else{if(d.attr("id")=="followersdata"){}else{if(parseInt(d.attr("data-id"))!=0){SelectedUsersAdd(d.attr("data-id"))}}}}})}if(parseInt(channelid)==0){privacyValue=parseInt($(".privacyclass.active").attr("data-value"))}else{privacyValue=USER_PRIVACY_PUBLIC;var a=$("#right_container");$(".peoplecontainer_custom").addClass("displaynone");$(".info_pop_container").show();$(".uploadinfomandatory",a).addClass("inactive");$(".uploadinfomandatorytitle",a).removeClass("inactive");$(".uploadinfomandatorycategory",a).removeClass("inactive");$(".uploadinfomandatorycountry",a).removeClass("inactive");$(".uploadinfomandatorycitynameaccent",a).removeClass("inactive")}privacyArray=new Array();if(privacyValue==USER_PRIVACY_SELECTED){$(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var d=$(this);if(d.attr("id")=="friendsdata"){privacyArray.push({friends:1})}else{if(d.attr("id")=="friends_of_friends_data"){privacyArray.push({friends_of_friends:1})}else{if(d.attr("id")=="followersdata"){privacyArray.push({followers:1})}else{if(parseInt(d.attr("data-id"))!=0){privacyArray.push({id:d.attr("data-id")})}}}}})}});function verifyFormList(d){var c=true;var a=$("#"+d).find("#edit_info_part");$(".uploadinfomandatory span",a).html("");$("input,select,textarea",a).removeClass("err").each(function(){var f=$(this).attr("name");var e=$(this).parent();if((f=="location")||(f=="location_name")||(f=="placetakenat")||(f=="cityname")||(f=="status")||(f=="vid")||$(this).hasClass("filevalue")||(f=="filename")||(f=="addmoretext")||(f=="vpath")){}else{if(($(".uploadinfomandatory"+f,e).css("display")!="none"&&getObjectData($(this))=="")||(f=="category"&&!$(".uploadinfomandatorycategory",e).hasClass("inactive")&&$(this).val()=="0")||(f=="country"&&!$(".uploadinfomandatorycountry",e).hasClass("inactive")&&$(this).val()=="0")){$(".uploadinfomandatory"+f+" span",e).html(t("please fill this field correctly"));c=false}}});var b=$("input[name=cityname]",a).parent();if(getObjectData($("input[name=cityname]",a))==""&&!$(".uploadinfomandatorycitynameaccent",b).hasClass("inactive")&&$("input[name=cityname]",a).length>0){$(".uploadinfomandatorycitynameaccent span",b).html(t("please fill this field correctly"));c=false}if(!c){return false}else{return true}}function initResetSelectedUsers(a){a.hide();resetSelectedUsers(a.find(".addmore input"));a.find(".uploadinfocheckbox").removeClass("active");a.find(".addmore input").val("");a.find(".addmore input").blur();a.find(".peoplesdata").each(function(){var b=$(this);b.remove()})}function enableSharesComments_log(a,b,c){$.ajax({url:ReturnLink("/ajax/info_log_updatesharescomments.php"),data:{entity_id:a,entity_type:b,new_status:c,globchannelid:channelGlobalID()},type:"post",success:function(d){}})}function addAutoCompleteList(){var a=$("#edit_citynameaccent");a.autocomplete({appendTo:"#right_container",search:function(e,f){var c=$("select[name=country]",a.parent()).removeClass("err");var d=$("option:selected",c).val();if(d=="ZZ"){c.addClass("err");e.preventDefault()}else{a.autocomplete("option","source",ReturnLink("/ajax/uploadGetCities.php?cc="+d))}},select:function(c,d){a.val(d.item.value);$("input[name=cityname]",a.parent()).val(d.item.value);$("input[name=cityname]",a.parent()).attr("data-id",d.item.id);c.preventDefault()}});var b=$("#edit_placetakenat");b.autocomplete({appendTo:"#right_container",search:function(e,f){var c=$("select[name=country]",a.parent()).removeClass("err");var d=$("option:selected",c).val();if(d=="ZZ"){c.addClass("err");e.preventDefault()}else{b.autocomplete("option","source",ReturnLink("/ajax/uploadGetLocations.php?cc="+d))}},select:function(c,d){b.val(d.item.label);$("input[name=location]",b.parent()).val(d.item.id);$("input[name=location_name]",b.parent()).val(d.item.value);c.preventDefault()}})};