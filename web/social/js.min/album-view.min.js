var currentPage=0;var one_object=0;var globorderby="id";var globtxtsrch="";var CATALOG_ID;var GettingNext=false;var GettingPrev=false;var ORIGINAL_MEDIA_ID=0;var DEFAULT_PHOTO_NUMBER=0;var DEFAULT_VIDEO_NUMBER=0;var ORIGINAL_PHOTO_ID=0;var NextPage=0;var PrevPage=0;var SkipNext=1;var SkipPrev=0;var NoMorePrev=false;var NoMoreNext=false;var min_left=0;var objectSelected="";$(document).ready(function(){$("#privacy_icon_viewer").mouseover(function(){var a=$("#albumcontainer").offset().left+255;var b=$("#albumcontainer").offset().top+22;var c=$(this).offset().left-a;var d=$(this).offset().top-b;$(".privacybuttonsOver .ProfileHeaderOverin").html($(this).attr("data-title"));$(".privacybuttonsOver").css("left",c+"px");$(".privacybuttonsOver").css("top",d+"px");$(".privacybuttonsOver").stop().show()});$("#privacy_icon_viewer").mouseout(function(){$(".privacybuttonsOver").hide()});$("#load_more_next").click(function(a){a.preventDefault();a.stopImmediatePropagation();currentPage++;displaypicrelated()});$("#searchbut").click(function(){var a=""+$("#srchtxt").val();if(a=="search"){a=""}globorderby=$("#sortby").val();globtxtsrch=a;currentPage=0;$("#albumimagecontainer ul").html("");displaypicrelated()});$(document).on("click",".selectitem",function(){$(this).closest("li").find(".EditMediaActionButs").click()});$(document).on("click","#albumimagecontainer ul li .clsimg",function(){var a=$(this).closest("li");var b="photo";if(a.attr("data-type")=="v"){b="video"}TTAlert({msg:sprintf(t("confirm to remove selected %s from album"),[b]),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(c){if(c){$(".upload-overlay-loading-fix").show();var e=a.attr("id");var d=new Array();d.push(e);$.post(ReturnLink("/ajax/ajax_deletepiccatalog.php"),{catid:CATALOG_ID,idarr:d.join("/*/")},function(f){if(f){a.remove();one_object=1;displaypicrelated()}else{$(".upload-overlay-loading-fix").hide()}})}}})});$(document).on("mouseover","#albumimagecontainer ul li .selectitem",function(){$(this).css("opacity",1)});$(document).on("mouseout","#albumimagecontainer ul li .selectitem",function(){$(this).css("opacity",0)});$(document).on("click","#albumimagecontainer ul li .selectitem",function(){var a=$(this).parent();objectSelected=a});$(document).on("click","#albumimagecontainer ul li .imgbk .albumimg:not(.albumimgActive)",function(){var a=$(this).closest("li");TTAlert({msg:t("confirm to set album icon"),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(b){if(b){$(".upload-overlay-loading-fix").show();var c=a.attr("id");$.post(ReturnLink("/ajax/ajax_addalbumicon.php"),{catid:CATALOG_ID,id:c},function(d){try{ret=$.parseJSON(d)}catch(e){return}if(!ret){TTAlert({msg:t("Couldnt set album icon."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(ret.status=="1"){$("#albumimagecontainer li .albumimg").removeClass("albumimgActive");$("#albumimagecontainer li#"+ret.id+" .albumimg").addClass("albumimgActive")}initDocumentAlbum();$(".upload-overlay-loading-fix").hide()})}}})});$(document).on("click","#uploadlistpopuppublishalbum .UploadMediaRightTF #log_save_media",function(){var c="uploadlistpopuppublishalbum";if(verifyFormList(c)){var b=$(this).closest(".tableform");var e=b.find(".privacyclass.active").attr("data-value");var d=new Array();if(e==USER_PRIVACY_SELECTED){b.find(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var f=$(this);if(f.attr("id")=="friendsdata"){d.push({friends:1})}else{if(f.attr("id")=="friends_of_friends_data"){d.push({friends_of_friends:1})}else{if(f.attr("id")=="followersdata"){d.push({followers:1})}else{if(parseInt(f.attr("data-id"))!=0){d.push({id:f.attr("data-id")})}}}}})}if((e==USER_PRIVACY_SELECTED&&d.length==0)){b.find(".error_valid").html(t("Invalid privacy data"));return}var a=$(this);$.post(ReturnLink("/ajax/profile_media_save.php"),{privacyValue:e,privacyArray:d,vid:$("#uploadlistpopuppublishalbum").attr("data-id"),title:getObjectData($("#"+c+" input[name=title]")),cityname:$("#"+c+" input[name=cityname]").val(),cityid:$("#"+c+" input[name=cityname]").attr("data-id"),citynameaccent:$("#"+c+" input[name=citynameaccent]").val(),is_public:$("#"+c+" div.privacyclass.active").attr("data-value"),description:getObjectData($("#"+c+" textarea[name=description]")),category:$("#"+c+" select[name=category] option:selected").val(),placetakenat:getObjectData($("#"+c+" input[name=placetakenat]")),keywords:getObjectData($("#"+c+" input[name=keywords]")),country:$("#"+c+" select[name=country] option:selected").val(),location:$("#"+c+" input[name=location]").val()},function(f){var h=null;try{h=$.parseJSON(f)}catch(g){$(".fancybox-close").click()}if(!h){$(".fancybox-close").click();return}if(h.status=="error"){TTAlert({msg:h.msg,type:"alert",btn1:"",btn2:t("ok")});$(".fancybox-close").click();return}objectSelected.find(".imgtitle").html(h.title);$(".fancybox-close").click()})}});$(document).on("click","#uploadlistpopuppublishalbum #loglistalbumelected .ClearNewAlbumButton",function(){$(".fancybox-close").click()});$(document).on("click",".UploadMediaLeftTF .privacyclass",function(){$(".privacyclass",$(this).parent().parent()).removeClass("active");$(this).addClass("active");var b=parseInt($(this).attr("data-value"));var a=$(this).parent().parent().parent();$(".uploadinfomandatory span",a).html("");switch(b){case USER_PRIVACY_PRIVATE:initResetSelectedUsers($(this).closest(".tableform").find(".peoplecontainer_custom"));$(".uploadinfomandatory",a).addClass("inactive");$(".uploadinfomandatorytitle",a).removeClass("inactive");break;case USER_PRIVACY_SELECTED:$(this).closest(".tableform").find(".peoplecontainer_custom").show();$(".uploadinfomandatory",a).addClass("inactive");$(".uploadinfomandatorytitle",a).removeClass("inactive");$(".uploadinfomandatorycategory",a).removeClass("inactive");$(".uploadinfomandatorycountry",a).removeClass("inactive");$(".uploadinfomandatorycitynameaccent",a).removeClass("inactive");break;default:initResetSelectedUsers($(this).closest(".tableform").find(".peoplecontainer_custom"));$(".uploadinfomandatory",a).addClass("inactive");$(".uploadinfomandatorytitle",a).removeClass("inactive");$(".uploadinfomandatorycategory",a).removeClass("inactive");$(".uploadinfomandatorycountry",a).removeClass("inactive");$(".uploadinfomandatorycitynameaccent",a).removeClass("inactive");break}});$(document).on("click",".uploadinfocheckbox",function(){if($(this).hasClass("active")){$(this).removeClass("active");if($(this).hasClass("uploadinfocheckbox3")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#friendsdata").remove()}}else{if($(this).hasClass("uploadinfocheckbox_friends_of_friends")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#friends_of_friends_data").remove()}}else{if($(this).hasClass("uploadinfocheckbox4")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#followersdata").remove()}}}}}else{$(this).addClass("active");if($(this).hasClass("uploadinfocheckbox3")){if($(this).parent().hasClass("friendscontainer")){var b='<div class="peoplesdata formttl13" id="friendsdata" data-email="" data-id=""><div class="peoplesdatainside">'+t("friends")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(b)}}else{if($(this).hasClass("uploadinfocheckbox_friends_of_friends")){if($(this).parent().hasClass("friendscontainer")){var a='<div class="peoplesdata formttl13" id="friends_of_friends_data" data-email="" data-id=""><div class="peoplesdatainside">'+t("friends of friends")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(a)}}else{if($(this).hasClass("uploadinfocheckbox4")){if($(this).parent().hasClass("friendscontainer")){var a='<div class="peoplesdata formttl13" id="followersdata" data-email="" data-id=""><div class="peoplesdatainside">'+t("followers")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(a)}}}}}});$(document).on("click",".peoplesdataclose",function(){var a=$(this).parent();var b=a.parent().parent();a.remove();if(a.attr("data-id")!=""){SelectedUsersDelete(a.attr("data-id"),b.find(".addmore input"))}if(a.attr("id")=="friendsdata"){b.find(".uploadinfocheckbox3").removeClass("active")}else{if(a.attr("id")=="followersdata"){b.find(".uploadinfocheckbox4").removeClass("active")}else{if(a.attr("id")=="connectionsdata"){b.find(".uploadinfocheckbox5").removeClass("active")}else{if(a.attr("id")=="sponsorssdata"){b.find(".uploadinfocheckbox6").removeClass("active")}else{if(a.attr("id")=="friends_of_friends_data"){b.find(".uploadinfocheckbox_friends_of_friends").removeClass("active")}}}}}});initDocumentAlbum()});function initDocumentAlbum(){$(document).on("mouseover",".imgbk_butons .imgbk_buts:not(.albumimgActive)",function(){var a=$(this).offset().left-$("#ProfileHeaderInternal").offset().left-252;var b=$(this).offset().top-$("#ProfileHeaderInternal").offset().top-21;$(".ProfileHeaderOver .ProfileHeaderOverin").html($(this).attr("data-title"));$(".ProfileHeaderOver").css("left",a+"px");$(".ProfileHeaderOver").css("top",b+"px");$(".ProfileHeaderOver").stop().show()});$(".imgbk_butons .imgbk_buts").mouseout(function(){$(".ProfileHeaderOver").hide()});refreshEditMedia()}function refreshEditMedia(){$("a.EditMediaActionButs").each(function(){var a=$(this);var b=$(this).attr("rel");a.fancybox({padding:0,margin:0,beforeLoad:function(){$("#uploadlistpopuppublishalbum .inputuploadformTF").val("");$("#uploadlistpopuppublishalbum #logalbumaddcountry, #newphototo #logalbumaddcategory").val("0");$("#uploadlistpopuppublishalbum .inputuploaddescriptionTF").val("");$("#uploadlistpopuppublishalbum textarea[name=description]").blur();$("#uploadlistpopuppublishalbum input[name=placetakenat]").blur();$("#uploadlistpopuppublishalbum input[name=keywords]").blur();objectSelected=a.closest("li");MediaEditData(b)}})})}function MediaEditData(a){$.post(ReturnLink("/ajax/profile_media_details.php"),{id:a},function(b){if(b!=false){$("#uploadlistpopuppublishalbum").html(b);$("#uploadlistpopuppublishalbum input[name=title]").blur();$("#uploadlistpopuppublishalbum textarea[name=description]").blur();$("#uploadlistpopuppublishalbum input[name=placetakenat]").blur();$("#uploadlistpopuppublishalbum input[name=keywords]").blur();$("#uploadlistpopuppublishalbum .uploadinfocheckboxcontainer").remove();addAutoCompleteList("uploadlistpopuppublishalbum");$("#uploadlistpopuppublishalbum").attr("data-id",a);var c=parseInt($("#uploadlistpopuppublishalbum .formcontainer").attr("data-value"));$("#uploadlistpopuppublishalbum #privacyclass_user"+c).click();if(c==USER_PRIVACY_SELECTED){$("#uploadlistpopuppublishalbum").find(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var d=$(this);if(d.attr("id")=="friendsdata"){}else{if(d.attr("id")=="friends_of_friends_data"){}else{if(d.attr("id")=="followersdata"){}else{if(parseInt(d.attr("data-id"))!=0){SelectedUsersAdd(d.attr("data-id"))}}}}})}addmoreusersautocomplete_custom_journal($("#uploadlistpopuppublishalbum #addmoretext_privacy"))}})}function addValue1(a){if($(a).attr("value")==""){$(a).attr("value",$(a).attr("data-value"))}}function removeValue1(a){if($(a).attr("value")==$(a).attr("data-value")){$(a).attr("value","")}}function checkSubmit(a){if(a&&a.keyCode==13){$("#searchbut").click()}}function isNumberKey(b){var a=(b.which)?b.which:b.keyCode;if(a>31&&(a<48||a>57)){return false}return true}function displaypicrelated(){$(".upload-overlay-loading-fix").show();$.post(ReturnLink("/ajax/ajax_getpicalbum.php"),{catid:CATALOG_ID,currentPage:currentPage,txtsrch:globtxtsrch,globorderby:globorderby,one_object:one_object},function(b){if(b!=false){one_object=0;$("#albumimagecontainer ul").append(b);var a=$("#albumimagecontainer .currPageStatus");if((""+a.attr("data-value"))=="0"){$("#load_more_next").hide()}else{$("#load_more_next").show()}$(".data_head_text span.yellowbold12").html("("+a.attr("data-count")+")");a.remove();initDocumentAlbum()}else{$("#load_more_next").hide()}$(".upload-overlay-loading-fix").hide()})}function postMediaSave(a){if(objectSelected!=""){objectSelected.find(".imgtitle").html(a.title)}}function initResetSelectedUsers(a){a.hide();resetSelectedUsers(a.find(".addmore input"));a.find(".uploadinfocheckbox").removeClass("active");a.find(".addmore input").val("");a.find(".addmore input").blur();a.find(".peoplesdata").each(function(){var b=$(this);b.remove()})}function addAutoCompleteList(b){var a=$("input[name=citynameaccent]",$("#"+b));a.autocomplete({appendTo:"#contentcontainer",search:function(e,f){var c=$("select[name=country]",a.parent()).removeClass("err");var d=$("option:selected",c).val();if(d=="ZZ"){c.addClass("err");e.preventDefault()}else{a.autocomplete("option","source",ReturnLink("/ajax/uploadGetCities.php?cc="+d))}},select:function(c,d){a.val(d.item.value);$("input[name=cityname]",a.parent()).val(d.item.value);$("input[name=cityname]",a.parent()).attr("data-id",d.item.id);c.preventDefault()}})}function verifyFormList(d){var c=true;var a=$("#"+d);$(".uploadinfomandatory span",a).html("");$("input,select,textarea",a).removeClass("err").each(function(){var f=$(this).attr("name");var e=$(this).parent();if((f=="location")||(f=="location_name")||(f=="cityname")||(f=="status")||(f=="vid")||$(this).hasClass("filevalue")||(f=="filename")||(f=="addmoretext")||(f=="vpath")){}else{if(($(".uploadinfomandatory"+f,e).css("display")!="none"&&getObjectData($(this))=="")||(f=="category"&&!$(".uploadinfomandatorycategory",e).hasClass("inactive")&&$(this).val()=="0")||(f=="country"&&!$(".uploadinfomandatorycountry",e).hasClass("inactive")&&$(this).val()=="0")){$(".uploadinfomandatory"+f+" span",e).html(t("please fill this field correctly"));c=false}}});var b=$("input[name=cityname]",a).parent();if(getObjectData($("input[name=cityname]",a))==""&&!$(".uploadinfomandatorycitynameaccent",b).hasClass("inactive")&&$("input[name=cityname]",a).length>0){$(".uploadinfomandatorycitynameaccent span",b).html(t("please fill this field correctly"));c=false}if(!c){return false}else{return true}};