(function(a){var e=/^key/,f=/^(?:mouse|contextmenu)|click/,d=/\[object (?:HTML)?Document\]/;function c(h){return d.test(Object.prototype.toString.call(h))}function g(h){for(var j=0;j<window.frames.length;j+=1){if(window.frames[j].document===h){return window.frames[j]}}return window}a.fn.simulate=function(i,h){return this.each(function(){new a.simulate(this,i,h)})};a.simulate=function(h,k,j){var i=a.camelCase("simulate-"+k);this.target=h;this.options=j||{};if(this[i]){this[i]()}else{this.simulateEvent(h,k,this.options)}};a.extend(a.simulate.prototype,{simulateEvent:function(h,k,j){var i=this.createEvent(k,j);this.dispatchEvent(h,k,i,j)},createEvent:function(i,h){if(e.test(i)){return this.keyEvent(i,h)}if(f.test(i)){return this.mouseEvent(i,h)}},mouseEvent:function(n,m){var k,l,i=c(this.target)?this.target:(this.target.ownerDocument||document),j,h;m=a.extend({bubbles:true,cancelable:(n!=="mousemove"),view:g(i),detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,button:0,relatedTarget:undefined},m);if(i.createEvent){k=i.createEvent("MouseEvents");k.initMouseEvent(n,m.bubbles,m.cancelable,m.view,m.detail,m.screenX,m.screenY,m.clientX,m.clientY,m.ctrlKey,m.altKey,m.shiftKey,m.metaKey,m.button,m.relatedTarget||i.body.parentNode);if(k.pageX===0&&k.pageY===0&&Object.defineProperty){l=c(k.relatedTarget)?k.relatedTarget:(k.relatedTarget.ownerDocument||document);j=l.documentElement;h=l.body;Object.defineProperty(k,"pageX",{get:function(){return m.clientX+(j&&j.scrollLeft||h&&h.scrollLeft||0)-(j&&j.clientLeft||h&&h.clientLeft||0)}});Object.defineProperty(k,"pageY",{get:function(){return m.clientY+(j&&j.scrollTop||h&&h.scrollTop||0)-(j&&j.clientTop||h&&h.clientTop||0)}})}}else{if(i.createEventObject){k=i.createEventObject();a.extend(k,m);k.button={0:1,1:4,2:2}[k.button]||k.button}}return k},keyEvent:function(l,k){var j,h;k=a.extend({bubbles:true,cancelable:true,view:g(h),ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,keyCode:0,charCode:undefined},k);h=c(this.target)?this.target:(this.target.ownerDocument||document);if(h.createEvent){try{j=h.createEvent("KeyEvents");j.initKeyEvent(l,k.bubbles,k.cancelable,k.view,k.ctrlKey,k.altKey,k.shiftKey,k.metaKey,k.keyCode,k.charCode)}catch(i){j=h.createEvent("Events");j.initEvent(l,k.bubbles,k.cancelable);a.extend(j,{view:k.view,ctrlKey:k.ctrlKey,altKey:k.altKey,shiftKey:k.shiftKey,metaKey:k.metaKey,keyCode:k.keyCode,charCode:k.charCode})}}else{if(h.createEventObject){j=h.createEventObject();a.extend(j,k)}}if(a.browser.msie||a.browser.opera){j.keyCode=(k.charCode>0)?k.charCode:k.keyCode;j.charCode=undefined}return j},dispatchEvent:function(h,j,i){if(h.dispatchEvent){h.dispatchEvent(i)}else{if(h.fireEvent){h.fireEvent("on"+j,i)}}},simulateFocus:function(){var i,k=false,h=a(this.target);function j(){k=true}h.bind("focus",j);h[0].focus();if(!k){i=a.Event("focusin");i.preventDefault();h.trigger(i);h.triggerHandler("focus")}h.unbind("focus",j)},simulateBlur:function(){var i,k=false,h=a(this.target);function j(){k=true}h.bind("blur",j);h[0].blur();setTimeout(function(){if(h[0].ownerDocument.activeElement===h[0]){h[0].ownerDocument.body.focus()}if(!k){i=a.Event("focusout");i.preventDefault();h.trigger(i);h.triggerHandler("blur")}h.unbind("blur",j)},1)}});function b(i){var j,h;i=a(i);if(c(i[0])){h=i;j={left:0,top:0}}else{h=a(i[0].ownerDocument||document);j=i.offset()}return{x:j.left+i.outerWidth()/2-h.scrollLeft(),y:j.top+i.outerHeight()/2-h.scrollTop()}}a.extend(a.simulate.prototype,{simulateDrag:function(){var n=this.target,m=this.options,h=b(n),o=Math.floor(h.x),p=Math.floor(h.y),k=m.dx||0,l=m.dy||0,i={clientX:o,clientY:p},j=c(n)?n:(n.ownerDocument||document);this.simulateEvent(n,"mousedown",i);i={clientX:o+1,clientY:p+1};this.simulateEvent(j,"mousemove",i);i={clientX:o+k,clientY:p+l};this.simulateEvent(j,"mousemove",i);this.simulateEvent(j,"mousemove",i);this.simulateEvent(n,"mouseup",i);this.simulateEvent(n,"click",i)}})})(jQuery);