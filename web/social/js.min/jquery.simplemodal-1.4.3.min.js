(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(a){var b=[],c=a(document),e=a.browser.msie&&parseInt(a.browser.version)===6&&typeof window.XMLHttpRequest!=="object",f=a.browser.msie&&parseInt(a.browser.version)===7,g=null,i=a(window),h=[];a.modal=function(d,j){return a.modal.impl.init(d,j)};a.modal.close=function(){a.modal.impl.close()};a.modal.focus=function(d){a.modal.impl.focus(d)};a.modal.setContainerDimensions=function(){a.modal.impl.setContainerDimensions()};a.modal.setPosition=function(){a.modal.impl.setPosition()};a.modal.update=function(d,j){a.modal.impl.update(d,j)};a.fn.modal=function(d){return a.modal.impl.init(this,d)};a.modal.defaults={appendTo:"body",focus:true,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:false,autoPosition:true,zIndex:1000,close:true,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:true,overlayClose:false,fixed:true,position:null,persist:false,modal:true,onOpen:null,onShow:null,onClose:null};a.modal.impl={d:{},init:function(d,j){var k=this;if(k.d.data){return false}g=a.browser.msie&&!a.support.boxModel;k.o=a.extend({},a.modal.defaults,j);k.zIndex=k.o.zIndex;k.occb=false;if(typeof d==="object"){d=d instanceof a?d:a(d);k.d.placeholder=false;if(d.parent().parent().size()>0){d.before(a("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"}));k.d.placeholder=true;k.display=d.css("display");if(!k.o.persist){k.d.orig=d.clone(true)}}}else{if(typeof d==="string"||typeof d==="number"){d=a("<div></div>").html(d)}else{alert("SimpleModal Error: Unsupported data type: "+typeof d);return k}}k.create(d);d=null;k.open();if(a.isFunction(k.o.onShow)){k.o.onShow.apply(k,[k.d])}return k},create:function(d){var j=this;j.getDimensions();if(j.o.modal&&e){j.d.iframe=a('<iframe src="javascript:false;"></iframe>').css(a.extend(j.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:h[0],width:h[1],zIndex:j.o.zIndex,top:0,left:0})).appendTo(j.o.appendTo)}j.d.overlay=a("<div></div>").attr("id",j.o.overlayId).addClass("simplemodal-overlay").css(a.extend(j.o.overlayCss,{display:"none",opacity:j.o.opacity/100,height:j.o.modal?b[0]:0,width:j.o.modal?b[1]:0,position:"fixed",left:0,top:0,zIndex:j.o.zIndex+1})).appendTo(j.o.appendTo);j.d.container=a("<div></div>").attr("id",j.o.containerId).addClass("simplemodal-container").css(a.extend({position:j.o.fixed?"fixed":"absolute"},j.o.containerCss,{display:"none",zIndex:j.o.zIndex+2})).append(j.o.close&&j.o.closeHTML?a(j.o.closeHTML).addClass(j.o.closeClass):"").appendTo(j.o.appendTo);j.d.wrap=a("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(j.d.container);j.d.data=d.attr("id",d.attr("id")||j.o.dataId).addClass("simplemodal-data").css(a.extend(j.o.dataCss,{display:"none"})).appendTo("body");d=null;j.setContainerDimensions();j.d.data.appendTo(j.d.wrap);if(e||g){j.fixIE()}},bindEvents:function(){var d=this;a("."+d.o.closeClass).bind("click.simplemodal",function(j){j.preventDefault();d.close()});if(d.o.modal&&d.o.close&&d.o.overlayClose){d.d.overlay.bind("click.simplemodal",function(j){j.preventDefault();d.close()})}c.bind("keydown.simplemodal",function(j){if(d.o.modal&&j.keyCode===9){d.watchTab(j)}else{if((d.o.close&&d.o.escClose)&&j.keyCode===27){j.preventDefault();d.close()}}});i.bind("resize.simplemodal orientationchange.simplemodal",function(){d.getDimensions();d.o.autoResize?d.setContainerDimensions():d.o.autoPosition&&d.setPosition();if(e||g){d.fixIE()}else{if(d.o.modal){d.d.iframe&&d.d.iframe.css({height:h[0],width:h[1]});d.d.overlay.css({height:b[0],width:b[1]})}}})},unbindEvents:function(){a("."+this.o.closeClass).unbind("click.simplemodal");c.unbind("keydown.simplemodal");i.unbind(".simplemodal");this.d.overlay.unbind("click.simplemodal")},fixIE:function(){var j=this,d=j.o.position;a.each([j.d.iframe||null,!j.o.modal?null:j.d.overlay,j.d.container.css("position")==="fixed"?j.d.container:null],function(u,t){if(t){var k="document.body.clientHeight",l="document.body.clientWidth",m="document.body.scrollHeight",n="document.body.scrollLeft",o="document.body.scrollTop",p="document.body.scrollWidth",q="document.documentElement.clientHeight",r="document.documentElement.clientWidth",y="document.documentElement.scrollLeft",z="document.documentElement.scrollTop",x=t[0].style;x.position="absolute";if(u<2){x.removeExpression("height");x.removeExpression("width");x.setExpression("height",""+m+" > "+k+" ? "+m+" : "+k+' + "px"');x.setExpression("width",""+p+" > "+l+" ? "+p+" : "+l+' + "px"')}else{var A,v;if(d&&d.constructor===Array){var B=d[0]?typeof d[0]==="number"?d[0].toString():d[0].replace(/px/,""):t.css("top").replace(/px/,"");A=B.indexOf("%")===-1?B+" + (t = "+z+" ? "+z+" : "+o+') + "px"':parseInt(B.replace(/%/,""))+" * (("+q+" || "+k+") / 100) + (t = "+z+" ? "+z+" : "+o+') + "px"';if(d[1]){var w=typeof d[1]==="number"?d[1].toString():d[1].replace(/px/,"");v=w.indexOf("%")===-1?w+" + (t = "+y+" ? "+y+" : "+n+') + "px"':parseInt(w.replace(/%/,""))+" * (("+r+" || "+l+") / 100) + (t = "+y+" ? "+y+" : "+n+') + "px"'}}else{A="("+q+" || "+k+") / 2 - (this.offsetHeight / 2) + (t = "+z+" ? "+z+" : "+o+') + "px"';v="("+r+" || "+l+") / 2 - (this.offsetWidth / 2) + (t = "+y+" ? "+y+" : "+n+') + "px"'}x.removeExpression("top");x.removeExpression("left");x.setExpression("top",A);x.setExpression("left",v)}}})},focus:function(k){var l=this,j=k&&a.inArray(k,["first","last"])!==-1?k:"first";var d=a(":input:enabled:visible:"+j,l.d.wrap);setTimeout(function(){d.length>0?d.focus():l.d.wrap.focus()},10)},getDimensions:function(){var j=this,d=typeof window.innerHeight==="undefined"?i.height():window.innerHeight;b=[c.height(),c.width()];h=[d,i.width()]},getVal:function(k,j){return k?(typeof k==="number"?k:k==="auto"?0:k.indexOf("%")>0?((parseInt(k.replace(/%/,""))/100)*(j==="h"?h[0]:h[1])):parseInt(k.replace(/px/,""))):null},update:function(d,k){var j=this;if(!j.d.data){return false}j.d.origHeight=j.getVal(d,"h");j.d.origWidth=j.getVal(k,"w");j.d.data.hide();d&&j.d.container.css("height",d);k&&j.d.container.css("width",k);j.setContainerDimensions();j.d.data.show();j.o.focus&&j.focus();j.unbindEvents();j.bindEvents()},setContainerDimensions:function(){var u=this,d=e||f;var j=u.d.origHeight?u.d.origHeight:a.browser.opera?u.d.container.height():u.getVal(d?u.d.container[0].currentStyle.height:u.d.container.css("height"),"h"),k=u.d.origWidth?u.d.origWidth:a.browser.opera?u.d.container.width():u.getVal(d?u.d.container[0].currentStyle.width:u.d.container.css("width"),"w"),l=u.d.data.outerHeight(true),m=u.d.data.outerWidth(true);u.d.origHeight=u.d.origHeight||j;u.d.origWidth=u.d.origWidth||k;var r=u.o.maxHeight?u.getVal(u.o.maxHeight,"h"):null,t=u.o.maxWidth?u.getVal(u.o.maxWidth,"w"):null,n=r&&r<h[0]?r:h[0],q=t&&t<h[1]?t:h[1];var o=u.o.minHeight?u.getVal(u.o.minHeight,"h"):"auto";if(!j){if(!l){j=o}else{if(l>n){j=n}else{if(u.o.minHeight&&o!=="auto"&&l<o){j=o}else{j=l}}}}else{j=u.o.autoResize&&j>n?n:j<o?o:j}var p=u.o.minWidth?u.getVal(u.o.minWidth,"w"):"auto";if(!k){if(!m){k=p}else{if(m>q){k=q}else{if(u.o.minWidth&&p!=="auto"&&m<p){k=p}else{k=m}}}}else{k=u.o.autoResize&&k>q?q:k<p?p:k}u.d.container.css({height:j,width:k});u.d.wrap.css({overflow:(l>j||m>k)?"auto":"visible"});u.o.autoPosition&&u.setPosition()},setPosition:function(){var k=this,m,j,d=(h[0]/2)-(k.d.container.outerHeight(true)/2),n=(h[1]/2)-(k.d.container.outerWidth(true)/2),l=k.d.container.css("position")!=="fixed"?i.scrollTop():0;if(k.o.position&&Object.prototype.toString.call(k.o.position)==="[object Array]"){m=l+(k.o.position[0]||d);j=k.o.position[1]||n}else{m=l+d;j=n}k.d.container.css({left:j,top:m})},watchTab:function(d){var k=this;if(a(d.target).parents(".simplemodal-container").length>0){k.inputs=a(":input:enabled:visible:first, :input:enabled:visible:last",k.d.data[0]);if((!d.shiftKey&&d.target===k.inputs[k.inputs.length-1])||(d.shiftKey&&d.target===k.inputs[0])||k.inputs.length===0){d.preventDefault();var j=d.shiftKey?"last":"first";k.focus(j)}}else{d.preventDefault();k.focus()}},open:function(){var d=this;d.d.iframe&&d.d.iframe.show();if(a.isFunction(d.o.onOpen)){d.o.onOpen.apply(d,[d.d])}else{d.d.overlay.show();d.d.container.show();d.d.data.show()}d.o.focus&&d.focus();d.bindEvents()},close:function(){var j=this;if(!j.d.data){return false}j.unbindEvents();if(a.isFunction(j.o.onClose)&&!j.occb){j.occb=true;j.o.onClose.apply(j,[j.d])}else{if(j.d.placeholder){var d=a("#simplemodal-placeholder");if(j.o.persist){d.replaceWith(j.d.data.removeClass("simplemodal-data").css("display",j.display))}else{j.d.data.hide().remove();d.replaceWith(j.d.orig)}}else{j.d.data.hide().remove()}j.d.container.hide().remove();j.d.overlay.hide();j.d.iframe&&j.d.iframe.hide().remove();j.d.overlay.remove();j.d={}}}}}));