var applyalbumcheckcount=0;var counterfilepubleshed=0;var boolloderappear=false;var countfileupload=0;var countfileuploadnumber=0;var defaultheight=452;var searchdescriptiontext="for better visibility and online search, please fill here";function uniqueid(){var b=String.fromCharCode(Math.floor((Math.random()*25)+65));do{var a=Math.floor((Math.random()*42)+48);if(a<58||a>64){b+=String.fromCharCode(a)}}while(b.length<32);return(b)}function verifyForm(d){var c=true;var a=$("#"+d);if(currentsection=="upload-album"&&(d=="logalbumadd"||d=="logalbumelected")){a=$("."+d)}$(".uploadinfomandatory span",a).html("");$("input,select,textarea",a).removeClass("err").each(function(){var f=$(this).attr("name");var e=$(this).parent();if((f=="location")||(f=="location_name")||(f=="cityname")||(f=="status")||(f=="vid")||$(this).hasClass("filevalue")){}else{if((!$(".uploadinfomandatory"+f,e).hasClass("inactive")&&$(".uploadinfomandatory"+f,e).css("display")!="none"&&$(this).val()=="")||(f=="category"&&!$(".uploadinfomandatorycategory",e).hasClass("inactive")&&$(this).val()=="0")||(f=="country"&&!$(".uploadinfomandatorycountry",e).hasClass("inactive")&&$(this).val()=="0")){$(".uploadinfomandatory"+f+" span",e).html(t("please fill this field correctly"));c=false}}});var b=$("input[name=cityname]",a).parent();if($("input[name=cityname]",a).val()==""&&!$(".uploadinfomandatorycitynameaccent",b).hasClass("inactive")){$(".uploadinfomandatorycitynameaccent span",b).html(t("please fill this field correctly"));c=false}if(!c){TTAlert({msg:t("Please input mandatory fields"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return false}else{return true}}var _AutocompleteCities=null;function AutocompleteCitiesReset(){_AutocompleteCities=new Array()}function AutocompleteCitiesAdd(a){_AutocompleteCities.push(a)}function AutocompleteCitiesExists(a){if(_AutocompleteCities===null){return null}var b=removeDiacritics(a);for(var c=0;c<_AutocompleteCities.length;c++){if(b.toLowerCase()===_AutocompleteCities[c].value.toLowerCase()){return _AutocompleteCities[c]}}return null}function addAutoComplete(b){var a=$("input[name=citynameaccent]",$("#SWFUpload_2_"+b));if(currentsection=="upload-album"&&(b=="logalbumadd"||b=="logalbumelected")){a=$("#log_2 #"+b+"citynameaccent")}a.autocomplete({appendTo:"#MiddleInsideNormal",search:function(e,f){var c=$("select[name=country]",a.parent()).removeClass("err");var d=$("option:selected",c).val();if(d=="ZZ"){c.addClass("err");e.preventDefault()}else{a.autocomplete("option","source",ReturnLink("/ajax/uploadGetCities.php?cc="+d))}AutocompleteCitiesReset()},select:function(c,d){a.val(ucwords(d.item.value));$("input[name=cityname]",a.parent()).val(d.item.value);$("input[name=cityname]",a.parent()).attr("data-id",d.item.id);c.preventDefault()},change:function(c,e){if(!e.item){var d=AutocompleteCitiesExists(a.val());if(d===null){a.val("");return}a.val(ucwords(d.value));$("input[name=cityname]",a.parent()).val(d.value)}}}).keydown(function(d){var c=(d.keyCode?d.keyCode:d.which);if(AutocompleteCitiesExists(a.val())===null){$("input[name=cityname]",a.parent()).val("");$("input[name=cityname]",a.parent()).attr("data-id","")}if(c===13||c===9){if(AutocompleteCitiesExists(a.val())===null){d.preventDefault();return}if(c===13){$(this).blur()}}}).data("ui-autocomplete")._renderItem=function(d,c){AutocompleteCitiesAdd(c);return $("<li></li>").data("item.autocomplete",c).append("<a>"+ucwords(c.value)+"</a>").appendTo(d)}}function FileUploadCompleted(a){$("#SWFUpload_2_"+a+" .pause").hide();$("#SWFUpload_2_"+a+" .resume").hide()}function FileUploadSaved(){$(".upload2 #log li .licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3.active").each(function(){$(this).parent().parent().parent().remove()});$(".upload2 #log li").each(function(){$(this).find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").hide();$(this).find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").removeClass("active")});$(".upload-overlay-loading-fix-file").hide()}function FileUploadIsSaved(a){return($("#log li#SWFUpload_2_"+a).find("span.status2").html()=="Saved!")}var upload_started=0;function SetPageLeave(){if((uploader.total.queued==0)){setConfirmUnload(false,t('Some media files are being processed. Leaving this page will result in loss of data. Press "Cancel" to continue uploading.'))}else{setConfirmUnload(true,t('Some media files are being processed. Leaving this page will result in loss of data. Press "Cancel" to continue uploading.'))}}function ShowError(b,d){var a=b.id;var c=$("#SWFUpload_2_"+a);$("#SWFUpload_2_"+a+" .pause").hide();$("#SWFUpload_2_"+a+" .resume").hide();c.find("div.progress").css({width:"100%","background-color":"red","background-image":"none"});c.addClass("success").find("span.status").html('<span class="status2">'+d+"</span>");if(countfileupload==countfileuploadnumber){if(!$(".upload2 #log li").find(".togb").hasClass("closeclose")){$(".upload2 #log li").first().find(".togb").click()}countfileupload=countfileuploadnumber=0;$(".upload-loading-txt-file").hide();$(".stop_all_upload").hide();$(".upload-loading-sep").hide()}}function SaveError(a,c){var b=$("#"+a);$("#"+a+" .pause").hide();$("#"+a+" .resume").hide();b.find("div.progress").css({width:"100%","background-color":"red","background-image":"none"});b.addClass("success").find("span.status").find("span.status2").html(c);$(".upload-overlay-loading-fix-file").hide()}function createImage(a,c){var b=a.name.split(".");if(b.length<2){return}b=b[b.length-1].toLowerCase();var d=false;if((b=="png")||(b=="jpg")||(b=="jpeg")||(b=="bmp")||(b=="tiff")||(b=="tif")){d=true}var e='<li id="SWFUpload_2_'+c+'" data-id="'+c+'" data-isImage="'+d+'"><script type="text/javascript">$(document).ready(function(){$("#SWFUpload_2_'+c+' .preloader").hide();$("#SWFUpload_2_'+c+' .preloader").ajaxStart(function(){$(".preloader").hide();$(this).show();$("#SWFUpload_2_'+c+'").css({opacity: 0.4});}).ajaxStop(function(){$(this).hide();$("#SWFUpload_2_'+c+'").css({opacity: 1});});$("#SWFUpload_2_'+c+'fancy").fancybox({"padding"	:0,"margin"	:0,"width"			: 375,"height"			: 146,"transitionIn"		: "none","transitionOut"	: "none","type"				: "iframe"});});</script><div class="licorner"><div class="uploadinfocheckboxAllcontainer"><div class="uploadinfocheckbox_upload uploadinfocheckbox3" style="display:none;"><div class="uploadinfocheckboxpic"></div></div></div><div class="licornericon'+d+'"></div><div class="stanleft"><div class="stanleftin"></div></div><div class="togb openclose"><div class="openclose_over"><div class="openclose_overtxt">'+t("expand")+'</div></div></div><div class="filediv"><div class="filename" title='+a.name+">"+a.name+'</div><div class="progressbar"><div class="progress"></div></div><span class="status" >'+t("Processing")+'</span><span class="cancel" >&nbsp;</span><span class="pause" >&nbsp;</span><span class="resume" >&nbsp;</span></div></div><input type="hidden" name="SWFUpload_2_'+c+'" value="" class="filevalue"></li>';$("#log").append(e);$("#SWFUpload_2_"+c+" .cancel").bind("click",function(){if(FileUploadIsSaved(c)){$("li#SWFUpload_2_"+c).slideUp("fast").remove();showHideSameDescription()}else{TTAlert({msg:t("Are you sure you want to cancel this upload?"),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(f){if(f){var g=uploader.getFile(c);if(!g){}else{if(g.status==plupload.UPLOADING){PauseUpload();uploader.removeFile(a);setTimeout(function(){ResumeUpload()},100);countfileupload--;countfileuploadnumber--;if(countfileupload<=0){$(".upload-loading-txt-file").hide();$(".stop_all_upload").hide();$(".upload-loading-sep").hide()}}else{if($("#SWFUpload_2_"+c+" .resume").css("display")!="none"){$("#SWFUpload_2_"+c+" .resume").click();setTimeout(function(){PauseUpload();uploader.removeFile(a);setTimeout(function(){ResumeUpload()},100)},100)}else{uploader.removeFile(a)}countfileupload--;countfileuploadnumber--;if(countfileupload<=0){$(".upload-loading-txt-file").hide();$(".stop_all_upload").hide();$(".upload-loading-sep").hide()}}}SetPageLeave();deletefile("SWFUpload_2_"+c);$("li#SWFUpload_2_"+c).slideUp("fast").remove();if(countfileupload>1){countfileupload--}if(countfileuploadnumber>1){countfileuploadnumber--}$(".upload-loading-txt-file").hide();$(".stop_all_upload").hide();$(".upload-loading-sep").hide();showHideSameDescription()}}})}});$("#SWFUpload_2_"+c+" .pause").bind("click",function(){var g=uploader.getFile(c);if(!g||g.status!=plupload.UPLOADING){return}var f=$(this);f.hide();$("#SWFUpload_2_"+c+" .resume").show();$("#SWFUpload_2_"+c+" span.status").html(t("Paused"));$("#SWFUpload_2_"+c).find("div.progress").css("width",0+"%");PauseUpload()});$("#SWFUpload_2_"+c+" .resume").bind("click",function(){var f=uploader.getFile(c);if(!f||f.status==plupload.UPLOADING){return}$(this).hide();$("#SWFUpload_2_"+c+" .pause").show();$("#SWFUpload_2_"+c+" span.status").html(t("Uploading"));ResumeUpload()})}function addDescriptionRelated(a,b){if(!$("#SWFUpload_2_"+a).hasClass("desc")){var c=addanotherappend("SWFUpload_2_"+a,b);$("#SWFUpload_2_"+a).append(c);addAutoComplete(a);$("#SWFUpload_2_"+a).addClass("desc");addButtonSave("SWFUpload_2_"+a,b);if(currentsection=="upload-album"){$("#SWFUpload_2_"+a).find(".privacyclass").click()}showHideSameDescription()}}function addButtonSave(c,b){var a="#"+c;$(document).on("click",""+a+" .SaveButton",function(){$(".upload-overlay-loading-fix-file").show();var e=CopyForm($(a));if(!verifyForm(c)){$(".upload-overlay-loading-fix-file").hide();return 0}if(e==""&&currentsection!="upload-album"){e=CopyFormtab1($(a))}var d=CatalogID();if(currentsection=="upload"&&$(a+" .catalog_class").length>0){d=$(a+" .catalog_class").val()}$.ajax({url:ReturnLink("/up_savenew.php"),type:"post",data:{S:$("#S").val(),myformarr:e,is_public:USER_PRIVACY_PUBLIC,title:$(a+" input[name=title]").val(),cityname:$(a+" input[name=cityname]").val(),cityid:$(a+" input[name=cityname]").attr("data-id"),citynameaccent:$(a+" input[name=citynameaccent]").val(),globchannelid:globchannelid,description:getObjectData($(a+" textarea[name=description]")),catalog_id:d,category:$(a+" select[name=category] option:selected").val(),placetakenat:getObjectData($(a+" input[name=placetakenat]")),keywords:getObjectData($(a+" input[name=keywords]")),country:$(a+" select[name=country] option:selected").val(),location:$(a+" input[name=location]").val(),defaultcatalogicon:$(a+" .uploadinfocheckbox2").hasClass("active")?1:0},success:function(f){if(f!=""){if(String(""+b)=="false"){appendfancy(c+"",f)}FileUploadSaved()}},error:function(g,h,f){SaveError(c,"Error: "+h+" "+((f)?f:""))}})})}var uploader=null;var requirements_met=true;var pausemode=0;function PauseUpload(){pausemode=1;uploader.stop()}function ResumeUpload(){pausemode=0;uploader.start()}$(document).ready(function(){defaultheight=404;if(currentsection=="upload"){defaultheight=437}$(document).on("change","select[name=country]",function(){var a=$(this).closest(".UploadMediaRightTF");a.find("input[name=citynameaccent]").val("");a.find("input[name=cityname]").val("");a.find("input[name=cityname]").attr("data-id","")});$(".stop_all_upload").bind("click",function(){TTAlert({msg:t("Are you sure you want to cancel pending uploads?"),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(a){if(a){PauseUpload();uploader.splice();uploader.refresh();ResumeUpload();countfileupload=countfileuploadnumber=0;$(".upload-loading-txt-file").hide();$(".stop_all_upload").hide();$(".upload-loading-sep").hide();$("li.upload2 #log li").each(function(){if(!$(this).hasClass("success")){$(this).remove()}});$(".uploadinsidemenu").attr("target","");$("#slot-machine-tabs #tabsmain li a").attr("target","")}}})});$(document).on("click",".upload2 .togb",function(){var c=$(this);var b=c.parent().parent();if(c.parent().find(".uploadinfocheckboxAllcontainer .uploadinfocheckbox3").hasClass("active")&&c.parent().find(".uploadinfocheckboxAllcontainer .uploadinfocheckbox3").css("display")!="none"){return 0}if(c.hasClass("openclose")){var a=false;if(currentsection=="upload-album"){if($(".uploadalbumselected .uploadinfocheckbox_apply4,.uploadalbumselected .uploadinfocheckbox4").hasClass("active")){$(".uploadalbumselected .uploadinfocheckbox_apply4,.uploadalbumselected .uploadinfocheckbox4").click()}}$(".upload2 #log li").each(function(){var d=$(this);if(d.hasClass("desc")&&!a){a=true;if(formIsFilled(d)){TTAlert({msg:t("You are about to remove your filled data.<br/>Would you like to proceed?"),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(e){if(e){removeCheckBoxSameDescription();d.removeClass("desc");d.find(".formcontainer").remove();d.animate({height:"92px"},500,function(){d.find(".togb").removeClass("closeclose").addClass("openclose")});addDescriptionRelated(b.attr("data-id"),b.attr("data-isImage"));$("div.formcontainer",b).show();b.animate({height:defaultheight+"px"},500,function(){c.removeClass("openclose").addClass("closeclose");$(window).resize()})}}})}else{removeCheckBoxSameDescription();d.removeClass("desc");d.find(".formcontainer").remove();d.animate({height:"92px"},500,function(){d.find(".togb").removeClass("closeclose").addClass("openclose")});addDescriptionRelated(b.attr("data-id"),b.attr("data-isImage"));$("div.formcontainer",b).show();b.animate({height:defaultheight+"px"},500,function(){c.removeClass("openclose").addClass("closeclose");$(window).resize()})}}});if(!a){addDescriptionRelated(b.attr("data-id"),b.attr("data-isImage"));$("div.formcontainer",b).show();b.animate({height:defaultheight+"px"},500,function(){c.removeClass("openclose").addClass("closeclose");$(window).resize()})}}else{if(formIsFilled(b)){TTAlert({msg:t("You are about to remove your filled data.<br/>Would you like to proceed?"),type:"action",btn1:t("cancel"),btn2:t("confirm"),btn2Callback:function(d){if(d){removeCheckBoxSameDescription();b.removeClass("desc");b.find(".formcontainer").remove();b.animate({height:"92px"},500,function(){c.removeClass("closeclose").addClass("openclose");$(window).resize()})}else{setTimeout(function(){b.find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").removeClass("active");b.find(".licorner .togb").show()},100)}}})}else{removeCheckBoxSameDescription();b.removeClass("desc");b.find(".formcontainer").remove();b.animate({height:"92px"},500,function(){c.removeClass("closeclose").addClass("openclose");$(window).resize()})}}});$(".upload-overlay-loading-fix-file .loadingbuttons").bind("click",function(){var a=uploader.getFile($(this).attr("data-id"));if($(this).hasClass("loadingpause")){if(!a||a.status!=plupload.UPLOADING){return}$(this).removeClass("loadingpause");$(this).addClass("loadingresume");PauseUpload()}else{if(!a||a.status==plupload.UPLOADING){return}$(this).removeClass("loadingresume");$(this).addClass("loadingpause");ResumeUpload()}});if(currentsection=="upload-album"){$("#uploadnewalbum").mouseover(function(){$("#uploadnewalbumover").show()});$("#uploadnewalbum").mouseout(function(){$("#uploadnewalbumover").hide()});$(document).on("click","#uploadnewalbum",function(){if($(".uploadalbum").css("display")=="none"){$(".upload2 #log").html("");$(".uploadalbumselected .logalbumelected li").html("");$(".uploadalbumselected").hide();$("#uploadSection").hide();$("#albumlist").val("0");$(".uploadalbumselected .logalbumelected li").css("height","76px");$(".UploadMediaRightTF .ClearNewAlbumButton").click();$(".uploadalbum").show();$(".uploadalbum").animate({height:"407px"},500);$(window).resize()}});$(document).on("click","."+currentlogalbumaddid+" .UploadMediaRightTF .ClearNewAlbumButton",function(){$("."+currentlogalbumaddid+" .inputuploadformTF").val("");$("."+currentlogalbumaddid+" #logalbumaddcountry, ."+currentlogalbumaddid+" #logalbumaddcategory").val("0");$("."+currentlogalbumaddid+" .inputuploaddescriptionTF").val("");var a=$("."+currentlogalbumaddid);$(".uploadinfomandatory span",a).html("");$("textarea[name=description]").blur();$("input[name=placetakenat]").blur();$("input[name=keywords]").blur()});$(document).on("click","."+currentlogalbumaddid+" .UploadMediaRightTF .SaveNewAlbumButton",function(){if(verifyForm(currentlogalbumaddid)){$(".upload-overlay-loading-fix").show();$.post(ReturnLink("/ajax/ajax_addnewalbumupload.php"),{title:getObjectData($("."+currentlogalbumaddid+" input[name=title]")),globchannelid:globchannelid,cityname:$("."+currentlogalbumaddid+" input[name=cityname]").val(),cityid:$("."+currentlogalbumaddid+" input[name=cityname]").attr("data-id"),citynameaccent:$("."+currentlogalbumaddid+" input[name=citynameaccent]").val(),is_public:USER_PRIVACY_PUBLIC,description:getObjectData($("."+currentlogalbumaddid+" textarea[name=description]")),category:$("."+currentlogalbumaddid+" select[name=category] option:selected").val(),placetakenat:getObjectData($("."+currentlogalbumaddid+" input[name=placetakenat]")),keywords:getObjectData($("."+currentlogalbumaddid+" input[name=keywords]")),country:$("."+currentlogalbumaddid+" select[name=country] option:selected").val(),location:$("."+currentlogalbumaddid+" input[name=location]").val()},function(a){if(a!=false){$("#albumlist option:eq(0)").after(a);$(".uploadalbum").hide();$(".uploadalbum").css("height","0px");$("."+currentlogalbumaddid+" .UploadMediaRightTF .ClearNewAlbumButton").click();$("#albumlist").val($("#albumlist option:eq(1)").val());$("#albumlist").change()}})}});$(document).on("click",".uploadalbumselected .UploadMediaRightTF .SaveNewAlbumButton",function(){if(verifyForm("logalbumelected")){$(".upload-overlay-loading-fix-file").show();$.post(ReturnLink("/ajax/ajax_updatealbumupload.php"),{catalog_id:CatalogID(),title:getObjectData($(".logalbumelected input[name=title]")),cityname:$(".logalbumelected input[name=cityname]").val(),cityid:$(".logalbumelected input[name=cityname]").attr("data-id"),citynameaccent:$(".logalbumelected input[name=citynameaccent]").val(),is_public:USER_PRIVACY_PUBLIC,description:getObjectData($(".logalbumelected textarea[name=description]")),category:$(".logalbumelected select[name=category] option:selected").val(),placetakenat:getObjectData($(".logalbumelected input[name=placetakenat]")),keywords:getObjectData($(".logalbumelected input[name=keywords]")),country:$(".logalbumelected select[name=country] option:selected").val(),location:$(".logalbumelected input[name=location]").val()},function(a){if(a!=false){$(".albumuploaddescription").html($(".uploadalbumselected .logalbumelected li").html());$(".albumuploaddescription input[name=title]").val($(".logalbumelected input[name=title]").val());$(".albumuploaddescription textarea[name=description]").val($(".logalbumelected textarea[name=description]").val());$(".albumuploaddescription input[name=keywords]").val($(".logalbumelected input[name=keywords]").val());$(".albumuploaddescription input[name=cityname]").val($(".logalbumelected input[name=cityname]").val());$(".albumuploaddescription input[name=cityname]").attr("data-id",$(".logalbumelected input[name=cityname]").attr("data-id"));$(".albumuploaddescription input[name=citynameaccent]").val($(".logalbumelected input[name=citynameaccent]").val());$(".albumuploaddescription select[name=category]").val($(".logalbumelected select[name=category] option:selected").val());$(".albumuploaddescription select[name=country]").val($(".logalbumelected select[name=country] option:selected").val());$(".albumuploaddescription input[name=placetakenat]").val($(".logalbumelected input[name=placetakenat]").val());$(".albumuploaddescription input[name=location]").val($(".logalbumelected input[name=location]").val());$("#albumlist").find("#"+CatalogID()).html($(".logalbumelected input[name=title]").val());$(".uploadalbumselected .logalbumelected li .formcontainercreatealbum").html(t("ALBUM NAME:")+" "+$(".logalbumelected input[name=title]").val());if($(".uploadalbumselected .uploadinfocheckbox4").hasClass("active")){var b=CopyFormtab2($(".uploadalbumselected"));if(b!=""){$.ajax({url:ReturnLink("/up_savenew.php"),type:"post",data:{S:$("#S").val(),myformarr:b,title:getObjectData($(".logalbumelected input[name=title]")),globchannelid:globchannelid,cityname:$(".logalbumelected input[name=cityname]").val(),cityid:$(".logalbumelected input[name=cityname]").attr("data-id"),citynameaccent:$(".logalbumelected input[name=citynameaccent]").val(),is_public:USER_PRIVACY_PUBLIC,description:getObjectData($(".logalbumelected textarea[name=description]")),catalog_id:CatalogID(),category:$(".logalbumelected select[name=category] option:selected").val(),placetakenat:getObjectData($(".logalbumelected input[name=placetakenat]")),keywords:getObjectData($(".logalbumelected input[name=keywords]")),country:$(".logalbumelected select[name=country] option:selected").val(),location:$(".logalbumelected input[name=location]").val(),defaultcatalogicon:0},success:function(c){if(c!=""){FileUploadSaved()}$(".uploadalbumselected .uploadinfocheckbox_upload").removeClass("active")},error:function(d,e,c){$(".uploadalbumselected .uploadinfocheckbox_upload").removeClass("active")}})}else{$(".uploadalbumselected .uploadinfocheckbox_upload").removeClass("active");$(".upload-overlay-loading-fix-file").hide()}}else{$(".upload-overlay-loading-fix-file").hide()}}})}});$(document).on("click",".uploadalbumselected .togb",function(){var b=$(this);var a=$(this).parent().parent();if(b.hasClass("openclose")){$("div.formcontainer",$(".uploadalbumselected")).show();a.animate({height:"387px"},500,function(){b.removeClass("openclose").addClass("closeclose");$(window).resize()})}else{$("div.formcontainer",$(".uploadalbumselected")).hide();a.animate({height:"76px"},500,function(){b.removeClass("closeclose").addClass("openclose");$(window).resize()})}});$(document).on("click",".uploadalbumselected .ClearNewAlbumButton",function(){var a=$(this).parent().parent().parent().parent().parent().find(".licorner").find(".togb");a.click()})}$(document).on("mouseover",".openclose",function(){$(this).find(".openclose_overtxt").html(t("expand"))});$(document).on("mouseover",".closeclose",function(){$(this).find(".openclose_overtxt").html(t("collapse"))});$(document).on("click",".uploadinfocheckbox_upload",function(){if($(this).hasClass("active")){$(this).removeClass("active");if($(this).hasClass("uploadinfocheckbox4")){$(".upload2 #log li").each(function(){$(this).find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").hide();$(this).find(".licorner .togb").show();$(this).find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").removeClass("active")})}else{if($(this).hasClass("uploadinfocheckbox3")){$(this).parent().parent().parent().find(".togb").show()}else{if($(this).hasClass("uploadinfocheckbox4")){$(".upload2 #log li").each(function(){$(this).find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").hide();$(this).find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").removeClass("active");$(this).find(".licorner .togb").show()})}}}}else{if($(this).hasClass("uploadinfocheckbox4")){TTAlert({msg:t("All checked entries are taking now the same description. You can uncheck the entry for which another description applies."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});var a=$(this).parent().parent().parent().parent().parent().attr("id");$(".upload2 #log li").each(function(){if($(this).find(".togb").css("display")!="none"){if($(this).attr("id")!=a){var c=$(this).find(".togb.closeclose");c.click();$(this).find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").addClass("active");$(this).find(".uploadinfocheckboxcontainer .uploadinfocheckbox4").removeClass("active");$(this).find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").show();$(this).find(".licorner .togb").hide()}else{$(this).find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").hide();$(this).find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").addClass("active")}}})}else{if($(this).hasClass("uploadinfocheckbox3")){var b=$(this).parent().parent().parent().find(".togb.closeclose");b.click();$(this).parent().parent().parent().find(".togb").hide();$(this).addClass("active")}}$(this).addClass("active")}});$(document).on("click",".UploadMediaRightTF .LaterButton",function(){var a=$(this).closest("li");if(formIsFilled(a)){updatePicDataLater(a)}else{if(currentsection=="upload-album"&&a.find(".uploadinfocheckbox1").hasClass("active")){updatePicDataLater(a)}else{a.remove();removeCheckBoxSameDescription()}}TTAlert({msg:t("To view this photo or video check your pending list."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})});if((typeof currentsection==="undefined")||(currentsection!=="upload-album")){InitUploader()}if(parseInt(txt_id)!=0&&txt_id!=""&&currentsection=="upload-album"){$("#albumlist").val($("#albumlist #"+txt_id).val());$("#albumlist").change()}});var MAX_AUTO_RETRY=3;function InitUploader(){if(uploader!==null){return}uploader=new plupload.Uploader({runtimes:"html5,flash",browse_button:"button1",button_browse_hover:true,max_file_size:ServerMaxFileSize+"mb",container:"MiddleInsideNormal",drop_element:"MiddleInsideNormal",url:ReturnLink("/upload-file2.php"),flash_swf_url:ReturnLink("/js/plupload/plupload.flash.swf"),silverlight_xap_url:ReturnLink("/js/plupload/plupload.silverlight.xap"),multipart_params:{S:$("#S").val(),catalog_id:CatalogID(),globchannelid:globchannelid},filters:[{title:"All media files",extensions:"jpg,gif,png,tiff,tif,bmp,jpeg,wmv,mov,flv,mp4,avi,mts,m4v"},{title:"Image files",extensions:"jpg,gif,png,tiff,tif,bmp,jpeg"},{title:"Video files",extensions:"wmv,mov,flv,mp4,avi,mts,m4v"}],init:a});uploader.bind("Init",function(c,b){if((b.runtime=="flash")&&!swfobject.hasFlashPlayerVersion("10")){requirements_met=false;TTAlert({msg:t("Please update your flash installation to at least version 10"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});$("#flash_err").show();$("#InsideNormal").hide()}});uploader.init();function a(b){b.bind("FilesAdded",function(d,c){$.each(c,function(g,f){var e=f.id;countfileupload++;$(".upload-loading-txt-file").html(t("loading")+" "+countfileuploadnumber+t(" of ")+countfileupload)});$(".upload-loading-txt-file").html(t("loading")+" "+countfileuploadnumber+t(" of ")+countfileupload);d.settings.multipart_params={S:$("#S").val(),catalog_id:CatalogID(),globchannelid:globchannelid};if(!requirements_met){TTAlert({msg:t("Please update your flash installation to at least version 10"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return false}if(pausemode!=1){setTimeout(function(){ResumeUpload()},100)}});b.bind("UploadFile",function(e,d){var c=d.id;if(c==$(".upload-loading-txt-file").attr("data-id")){return}countfileuploadnumber++;$(".upload-loading-txt-file").attr("data-id",c);$(".upload-loading-txt-file").html(t("loading")+" "+countfileuploadnumber+t(" of ")+countfileupload);$(".upload-loading-txt-file").show();$(".stop_all_upload").show();$(".upload-loading-sep").show();createImage(d,c);upload_started=1;SetPageLeave();$("#SWFUpload_2_"+c+" .pause").show();$("#log li#SWFUpload_2_"+c+" span.status").html(t("Uploading ...")+" 0%")});b.bind("UploadProgress",function(e,d){var c=d.id;$("#log li#SWFUpload_2_"+c).find("div.progress").css("width",d.percent+"%");$("#log li#SWFUpload_2_"+c).find("div.progress").css("background-color","#f0bf1b");$("#log li#SWFUpload_2_"+c+" span.status").html(t("Uploading ...")+" "+d.percent+"%")});b.bind("Error",function(d,c){if(c.code==-600){TTAlert({msg:c.message+"<br/>maximum size: "+ServerMaxFileSize+"mb",type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{if(c.code==-601){TTAlert({msg:"File extension error, Please use: jpg,gif,png,tiff,tif,bmp,jpeg,wmv,mov,flv,mp4,avi,mts,m4v",type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{if(c.file&&c.file.name){TTAlert({msg:t("Error: ")+c.file.name+" "+c.message,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{TTAlert({msg:t("Error: ")+c.message,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}}if(c.file&&c.file.name){ShowError(c.file,t("Error uploading file: "+c.file.name+". Please try again later."))}else{ShowError(c.file,t("Couldn't Process Request. Please try again later."))}b.refresh()});b.bind("FileUploaded",function(j,e,h){upload_started=0;SetPageLeave();var d=e.id;var f=$("#log li#SWFUpload_2_"+d);var g;try{g=$.parseJSON(h.response)}catch(c){if(e&&e.name){ShowError(e,t("Error uploading file: "+e.name+". Please try again later."))}else{ShowError(e,t("Couldn't Process Request. Please try again later."))}return}if(g.status!="ok"){if(!e.failed){e.failed=1}else{e.failed++}if(e.failed==MAX_AUTO_RETRY){ShowError(e,g.msg)}else{e.status=plupload.QUEUED}}else{f.find("div.progress").css({width:"100%","background-color":"#73c563","background-image":"none"});f.addClass("success").find("span.status").html('<span class="status2">'+t("Upload Complete")+" 100%</span>"+g.msg);FileUploadCompleted(d);showHideSameDescription();var i=$("#SWFUpload_2_"+d+" input[name=vthumb]").val();$("#SWFUpload_2_"+d+" .stanleft .stanleftin").html('<img src="'+AbsolutePath+"/"+i+'" width="86" height="48">');$("#SWFUpload_2_"+d+" .SaveButton").removeAttr("disabled");$("#SWFUpload_2_"+d+" .stanleft .stanleftin").css("background","none");$("#SWFUpload_2_"+d+" .togb").show();if(countfileupload==countfileuploadnumber){if(!$(".upload2 #log li").find(".togb").hasClass("closeclose")){$(".upload2 #log li").first().find(".togb").click()}countfileupload=countfileuploadnumber=0;$(".upload-loading-txt-file").hide();$(".stop_all_upload").hide();$(".upload-loading-sep").hide()}}})}}function setDragElement(c,a,d,b){}var global_catalog_id=null;function CatalogID(a){if(typeof a=="undefined"){return global_catalog_id}else{global_catalog_id=a}}function doalbumdatadisplay(b){var a=parseInt($(b).val());boolloderappear=false;if(a!=0){$(".upload-overlay-loading-fix").show();$(".upload2 #log").html("");$(".uploadalbum").hide();$(".uploadalbum").css("height","0px");$("."+currentlogalbumaddid+" .UploadMediaRightTF .ClearNewAlbumButton").click();$("div.formcontainer",$(".uploadalbumselected")).hide();$(".uploadalbumselected .logalbumelected li").animate({height:"76px"},500,function(){$(".uploadalbumselected .logalbumelected li .togb").removeClass("closeclose").addClass("openclose");$(window).resize()});CatalogID(a);$.post(ReturnLink("/ajax/ajax_getalbumuploaddata_channel.php"),{id:a},function(c){if(c!=false){$(".uploadalbumselected .logalbumelected li").html(c);$(".uploadalbumselected .logalbumelected li textarea[name=description]").blur();$(".uploadalbumselected .logalbumelected li input[name=placetakenat]").blur();$(".uploadalbumselected .logalbumelected li input[name=keywords]").blur();addAutoComplete("logalbumelected");$(".uploadalbumselected").show();$("#uploadSection").show();$(".upload-overlay-loading-fix").hide();boolloderappear=true;$(".albumuploaddescription").html($(".uploadalbumselected .logalbumelected li").html());InitUploader()}})}}function getImagesAlbum(){$(".upload-overlay-loading-fix").show();$.post(ReturnLink("/ajax/ajax_getalbumuploaddatapics.php"),{id:CatalogID()},function(a){if(a!=false){$(".getalbumuploaddatapics").html(a);if(boolloderappear){$(".upload-overlay-loading-fix").hide()}boolloderappear=true}})}function CopyForm(d){var a=new Array();var b="";if(currentsection=="upload-album"){d.find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").addClass("active");if(d.find(".uploadinfocheckbox1").hasClass("active")){d.find(".tableform input[name=title]").val($(".albumuploaddescription input[name=title]").val());d.find(".tableform input[name=cityname]").val($(".albumuploaddescription input[name=cityname]").val());d.find(".tableform input[name=cityname]").attr("data-id",$(".albumuploaddescription input[name=cityname]").attr("data-id"));d.find(".tableform input[name=citynameaccent]").val($(".albumuploaddescription input[name=citynameaccent]").val());d.find(".tableform textarea[name=description]").val($(".albumuploaddescription textarea[name=description]").val());d.find(".tableform input[name=placetakenat]").val($(".albumuploaddescription input[name=placetakenat]").val());d.find(".tableform input[name=keywords]").val($(".albumuploaddescription input[name=keywords]").val());d.find(".tableform input[name=location]").val($(".albumuploaddescription input[name=location]").val());d.find(".tableform select[name=category]").val($(".albumuploaddescription select[name=category] option:selected").val());d.find(".tableform select[name=country]").val($(".albumuploaddescription select[name=country] option:selected").val())}var e="#"+d.attr("id");var c=$(e+" input[name=vName]").val()+"[*]"+$(e+" input[name=vPath]").val()+"[*]"+$(e+" input[name=vSize]").val()+"[*]"+$(e+" input[name=lattitude]").val()+"[*]"+$(e+" input[name=longitude]").val()+"[*]"+$(e+" input[name=vid]").val()+"[*]"+e;a.push(c);b=a.join("/*/")}return b}function CopyFormtab2(c){var a=new Array();var b="";if(currentsection=="upload-album"){c.find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").addClass("active");if(c.find(".uploadinfocheckbox4").hasClass("active")){c.find(".tableform .showthumblink_album").remove()}$(".upload2 #log li .licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3.active").each(function(){var e="#"+$(this).parent().parent().parent().attr("id");var d=$(e+" input[name=vName]").val()+"[*]"+$(e+" input[name=vPath]").val()+"[*]"+$(e+" input[name=vSize]").val()+"[*]"+$(e+" input[name=lattitude]").val()+"[*]"+$(e+" input[name=longitude]").val()+"[*]"+$(e+" input[name=vid]").val()+"[*]"+e;a.push(d)});b=a.join("/*/")}return b}function CopyFormtab1(c){var a=new Array();var b="";if(currentsection!="upload-album"){c.find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").addClass("active");if(c.find(".uploadinfocheckbox4").hasClass("active")){c.find(".tableform .showthumblink_album").remove()}$(".upload2 #log li .licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3.active").each(function(){var e="#"+$(this).parent().parent().parent().attr("id");var d=$(e+" input[name=vName]").val()+"[*]"+$(e+" input[name=vPath]").val()+"[*]"+$(e+" input[name=vSize]").val()+"[*]"+$(e+" input[name=lattitude]").val()+"[*]"+$(e+" input[name=longitude]").val()+"[*]"+$(e+" input[name=vid]").val()+"[*]"+e;a.push(d)});b=a.join("/*/")}return b}function formIsFilled(a){var b=false;if(getObjectData($("input[name=title]",a))!=""){b=true}else{if(getObjectData($("input[name=citynameaccent]",a))!=""){b=true}else{if(getObjectData($("textarea[name=description]",a))!=""){b=true}else{if(getObjectData($("input[name=placetakenat]",a))!=""){b=true}else{if(getObjectData($("input[name=keywords]",a))!=""){b=true}else{if(getObjectData($("select[name=category]",a))!="0"){b=true}}}}}}return b}function removeCheckBoxSameDescription(){if(currentsection!="upload-album"){$(".upload2 #log li").each(function(){if($(this).find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").css("display")!="none"){var a=$(this).find(".togb");a.show()}$(this).find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").hide();$(this).find(".licorner .uploadinfocheckboxAllcontainer .uploadinfocheckbox3").removeClass("active")})}}function updatePicDataLater(d){var c=CopyFormLater(d);var b=d.find(".tableform");var f=USER_PRIVACY_PUBLIC;var e="";var a=CatalogID();if(currentsection=="upload"&&d.find(".catalog_class").length>0){a=d.find(".catalog_class").val()}$(".upload-overlay-loading-fix").show();var g="#"+d.attr("id");$.post(ReturnLink("/ajax/up_savelater.php"),{myformarr:c,filename:$(g+" input[name=vName]").val(),catalog_id:a,privacyValue:f,privacyArray:e},function(h){d.remove();removeCheckBoxSameDescription();$(".upload-overlay-loading-fix").hide()})}function CopyFormLater(b){var a="";if(currentsection=="upload-album"){if(b.find(".uploadinfocheckbox1").hasClass("active")){b.find(".tableform input[name=title]").val($(".albumuploaddescription input[name=title]").val());b.find(".tableform input[name=cityname]").val($(".albumuploaddescription input[name=cityname]").val());b.find(".tableform input[name=cityname]").attr("data-id",$(".albumuploaddescription input[name=cityname]").attr("data-id"));b.find(".tableform input[name=citynameaccent]").val($(".albumuploaddescription input[name=citynameaccent]").val());b.find(".tableform textarea[name=description]").val($(".albumuploaddescription textarea[name=description]").val());b.find(".tableform input[name=placetakenat]").val($(".albumuploaddescription input[name=placetakenat]").val());b.find(".tableform input[name=keywords]").val($(".albumuploaddescription input[name=keywords]").val());b.find(".tableform input[name=location]").val($(".albumuploaddescription input[name=location]").val());b.find(".tableform select[name=category]").val($(".albumuploaddescription select[name=category] option:selected").val());b.find(".tableform select[name=country]").val($(".albumuploaddescription select[name=country] option:selected").val())}}var c="#"+b.attr("id");var a=getObjectData($(c+" input[name=title]"));a+="[*]"+getObjectData($(c+" textarea[name=description]"));a+="[*]"+getObjectData($(c+" input[name=keywords]"));a+="[*]"+$(c+" select[name=category] option:selected").val();a+="[*]"+$(c+" select[name=country] option:selected").val();a+="[*]"+$(c+" input[name=cityname]").val();a+="[*]"+$(c+" input[name=citynameaccent]").val();a+="[*]"+getObjectData($(c+" input[name=placetakenat]"))+"[*]";a+=($(c+" .uploadinfocheckbox2").hasClass("active"))?1:0;a+="[*]"+$(c+" input[name=cityname]").attr("data-id");return a}function showHideSameDescription(){if(currentsection=="upload-album"){if($("#log li.success").length>0){$(".uploadinfocheckbox4").show()}else{$(".uploadinfocheckbox4").hide()}}else{if($("#log li.success").length>1){$(".uploadinfocheckbox4").show()}else{$(".uploadinfocheckbox4").hide()}}};