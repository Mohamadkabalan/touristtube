(function(f){function g(i,k){var h=typeof i[k];return h==="function"||!!(h=="object"&&i[k])||h=="unknown"}function j(i,k,h){if(k<0){k+=i.value.length}if(typeof h=="undefined"){h=k}if(h<0){h+=i.value.length}return{start:k,end:h}}function c(){return typeof document.body=="object"&&document.body?document.body:document.getElementsByTagName("body")[0]}var b,a,v,d,w,x,y,z,e;f(document).ready(function(){function h(k,l){return function(){var m=this.jquery?this[0]:this,n=m.nodeName.toLowerCase();if(m.nodeType==1&&(n=="textarea"||n=="input"&&m.type=="text")){m=[m].concat(Array.prototype.slice.call(arguments));m=k.apply(this,m);if(!l){return m}}if(l){return this}}}var i=document.createElement("textarea");c().appendChild(i);if(typeof i.selectionStart!="undefined"&&typeof i.selectionEnd!="undefined"){b=function(k){return{start:k.selectionStart,end:k.selectionEnd,length:k.selectionEnd-k.selectionStart,text:k.value.slice(k.selectionStart,k.selectionEnd)}};a=function(k,l,m){l=j(k,l,m);k.selectionStart=l.start;k.selectionEnd=l.end};e=function(k,l){if(l){k.selectionEnd=k.selectionStart}else{k.selectionStart=k.selectionEnd}}}else{if(g(i,"createTextRange")&&typeof document.selection=="object"&&document.selection&&g(document.selection,"createRange")){b=function(k){var l=0,m=0,n,o,p;if((p=document.selection.createRange())&&p.parentElement()==k){o=k.value.length;n=k.value.replace(/\r\n/g,"\n");m=k.createTextRange();m.moveToBookmark(p.getBookmark());p=k.createTextRange();p.collapse(false);if(m.compareEndPoints("StartToEnd",p)>-1){l=m=o}else{l=-m.moveStart("character",-o);l+=n.slice(0,l).split("\n").length-1;if(m.compareEndPoints("EndToEnd",p)>-1){m=o}else{m=-m.moveEnd("character",-o);m+=n.slice(0,m).split("\n").length-1}}}return{start:l,end:m,length:m-l,text:k.value.slice(l,m)}};a=function(k,l,m){l=j(k,l,m);m=k.createTextRange();var n=l.start-(k.value.slice(0,l.start).split("\r\n").length-1);m.collapse(true);if(l.start==l.end){m.move("character",n)}else{m.moveEnd("character",l.end-(k.value.slice(0,l.end).split("\r\n").length-1));m.moveStart("character",n)}m.select()};e=function(k,l){var m=document.selection.createRange();m.collapse(l);m.select()}}else{c().removeChild(i);window.console&&window.console.log&&window.console.log("TextInputs module for Rangy not supported in your browser. Reason: No means of finding text input caret position");return}}c().removeChild(i);d=function(k,l,m,n){var o;if(l!=m){o=k.value;k.value=o.slice(0,l)+o.slice(m)}n&&a(k,l,l)};v=function(k){var l=b(k);d(k,l.start,l.end,true)};z=function(k){var l=b(k),m;if(l.start!=l.end){m=k.value;k.value=m.slice(0,l.start)+m.slice(l.end)}a(k,l.start,l.start);return l.text};w=function(k,l,m,n){var o=k.value;k.value=o.slice(0,m)+l+o.slice(m);if(n){l=m+l.length;a(k,l,l)}};x=function(k,l){var m=b(k),n=k.value;k.value=n.slice(0,m.start)+l+n.slice(m.end);m=m.start+l.length;a(k,m,m)};y=function(k,l,m){var n=b(k),o=k.value;k.value=o.slice(0,n.start)+l+n.text+m+o.slice(n.end);l=n.start+l.length;a(k,l,l+n.length)};f.fn.extend({getSelection:h(b,false),setSelection:h(a,true),collapseSelection:h(e,true),deleteSelectedText:h(v,true),deleteText:h(d,true),extractSelectedText:h(z,false),insertText:h(w,true),replaceSelectedText:h(x,true),surroundSelectedText:h(y,true)})})})(jQuery);