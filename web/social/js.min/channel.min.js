var category_id=0;var channel_category_page=0;var old_channel_category_page=0;function GetDIVheight(e){var a=e.find(".MediaList li").height();var b=e.find(".MediaList li").length;var c=retieveNumber(b/4);var d=(c*a)+30;return d}function GetDIVheightHome(e){var a=e.find(".MediaList li").height();var b=e.find(".MediaList li").length;var c=retieveNumber(b/5);var d=(c*a)+30;return d}function InitDocument(){$(".closeSign.hide").mouseover(function(){var a=$(".evContainer2Over").parent();var b=$(this).offset().left-a.offset().left-253;var c=$(this).offset().top-a.offset().top-23;$(".evContainer2Over .ProfileHeaderOverin").html("hide");$(".evContainer2Over").css("left",b+"px");$(".evContainer2Over").css("top",c+"px");$(".evContainer2Over").stop().show()});$(".closeSign.hide").mouseout(function(){$(".evContainer2Over").hide()});$(".image").each(function(){var a=$(this);var b=a.find(".hide");a.mouseenter(function(){b.removeClass("hide");b.addClass("show")}).mouseleave(function(){b.removeClass("show");b.addClass("hide")})});$(".plusSign").each(function(){var a=$(this);var b=a.parent().find(".popUp");a.click(function(){pagetype=a.attr("data-pagetype");var e=a.parent().index();var c="popUpLeft";var d=a.attr("data-display");if(d){if(((e+1)%4)==0||((e+1)%4)==3){c="popUpRight"}}else{if(((e+1)%5)==0||((e+1)%5)==4){c="popUpRight"}}b.removeClass("popUpLeft");b.removeClass("popUpRight");b.addClass(c);$(".popUp").hide();$(".plusSign").show();b.show();a.hide();objectSelected=a.parent()})});$(".minus").each(function(){var a=$(this);var c=a.parent();var b=a.parent().parent().find(".plusSign");a.click(function(){objectSelected="";c.hide();b.show()})});initPhotoFancy()}function scrollToDiv(a){$(".upload-overlay-loading-fix").show();$("#scrollableChannel").html("");category_id=a;channel_category_page=0;old_channel_category_page=0;$(".load_more_channels").hide();$.ajax({url:ReturnLink("/ajax/morechannelcategory.php"),data:{start:0,id:a},type:"post",success:function(c){if(c!=""){$("#scrollableChannel").append(c);var b=$("#scrollableChannel .currPageStatus");if((""+b.attr("data-value"))=="0"){$(".load_more_channels").hide()}else{$(".load_more_channels").show()}b.remove();InitDocument()}else{$(".load_more_channels").show()}$(".upload-overlay-loading-fix").hide()}})}function InitContainer(c,a,e){var d=c.length;var b=0;if(d<=3){b=700}else{b=d*e}a.height(b)}function showChannelNumber(d){var e=d.width();var a=d.find("a").width()+5;var b=d.find("div.channelnumber");var c=b.width();b.css({left:a}).show()}$(document).ready(function(){InitDocument();$(document).on("click",".closeSign",function(){var a=$(this);var f=a.closest("li");var d=a.attr("data-flag");var g=$("#"+d).attr("data-number");var c=$("#"+d).attr("data-channelid");var b=$("#"+d).attr("data-catId");var e=1;f.remove();$(".upload-overlay-loading-fix").show();$(".evContainer2Over").hide();$.ajax({url:ReturnLink("/ajax/morechannel.php"),data:{flag:d,start:g,limit:e,channelid:c,catId:b},type:"post",success:function(h){if(h!=""){g++;$("#"+d).attr("data-number",g);$("#"+d+" ul").append(h);if(parseInt(g+1)>parseInt(a.attr("data-number"))){$(".load_more_channels_category").hide()}InitDocument()}$(".upload-overlay-loading-fix").hide()}})});$(document).on("click",".Expand",function(){var a=$(this);var c=a.parent();var b=parseInt(c.attr("data-count"));MeidaHeight=GetDIVheight(c);if(a.hasClass("ExpandHome")){var b=c.find(".MediaList li").length;MeidaHeight=GetDIVheightHome(c);if(b>5){if(a.hasClass("Collapse")){c.stop().animate({height:"150px"},500,function(){a.removeClass("Collapse")})}else{c.stop().animate({height:MeidaHeight+"px"},500,function(){a.addClass("Collapse")})}}}else{if(b>4){$(".MediaCont").each(function(e,d){var f=$(this);if(f.find(".Expand").hasClass("Collapse")){f.stop().animate({height:"150px"},500,function(){f.find(".Expand").removeClass("Collapse")})}});if(c.find(".Expand").hasClass("Collapse")){c.stop().animate({height:"150px"},500,function(){c.find(".Expand").removeClass("Collapse")})}else{if(!a.hasClass("active")){getChannelDataRelated(c)}else{c.stop().animate({height:MeidaHeight+"px"},500,function(){c.find(".Expand").addClass("Collapse")})}}}}});$(".load_more_channels").click(function(a){a.preventDefault();a.stopImmediatePropagation();channel_category_page++;getChannelCategoryRelated()});$(".load_more_channels_category").click(function(b){b.preventDefault();b.stopImmediatePropagation();channel_category_page++;var a=$(this).attr("data-id");getChannelCategoryItems(a)});$(".load_more_channels_recently_added").click(function(b){b.preventDefault();b.stopImmediatePropagation();channel_category_page++;var a=$(this).attr("data-id");getChannelRecentlyAdded(a)});$(".load_more_channels_search").click(function(a){a.preventDefault();a.stopImmediatePropagation();channel_category_page++;getChannelsearched()});$(document).on("click",".addNewBut",function(){var a=$(this);var d=a.parent().parent();var c="";var b=parseInt(a.attr("data-value"));switch(b){case 1:c='<div class="formContainer100 margintop10 linksin" data-value="1"><input name="customizedlinks" id="customizedlinks" type="text" class="RegFocus" style="width:176px; float:left;" value="" data-id=""/><div class="removeNewBut"><div class="addNewBut_over"><div class="addNewBut_overtxt">'+t("remove links")+"</div></div></div></div>";break;case 2:c='<div class="formContainer100 margintop10 linksin" data-value="2"><input name="sociallinks" id="sociallinks" type="text" class="RegFocus" style="width:176px; float:left;" value="" data-id=""/><div class="removeNewBut"><div class="addNewBut_over"><div class="addNewBut_overtxt">'+t("remove links")+"</div></div></div></div>";break}d.append(c)});$(document).on("click",".removeNewBut",function(){var a=$(this).parent();var b=parseInt(a.attr("data-value"));switch(b){case 1:removechannelpagedatalinks(a.find("#customizedlinks").attr("data-id"),a);break;case 2:removechannelpagedatalinks(a.find("#sociallinks").attr("data-id"),a);break}});$(".editChannelRight_data1").click(function(){if(!$(this).hasClass("active")){$(".butEditChannelRight_data_toreset").removeClass("active");var a=$(this).parent();getchannelpagedata(a)}});$(".editChannelRight_data2").click(function(){if(!$(this).hasClass("active")){var b=$(this).parent();var a=b.find(".more");if($(".mustopen").height()>200){a.click()}getchannelpagedata(b)}});$(".editChannelRight_data3").click(function(){if(!$(this).hasClass("active")){$(".butEditChannelRight_data_toreset").removeClass("active");var a=$(this);getchannelpagedata(a)}});$(".editChannelRight_data4").click(function(){if(!$(this).hasClass("active")){var a=$(this);getchannelpagedata(a)}});$(document).on("click",".editChannelRight_data1_buts1",function(){var a=$(this).parent().parent().parent();a.hide();a.html("");$(".editChannelRight_data1").removeClass("active")});$(document).on("click",".info_close1",function(){$(".editChannelRight_data1_buts1").click()});$(document).on("click",".editChannelRight_data3_buts1",function(){var a=$(this).parent().parent().parent();a.hide();a.html("");$(".editChannelRight_data3").removeClass("active")});$(document).on("click",".info_close3",function(){$(".editChannelRight_data3_buts1").click()});$(document).on("click",".editChannelRight_data4_buts1",function(){var a=$(this).parent().parent().parent();a.hide();a.html("");$(".editChannelRight_data4").removeClass("active")});$(document).on("click",".editChannelRight_data1_buts2",function(){var a=$(this).parent().parent().parent();var b=""+$("#edit_data_container1 select[name=ccategory]").val();var e=""+$("#edit_data_container1 select[name=ccountry]").val();var c=""+$("#edit_data_container1 input[name=ccity]").val();var d=""+$("#edit_data_container1 input[name=ccity]").attr("data-id");var h=""+$("#edit_data_container1 input[name=cstreet]").val();var j=""+$("#edit_data_container1 input[name=czip]").val();var f=""+$("#edit_data_container1 input[name=cphone]").val();var i=""+$("#edit_data_container1 input[name=curl]").val();var g=""+$("#edit_data_container1 input[name=createdon]").val();var l=(a.find(".uploadinfocheckbox1").hasClass("active"))?1:0;var k=(a.find(".uploadinfocheckbox2").hasClass("active"))?1:0;var m=(a.find(".uploadinfocheckbox3").hasClass("active"))?1:0;if(checkChannelInfo(b,e,j,c,i)){$(".upload-overlay-loading-fix").show();$.ajax({url:ReturnLink("/ajax/info_manage_channel_home.php"),data:{globchannelid:globchannelid,ccategory:b,ccountry:e,ccityid:d,ccity:c,cstreet:h,czip:j,cphone:f,curl:i,createdon:g,hidecreatedon:l,hidecreatedby:k,hidelocation:m},type:"post",success:function(n){var p=null;$(".upload-overlay-loading-fix").hide();try{p=$.parseJSON(n)}catch(o){return}if(!p){TTAlert({msg:t("couldnt save please try again later"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(p.status=="ok"){$(".ChannelRight_data1_content").html(p.content);$(".editChannelRight_data1_buts1").click()}else{TTAlert({msg:p.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})}});$(document).on("click",".editChannelRight_data3_buts2",function(){var a=$(this).parent().parent().parent();var b=""+$("#edit_data_container1 input[name=cname]").val();var c=new Array();var d="";var e=a.find(".customizedcontainer .linksin");e.each(function(){var h=$(this).find("#customizedlinks").val();if(h.length!=0&&ValidURL(h)){c.push(h)}});if(c.length>0){d=c.join("/*/")}var f=new Array();var g="";var e=a.find(".socialcontainer .linksin");e.each(function(){var h=$(this).find("#sociallinks").val();if(h.length!=0&&ValidURL(h)){f.push(h)}});if(f.length>0){g=f.join("/*/")}if(checkChannelNameInfo(b)){$(".upload-overlay-loading-fix").show();$.ajax({url:ReturnLink("/ajax/info_link_manage_channel_home.php"),data:{globchannelid:globchannelid,cname:b,customlinkArraystr:d,sociallinkArraystr:g},type:"post",success:function(h){$(".upload-overlay-loading-fix").hide();var j=null;try{j=$.parseJSON(h)}catch(i){return}if(!j){TTAlert({msg:t("couldnt save please try again later"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(j.status=="ok"){$("#HeaderRight #TitleContainer").html(b);$("#HeaderRight #ChannelSettings").attr("title",b);$("#HeaderRight #LogoContainer img").attr("alt",b);$("#SocialMediaBTN .socialcarousel ul").html(j.content);if($("#SocialMediaBTN .socialcarousel ul li").length>5){$("#SocialMediaBTN .next_btn").removeClass("disabled")}else{$("#SocialMediaBTN .next_btn").addClass("disabled")}$("#SocialMediaBTN .prev_btn").addClass("disabled");InitCarouselLinks();$(".editChannelRight_data3_buts1").click()}else{TTAlert({msg:j.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})}});$(document).on("click",".editChannelRight_data2_buts1",function(){var a=$(this).parent().parent();a.find("#edit_data_container2").hide();a.find(".editChannelRight_button_container").hide();a.find(".butEditChannelRight_data").removeClass("active")});$(document).on("click",".editChannelRight_data2_buts2",function(){var a=$(this).parent().parent();if(a.find("#edit_aboutchannel").val()!=""){updatechannelpagedata("aboutchannel",a.find("#edit_aboutchannel").val(),a)}});$(document).on("click",".editChannelRight_data4_buts2",function(){var a=$(this).parent().parent();updatechannelpagedata("changeslogan",getObjectData(a.find("#slogan_txt")),a)});$(".IndexCategory").each(function(){var a=$(this);a.mouseover(function(){$(".channelnumber").hide();showChannelNumber(a);var b=a.position();if($("a",a).hasClass("active")){return}$("#CategoryMarker").show().css({top:(b.top)+"px",left:"-1px"})}).mouseout(function(){$("#CategoryMarker").hide();$(".channelnumber").hide()}).click(function(){var b=a.position();$("a",".IndexCategory").removeClass("active");$("a",a).addClass("active");$("#CategoryMarker").hide();$("#Categories .marker").removeClass("selected");a.next(".marker").addClass("selected").css({top:(b.top)+"px",left:"0px"})})})});function getchannelpagedata(a){$(".upload-overlay-loading-fix").show();var b=a.attr("id");$.ajax({url:ReturnLink("/ajax/info_page_data_manage_channel_home.php?no_cache="+Math.random()),data:{globchannelid:globchannelid,data:b},type:"post",cache:false,success:function(c){var d=""+c;switch(b){case"ChannelRight_data1":$("#edit_data_container1").html(d);$("#edit_data_container1").show();initCreatedOn();addAutoCompleteList("edit_data_container1");a.find(".butEditChannelRight_data").addClass("active");break;case"ChannelRight_data2":case"AboutContid":a.find("#edit_data_container2 #edit_aboutchannel").val(d);a.find("#edit_data_container2").show();a.find(".editChannelRight_button_container").show();a.find(".butEditChannelRight_data").addClass("active");break;case"editChannelRight_data3":$("#edit_data_container1").html(d);$("#edit_data_container1").show();a.addClass("active");break;case"editChannelRight_data4":$("#edit_data_container4").html(d);$("#slogan_txt").blur();$("#edit_data_container4").show();a.addClass("active");break}$(".upload-overlay-loading-fix").hide()}})}function updatechannelpagedata(b,c,a){$(".upload-overlay-loading-fix").show();$.ajax({url:ReturnLink("/ajax/info_page_manage_channel.php"),data:{globchannelid:globchannelid,data:c,str:b},type:"post",success:function(d){$(".upload-overlay-loading-fix").hide();var g=null;try{g=$.parseJSON(d)}catch(e){return}if(!g){TTAlert({msg:t("Couldnt save please try again later"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(g.status=="ok"){switch(b){case"aboutchannel":var f=c;f=f.replace(/\n/g,"<br />");if(a.hasClass("AboutCont")){a.find(".stanTXT").html(f)}else{a.find(".stanTXT").html('<span class="yellow bold font12 yellowabout">'+t("ABOUT")+"</span><br/> "+f)}if($("#stanTXT").height()<=105){$("#more").hide()}else{$("#more").show()}a.find(".editChannelRight_data2_buts1").click();break;case"profilepicchannel":case"coverpicchannel":document.location.reload();break;case"changeslogan":$(".Slogan").html(c);if(c!=""){a.find(".editChannelRight_data4_buts1").click()}break}}else{TTAlert({msg:g.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})}function initCreatedOn(){Calendar.setup({inputField:"createdon",noScroll:true,trigger:"createdon",align:"B",onSelect:function(a){var b=a.selection.get();if(b){b=Calendar.intToDate(b);$("#createdon").attr("data-cal",Calendar.printDate(b,"%Y-%m-%d"))}this.hide()},disabled:function(b){var a=new Date();a.setHours(12,30,0,0);return(b>a)},dateFormat:"%d / %m / %Y"})}function addAutoCompleteList(b){var a=$("input[name=ccity]",$("#"+b));a.autocomplete({appendTo:"#edit_data_container1",search:function(e,f){var c=$("#ccountry");var d=c.val();if(d=="ZZ"){c.addClass("err");e.preventDefault()}else{a.autocomplete("option","source",ReturnLink("/ajax/uploadGetCities.php?cc="+d))}},select:function(c,d){a.val(d.item.value);a.attr("data-id",d.item.id);c.preventDefault()}})}function checkChannelInfo(a,c,e,b,d){$("#edit_data_container1 input").removeClass("InputErr");$("#edit_data_container1 select").removeClass("InputErr");$("#edit_data_container1 .errorclass").html("");var f=0;if($("#czip_ttlogo").css("display")!="none"){f=1}if(a==0){$("#edit_data_container1 .errorclass").html(t("Please select category"));$("#edit_data_container1 select[name=ccategory]").addClass("InputErr");return false}else{if(c==0){$("#edit_data_container1 .errorclass").html(t("Please select country"));$("#edit_data_container1 select[name=ccountry]").addClass("InputErr");return false}else{if(b.length==0&&f==1){$("#edit_data_container1 .errorclass").html(t("Please enter a valid zip code"));$("#edit_data_container1 input[name=ccity]").addClass("InputErr");return false}else{if(!ValidURL(d)&&d!=""){$("#edit_data_container1 .errorclass").html(t("Please enter a valid url"));$("#edit_data_container1 input[name=curl]").addClass("InputErr");return false}}}}return true}function checkChannelNameInfo(a){$("#edit_data_container1 input").removeClass("InputErr");$("#edit_data_container1 .errorclass").html("");if(a.length==0){$("#edit_data_container1 .errorclass").html(t("Invalid channel name"));$("#edit_data_container1 input[name=cname]").addClass("InputErr");return false}return true}function removechannelpagedatalinks(b,a){if(b==""){a.remove();return}$(".upload-overlay-loading-fix").show();$.ajax({url:ReturnLink("/ajax/info_page_links_delete_manage_channel.php"),data:{globchannelid:globchannelid,id:b},type:"post",success:function(c){$(".upload-overlay-loading-fix").hide();var e=null;try{e=$.parseJSON(c)}catch(d){return}if(!e){TTAlert({msg:t("couldnt save please try again later"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if(e.status=="ok"){a.remove()}else{TTAlert({msg:e.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}}})}function updateImage(d,c,a){if(a=="editChannelRight_data5"){var b=ReturnLink("/media/channel/"+globchannelid+"/"+c);if($("#HeaderImage .channelAvatarLink").length>0){$("#LogoContainer .channelAvatarLink img").remove();$("#LogoContainer .channelAvatarLink").append(d);$("#LogoContainer .channelAvatarLink").attr("href",b)}else{$("#LogoContainer img").remove();$("#LogoContainer").append(d)}updatechannelpagedata("profilepicchannel",c)}else{if(a=="editChannelRight_data6"){var b=ReturnLink("/media/channel/"+globchannelid+"/"+c);if($("#HeaderImage .channelAvatarLink").length>0){$("#HeaderImage .channelAvatarLink img").remove();$("#HeaderImage .channelAvatarLink").append(d);$("#HeaderImage .channelAvatarLink").attr("href",b)}else{$("#HeaderImage img").remove();$("#HeaderImage").append(d)}updatechannelpagedata("coverpicchannel",c)}}closeFancyBox()}function getMediaDataRelated(){var a="";if(pagetype=="v"){a="MediaVideo"}else{if(pagetype=="i"){a="MediaImage"}else{a="MediaAlbum"}}var c=parseInt($("#"+a).attr("data-number"))-1;var b=1;$(".upload-overlay-loading-fix").show();$.ajax({url:ReturnLink("/ajax/morechannel.php"),data:{flag:a,start:c,limit:b,channelid:globchannelid},type:"post",success:function(d){if(d!=""){c++;$("#"+a).attr("data-number",c);$("#"+a+" ul").append(d);InitDocument()}$(".upload-overlay-loading-fix").hide()}})}function getChannelCategoryRelated(){$(".upload-overlay-loading-fix").show();$.ajax({url:ReturnLink("/ajax/morechannelcategory.php"),data:{start:channel_category_page,id:category_id},type:"post",success:function(b){if(b!=""){$("#scrollableChannel").append(b);var a=$("#scrollableChannel .currPageStatus");if((""+a.attr("data-value"))=="0"){$(".load_more_channels").hide()}else{$(".load_more_channels").show()}a.remove();InitDocument()}else{$(".load_more_channels").show()}$(".upload-overlay-loading-fix").hide()}})}function getChannelDataRelated(b){var a=b.attr("id");var c=parseInt(b.find(".ListAll").attr("data-number"));$(".upload-overlay-loading-fix").show();$.ajax({url:ReturnLink("/ajax/morechanneldata.php"),data:{catId:a,start:c},type:"post",success:function(d){if(d!=""){b.find(".ListAll ul").append(d);var f=b.find(".ListAll ul li").length-4+c;b.find(".ListAll").attr("data-number",f);b.find(".Expand").addClass("active");var e=b.find(".MediaList li").length;MeidaHeight=GetDIVheight(b);if(e>4){b.stop().animate({height:MeidaHeight+"px"},500,function(){b.find(".Expand").addClass("Collapse")})}InitDocument()}$(".upload-overlay-loading-fix").hide()}})}function getChannelCategoryItems(a){var b=parseInt($("#ChannelBox .ListAll").attr("data-number"));var c=(b-(old_channel_category_page+1)*32);$(".upload-overlay-loading-fix").show();$.ajax({url:ReturnLink("/ajax/morechannelitem.php"),data:{start:channel_category_page,catId:a,skip:c},type:"post",success:function(e){if(e!=""){$("#ChannelBox ul").append(e);var f=$("#ChannelBox .ListAll ul li").length+c;$("#ChannelBox .ListAll").attr("data-number",f);var d=$("#ChannelBox .currPageStatus");if((""+d.attr("data-value"))=="0"){$(".load_more_channels_category").hide()}else{$(".load_more_channels_category").show()}d.remove();InitDocument();old_channel_category_page=channel_category_page}else{$(".load_more_channels_category").show()}$(".upload-overlay-loading-fix").hide()}})}function getChannelRecentlyAdded(a){var b=parseInt($("#ChannelBox .ListAll").attr("data-number"));var c=(b-(old_channel_category_page+1)*32);$(".upload-overlay-loading-fix").show();$.ajax({url:ReturnLink("/ajax/morechannelrecentlyaddeds.php"),data:{start:channel_category_page,catId:a,skip:c},type:"post",success:function(e){if(e!=""){$("#ChannelBox ul").append(e);var f=$("#ChannelBox .ListAll ul li").length+c;$("#ChannelBox .ListAll").attr("data-number",f);var d=$("#ChannelBox .currPageStatus");if((""+d.attr("data-value"))=="0"){$(".load_more_channels_recently_added").hide()}else{$(".load_more_channels_recently_added").show()}d.remove();InitDocument();old_channel_category_page=channel_category_page}else{$(".load_more_channels_recently_added").show()}$(".upload-overlay-loading-fix").hide()}})}function getChannelsearched(){$(".upload-overlay-loading-fix").show();var d=$(".load_more_channels_search").attr("data-page");var a=$(".load_more_channels_search").attr("data-c");var b=$(".load_more_channels_search").attr("data-co");var e=$(".load_more_channels_search").attr("data-t");$.ajax({url:ReturnLink("/ajax/morechannelsearchitem.php"),data:{page:d,c:a,t:e,co:b},type:"post",success:function(f){if(f!=""){$("#MiddelMainChannel ul").append(f);var c=$("#MiddelMainChannel .currPageStatus");if((c.attr("data-value"))=="0"){$(".load_more_channels_search").hide()}else{d++;$(".load_more_channels_search").attr("data-page",d).show()}c.remove();InitDocument()}else{$(".load_more_channels_search").show()}$(".upload-overlay-loading-fix").hide()}})};