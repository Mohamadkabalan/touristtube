(function(A,a,z){a.infinitescroll=function c(D,B,C){this.element=a(C);if(!this._create(D,B)){this.failed=true}};a.infinitescroll.defaults={loading:{finished:z,finishedMsg:"<em>Congratulations, you've reached the end of the internet.</em>",img:"http://www.infinite-scroll.com/loading.gif",msg:null,msgText:"<em>Loading the next set of posts...</em>",selector:null,speed:"fast",start:z},state:{isDuringAjax:false,isInvalidPage:false,isDestroyed:false,isDone:false,isPaused:false,currPage:1},callback:z,debug:false,behavior:z,binder:a(A),nextSelector:"div.navigation a:first",navSelector:"div.navigation",contentSelector:null,extraScrollPx:150,itemSelector:"div.post",animate:false,pathParse:z,dataType:"html",appendCallback:true,bufferPx:40,errorCallback:function(){},infid:0,pixelsFromNavToBottom:z,path:z};a.infinitescroll.prototype={_binding:function e(B){var C=this,D=C.options;D.v="2.0b2.111027";if(!!D.behavior&&this["_binding_"+D.behavior]!==z){this["_binding_"+D.behavior].call(this);return}if(B!=="bind"&&B!=="unbind"){this._debug("Binding value  "+B+" not valid");return false}if(B=="unbind"){(this.options.binder).unbind("smartscroll.infscr."+C.options.infid)}else{(this.options.binder)[B]("smartscroll.infscr."+C.options.infid,function(){C.scroll()})}this._debug("Binding",B)},_create:function f(C,B){var D=a.extend(true,{},a.infinitescroll.defaults,C);if(!this._validate(C)){return false}this.options=D;var E=a(D.nextSelector).attr("href");if(!E){this._debug("Navigation selector not found");return false}D.path=this._determinepath(E);D.contentSelector=D.contentSelector||this.element;D.loading.selector=D.loading.selector||D.contentSelector;D.loading.msg=a('<div id="infscr-loading"><img alt="Loading..." src="'+D.loading.img+'" /><div>'+D.loading.msgText+"</div></div>");(new Image()).src=D.loading.img;D.pixelsFromNavToBottom=a(document).height()-a(D.navSelector).offset().top;D.loading.start=D.loading.start||function(){a(D.navSelector).hide();D.loading.msg.appendTo(D.loading.selector).show(D.loading.speed,function(){beginAjax(D)})};D.loading.finished=D.loading.finished||function(){D.loading.msg.fadeOut("normal")};D.callback=function(G,F){if(!!D.behavior&&G["_callback_"+D.behavior]!==z){G["_callback_"+D.behavior].call(a(D.contentSelector)[0],F)}if(B){B.call(a(D.contentSelector)[0],F,D)}};this._setup();return true},_debug:function g(){if(this.options&&this.options.debug){return A.console&&console.log.call(console,arguments)}},_determinepath:function i(C){var B=this.options;if(!!B.behavior&&this["_determinepath_"+B.behavior]!==z){this["_determinepath_"+B.behavior].call(this,C);return}if(!!B.pathParse){this._debug("pathParse manual");return B.pathParse(C,this.options.state.currPage+1)}else{if(C.match(/^(.*?)\b2\b(.*?$)/)){C=C.match(/^(.*?)\b2\b(.*?$)/).slice(1)}else{if(C.match(/^(.*?)2(.*?$)/)){if(C.match(/^(.*?page=)2(\/.*|$)/)){C=C.match(/^(.*?page=)2(\/.*|$)/).slice(1);return C}C=C.match(/^(.*?)2(.*?$)/).slice(1)}else{if(C.match(/^(.*?page=)1(\/.*|$)/)){C=C.match(/^(.*?page=)1(\/.*|$)/).slice(1);return C}else{this._debug("Sorry, we couldn't parse your Next (Previous Posts) URL. Verify your the css selector points to the correct A tag. If you still get this error: yell, scream, and kindly ask for help at infinite-scroll.com.");B.state.isInvalidPage=true}}}}this._debug("determinePath",C);return C},_error:function j(C){var B=this.options;if(!!B.behavior&&this["_error_"+B.behavior]!==z){this["_error_"+B.behavior].call(this,C);return}if(C!=="destroy"&&C!=="end"){C="unknown"}this._debug("Error",C);if(C=="end"){this._showdonemsg()}B.state.isDone=true;B.state.currPage=1;B.state.isPaused=false;this._binding("unbind")},_loadcallback:function l(B,E){var G=this.options,C=this.options.callback,H=(G.state.isDone)?"done":(!G.appendCallback)?"no-append":"append",F;if(!!G.behavior&&this["_loadcallback_"+G.behavior]!==z){this["_loadcallback_"+G.behavior].call(this,B,E);return}switch(H){case"done":this._showdonemsg();return false;break;case"no-append":if(G.dataType=="html"){E="<div>"+E+"</div>";E=a(E).find(G.itemSelector)}break;case"append":var D=B.children();if(D.length==0){return this._error("end")}F=document.createDocumentFragment();while(B[0].firstChild){F.appendChild(B[0].firstChild)}this._debug("contentSelector",a(G.contentSelector)[0]);a(G.contentSelector)[0].appendChild(F);E=D.get();break}G.loading.finished.call(a(G.contentSelector)[0],G);if(G.animate){var I=a(A).scrollTop()+a("#infscr-loading").height()+G.extraScrollPx+"px";a("html,body").animate({scrollTop:I},800,function(){G.state.isDuringAjax=false})}if(!G.animate){G.state.isDuringAjax=false}C(this,E)},_nearbottom:function m(){var B=this.options,C=0+a(document).height()-(B.binder.scrollTop())-a(A).height();if(!!B.behavior&&this["_nearbottom_"+B.behavior]!==z){return this["_nearbottom_"+B.behavior].call(this)}this._debug("math:",C,B.pixelsFromNavToBottom);return(C-B.bufferPx<B.pixelsFromNavToBottom)},_pausing:function p(C){var B=this.options;if(!!B.behavior&&this["_pausing_"+B.behavior]!==z){this["_pausing_"+B.behavior].call(this,C);return}if(C!=="pause"&&C!=="resume"&&C!==null){this._debug("Invalid argument. Toggling pause value instead")}C=(C&&(C=="pause"||C=="resume"))?C:"toggle";switch(C){case"pause":B.state.isPaused=true;break;case"resume":B.state.isPaused=false;break;case"toggle":B.state.isPaused=!B.state.isPaused;break}this._debug("Paused",B.state.isPaused);return false},_setup:function t(){var B=this.options;if(!!B.behavior&&this["_setup_"+B.behavior]!==z){this["_setup_"+B.behavior].call(this);return}this._binding("bind");return false},_showdonemsg:function u(){var B=this.options;if(!!B.behavior&&this["_showdonemsg_"+B.behavior]!==z){this["_showdonemsg_"+B.behavior].call(this);return}B.loading.msg.find("img").hide().parent().find("div").html(B.loading.finishedMsg).animate({opacity:1},2000,function(){a(this).parent().fadeOut("normal")});B.errorCallback.call(a(B.contentSelector)[0],"done")},_validate:function x(C){for(var B in C){if(B.indexOf&&B.indexOf("Selector")>-1&&a(C[B]).length===0){this._debug("Your "+B+" found no elements.");return false}}return true},bind:function d(){this._binding("bind")},destroy:function h(){this.options.state.isDestroyed=true;return this._error("destroy")},pause:function o(){this._pausing("pause")},resume:function q(){this._pausing("resume")},retrieve:function r(K){var H=this,J=H.options,L=J.path,B,E,D,I,C,K=K||null,F=(!!K)?K:J.state.currPage;beginAjax=function G(N){N.state.currPage++;H._debug("heading into ajax",L);B=a(N.contentSelector).is("table")?a("<tbody/>"):a("<div/>");D=L.join(N.state.currPage);I=(N.dataType=="html"||N.dataType=="json")?N.dataType:"html+callback";if(N.appendCallback&&N.dataType=="html"){I+="+callback"}switch(I){case"html+callback":H._debug("Using HTML via .load() method");B.load(D+" "+N.itemSelector,null,function M(O){H._loadcallback(B,O)});break;case"html":case"json":H._debug("Using "+(I.toUpperCase())+" via $.ajax() method");a.ajax({url:D,dataType:N.dataType,complete:function M(O,P){C=(typeof(O.isResolved)!=="undefined")?(O.isResolved()):(P==="success"||P==="notmodified");(C)?H._loadcallback(B,O.responseText):H._error("end")}});break}};if(!!J.behavior&&this["retrieve_"+J.behavior]!==z){this["retrieve_"+J.behavior].call(this,K);return}if(J.state.isDestroyed){this._debug("Instance is destroyed");return false}J.state.isDuringAjax=true;J.loading.start.call(a(J.contentSelector)[0],J)},scroll:function s(){var B=this.options,C=B.state;if(!!B.behavior&&this["scroll_"+B.behavior]!==z){this["scroll_"+B.behavior].call(this);return}if(C.isDuringAjax||C.isInvalidPage||C.isDone||C.isDestroyed||C.isPaused){return}if(!this._nearbottom()){return}this.retrieve()},toggle:function v(){this._pausing()},unbind:function w(){this._binding("unbind")},update:function n(B){if(a.isPlainObject(B)){this.options=a.extend(true,this.options,B)}}};a.fn.infinitescroll=function k(D,C){var E=typeof D;switch(E){case"string":var B=Array.prototype.slice.call(arguments,1);this.each(function(){var F=a.data(this,"infinitescroll");if(!F){return false}if(!a.isFunction(F[D])||D.charAt(0)==="_"){return false}F[D].apply(F,B)});break;case"object":this.each(function(){var F=a.data(this,"infinitescroll");if(F){F.update(D)}else{F=new a.infinitescroll(D,C,this);if(!F.failed){a.data(this,"infinitescroll",F)}}});break}return this};var b=a.event,y;b.special.smartscroll={setup:function(){a(this).bind("scroll",b.special.smartscroll.handler)},teardown:function(){a(this).unbind("scroll",b.special.smartscroll.handler)},handler:function(D,E){var C=this,B=arguments;D.type="smartscroll";if(y){clearTimeout(y)}y=setTimeout(function(){a.event.handle.apply(C,B)},E==="execAsap"?0:100)}};a.fn.smartscroll=function(B){return B?this.bind("smartscroll",B):this.trigger("smartscroll",["execAsap"])}})(window,jQuery);