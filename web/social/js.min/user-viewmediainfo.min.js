var privacyValue=-1;var privacyArray=new Array();var $modal_image=null;var $modal_content_container=null;$(document).ready(function(b){$modal_content_container=$("#imgInside").parent();$modal_image=$("#imgInside");$(".exportVideo").on("click",function(){if(checkArray(SelectionArray)!=0){$(".save-thumb").hide();$(".delThumbs").hide();$(".save-thumb-separator").hide();$(".save-thumb-message").show();var e=$(".exportVideo").attr("data-post");$.post(ReturnLink("/ajax/ajax_edit_video.php"),{frames:SelectionArray,allf:AllFrames,id:$(".all_container").attr("data-id"),is_post:e},function(f){SelectionArray=[];if(e){parent.window.closeFancyExportVideo()}else{parent.window.closeFancyExportVideo($(".all_container").attr("data-export"))}})}});$(document).on("click",".imageitem",function(){$this=$(this).find(".thumb-pic-img");var f=$this.attr("rel");var e=f-1;if(!$this.hasClass("selected")){$(this).find(".yellowborder").addClass("active");$this.addClass("selected");if(jQuery.inArray(f,SelectionArray)==-1){SelectionArray[e]=f}$(".delThumbs").addClass("active")}else{$(this).find(".yellowborder").removeClass("active");$this.removeClass("selected");SelectionArray[e]="";var g=true;$(".yellowborder.active").each(function(){if($(this).closest(".imageitem").css("display")!="none"){g=false}});if(g){$(".delThumbs").removeClass("active")}else{$(".delThumbs").addClass("active")}}});$(".delThumbs").on("click",function(){DeletedArray=[];$(".imageitem .thumb-pic-img").each(function(){var e=$(this).attr("rel");if(jQuery.inArray(e,SelectionArray)!=-1){$(this).parent().css("display","none");DeletedArray.push(e)}});if(DeletedArray.length!=0){$(".undoThumbs").css("display","block")}$(".delThumbs").removeClass("active");updateReintialiseslider()});$(".undoThumbs").on("click",function(){SelectionArray=[];$(".imageitem .thumb-pic-img").each(function(){var e=$(this).attr("rel");if(jQuery.inArray(e,DeletedArray)!=-1){$(this).parent().css("display","block");$(this).next().removeClass("active")}});$(".imageitem .thumb-pic-img").removeClass("selected");updateReintialiseslider()});$(".edit_input").blur();addAutoCompleteList();if(parseInt(channelid)==0){addmoreusersautocomplete_custom_journal($("#addmoretext_custum_privacy_detailed"))}$(document).on("click",".top_arrow",function(){$(".hidden_buttons").toggle()});$(document).on("click",".overdatabutenable",function(){var e=$(this);var f=$(".all_container").attr("data-id");var g=$(".all_container").attr("data-type");if(String(""+e.attr("data-status"))=="1"){enableSharesComments_log(f,g,0);e.attr("data-status","0");e.find(".overdatabutntficon").addClass("inactive")}else{enableSharesComments_log(f,g,1);e.attr("data-status","1");e.find(".overdatabutntficon").removeClass("inactive")}});$(document).on("click","#canceleventdata",function(){$(".error_valid_privacy").html("");parent.window.closeFancy()});$(document).on("click","#add_but",function(){parent.window.addMediaUpload($(".all_container").attr("data-upuri"))});$(document).on("click","#remove_button",function(){parent.window.addMediaRemove($(".all_container").attr("data-link"))});$(document).on("click","#cancel_custom_privacy",function(){$(".error_valid_privacy").html("");$(".peoplecontainer_custom").addClass("displaynone");$(".info_pop_container").show()});function d(h){var g=true;var e=$("#"+h).find("#edit_info_part");$(".uploadinfomandatory span",e).html("");$("input,select,textarea",e).removeClass("err").each(function(){var j=$(this).attr("name");var i=$(this).parent();if((j=="location")||(j=="location_name")||(j=="placetakenat")||(j=="cityname")||(j=="status")||(j=="vid")||$(this).hasClass("filevalue")||(j=="filename")||(j=="addmoretext")||(j=="vpath")){}else{if(($(".uploadinfomandatory"+j,i).css("display")!="none"&&getObjectData($(this))=="")||(j=="category"&&!$(".uploadinfomandatorycategory",i).hasClass("inactive")&&$(this).val()=="0")||(j=="country"&&!$(".uploadinfomandatorycountry",i).hasClass("inactive")&&$(this).val()=="0")){$(".uploadinfomandatory"+j+" span",i).html(t("please fill this field correctly"));g=false}}});var f=$("input[name=cityname]",e).parent();if(getObjectData($("input[name=cityname]",e))==""&&!$(".uploadinfomandatorycitynameaccent",f).hasClass("inactive")&&$("input[name=cityname]",e).length>0){$(".uploadinfomandatorycitynameaccent span",f).html(t("please fill this field correctly"));g=false}if(!g){return false}else{return true}}$(document).on("click","#savepostdata_edit",function(){var i=$("#edit_post_text").val();var f=$("#edit_post_link").val();var g=$("#edit_post_location").attr("data-location");var h=$("#edit_post_location").attr("data-lng");var e=$("#edit_post_location").attr("data-lat");if(i===""&&f===""&&g===""){$("#edit_post_validate").show();return}if(parseInt(channelid)==0){privacyValue=parseInt($(".privacyclass.active").attr("data-value"))}else{privacyValue=USER_PRIVACY_PUBLIC}if((privacyValue==USER_PRIVACY_SELECTED&&privacyArray.length==0)){$(".error_valid").html(t("Invalid privacy data"));return}$.post(ReturnLink("/ajax/post_edit.php"),{privacyValue:privacyValue,privacyArray:privacyArray,post_id:$(".all_container").attr("data-id"),post_text:i,locationPost:g,linkPost:f,longitude:h,latitude:e,is_post:1},function(j){if(j.status==="ok"){console.log(j);parent.window.closeFancyReload(0)}else{TTAlert({msg:j.msg,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}})});$(document).on("click","#saveeventdata_edit",function(){var g="right_container";if(verifyFormList(g)){var f=$(this).closest("#right_container");if(parseInt(channelid)==0){privacyValue=parseInt($(".privacyclass.active").attr("data-value"))}else{privacyValue=USER_PRIVACY_PUBLIC}if((privacyValue==USER_PRIVACY_SELECTED&&privacyArray.length==0)){$(".error_valid").html(t("Invalid privacy data"));return}var e=$(this);$.post(ReturnLink("/ajax/profile_media_save.php"),{privacyValue:privacyValue,privacyArray:privacyArray,vid:$(".all_container").attr("data-id"),title:getObjectData($("#edit_title")),cityname:$("#edit_cityname").val(),cityid:$("#edit_cityname").attr("data-id"),citynameaccent:$("#edit_citynameaccent").val(),is_public:$(".privacyclass.active").attr("data-value"),description:getObjectData($("#edit_description")),category:$("#edit_category").val(),placetakenat:getObjectData($("#edit_placetakenat")),keywords:getObjectData($("#edit_keywords")),country:$("#edit_country").val(),album:$("#edit_album").val(),location:""},function(h){if(h!=false){parent.window.closeFancyReload(is_album)}})}});$(document).on("click","#photo_but",function(){if(!$(this).hasClass("active")){$(this).addClass("active");$("#info_but").removeClass("active");$("#edit_info_part").hide();$("#edit_photo_part").show()}});$(document).on("click","#info_but",function(){if(!$(this).hasClass("active")){$(this).addClass("active");$("#photo_but").removeClass("active");$("#edit_info_part").show();$("#edit_photo_part").hide()}});$(document).on("click","#okeventdata",function(){var e=$(this).parent().parent();$(".error_valid_privacy").html("");privacyValue=parseInt($(".privacyclass.active").attr("data-value"));privacyArray=new Array();if(privacyValue==USER_PRIVACY_SELECTED){e.find(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var f=$(this);if(f.attr("id")=="friendsdata"){privacyArray.push({friends:1})}else{if(f.attr("id")=="friends_of_friends_data"){privacyArray.push({friends_of_friends:1})}else{if(f.attr("id")=="followersdata"){privacyArray.push({followers:1})}else{if(parseInt(f.attr("data-id"))!=0){privacyArray.push({id:f.attr("data-id")})}}}}})}if((privacyValue==USER_PRIVACY_SELECTED&&privacyArray.length>0)||privacyValue!=USER_PRIVACY_SELECTED){$(".peoplecontainer_custom").addClass("displaynone");$(".info_pop_container").show()}else{$(".error_valid_privacy").html(t("Invalid privacy data"))}});$(document).on("click",".privacyclass",function(){$(".privacyclass",$(this).parent().parent()).removeClass("active");$(this).addClass("active");var f=parseInt($(this).attr("data-value"));var e=$("#right_container");$(".uploadinfomandatory span",e).html("");switch(f){case USER_PRIVACY_PRIVATE:initResetSelectedUsers($(this).closest(".tableform").find(".peoplecontainer_custom"));$(".peoplecontainer_custom").addClass("displaynone");$(".info_pop_container").show();$(".uploadinfomandatory",e).addClass("inactive");$(".uploadinfomandatorytitle",e).removeClass("inactive");break;case USER_PRIVACY_SELECTED:$(this).closest(".tableform").find(".peoplecontainer_custom").show();$(".peoplecontainer_custom").removeClass("displaynone");$(".info_pop_container").hide();$(".uploadinfomandatory",e).addClass("inactive");$(".uploadinfomandatorytitle",e).removeClass("inactive");$(".uploadinfomandatorycategory",e).removeClass("inactive");$(".uploadinfomandatorycountry",e).removeClass("inactive");$(".uploadinfomandatorycitynameaccent",e).removeClass("inactive");break;default:initResetSelectedUsers($(this).closest(".tableform").find(".peoplecontainer_custom"));$(".peoplecontainer_custom").addClass("displaynone");$(".info_pop_container").show();$(".uploadinfomandatory",e).addClass("inactive");$(".uploadinfomandatorytitle",e).removeClass("inactive");$(".uploadinfomandatorycategory",e).removeClass("inactive");$(".uploadinfomandatorycountry",e).removeClass("inactive");$(".uploadinfomandatorycitynameaccent",e).removeClass("inactive");break}});$(document).on("click",".peoplesdataclose",function(){var e=$(this).parent();var f=e.parent().parent();e.remove();if(e.attr("data-id")!=""){SelectedUsersDelete(e.attr("data-id"),f.find(".addmore input"))}if(e.attr("id")=="friendsdata"){f.find(".uploadinfocheckbox3").removeClass("active")}else{if(e.attr("id")=="friends_of_friends_data"){f.find(".uploadinfocheckbox_friends_of_friends").removeClass("active")}else{if(e.attr("id")=="followersdata"){f.find(".uploadinfocheckbox4").removeClass("active")}}}});$(document).on("click",".uploadinfocheckbox",function(){if($(this).hasClass("active")){$(this).removeClass("active");if($(this).hasClass("uploadinfocheckbox3")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#friendsdata").remove()}}else{if($(this).hasClass("uploadinfocheckbox_friends_of_friends")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#friends_of_friends_data").remove()}}else{if($(this).hasClass("uploadinfocheckbox4")){if($(this).parent().hasClass("friendscontainer")){$(this).parent().parent().find("#followersdata").remove()}}}}}else{if($(this).hasClass("uploadinfocheckbox3")){if($(this).parent().hasClass("friendscontainer")){var f='<div class="peoplesdata formttl13" id="friendsdata" data-email="" data-id=""><div class="peoplesdatainside">'+t("friends")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(f)}}else{if($(this).hasClass("uploadinfocheckbox_friends_of_friends")){if($(this).parent().hasClass("friendscontainer")){var e='<div class="peoplesdata formttl13" id="friends_of_friends_data" data-email="" data-id=""><div class="peoplesdatainside">'+t("friends of friends")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(e)}}else{if($(this).hasClass("uploadinfocheckbox4")){if($(this).parent().hasClass("friendscontainer")){var e='<div class="peoplesdata formttl13" id="followersdata" data-email="" data-id=""><div class="peoplesdatainside">'+t("followers")+'</div><div class="peoplesdataclose"></div></div>';$(this).parent().parent().find(".emailcontainer div:eq(0)").after(e)}}}}$(this).addClass("active")}});$(document).on("click","#chk-constrain",function(){if($("#chk-constrain").hasClass("active")){$(this).removeClass("active");$(this).parent().attr("title","Activate Constraint")}else{$(this).addClass("active");$(this).parent().attr("title","Deactivate Constraint")}});var c=parseInt($("#right_container").attr("data-value"));$("#privacyclass_user"+c).click();if(c==USER_PRIVACY_SELECTED){$("#right_container").find(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var e=$(this);if(e.attr("id")=="friendsdata"){}else{if(e.attr("id")=="friends_of_friends_data"){}else{if(e.attr("id")=="followersdata"){}else{if(parseInt(e.attr("data-id"))!=0){SelectedUsersAdd(e.attr("data-id"))}}}}})}if(parseInt(channelid)==0){privacyValue=parseInt($(".privacyclass.active").attr("data-value"))}else{privacyValue=USER_PRIVACY_PUBLIC;var a=$("#right_container");$(".peoplecontainer_custom").addClass("displaynone");$(".info_pop_container").show();$(".uploadinfomandatory",a).addClass("inactive");$(".uploadinfomandatorytitle",a).removeClass("inactive");$(".uploadinfomandatorycategory",a).removeClass("inactive");$(".uploadinfomandatorycountry",a).removeClass("inactive");$(".uploadinfomandatorycitynameaccent",a).removeClass("inactive")}privacyArray=new Array();if(privacyValue==USER_PRIVACY_SELECTED){$(".peoplecontainer_custom .emailcontainer .peoplesdata").each(function(){var e=$(this);if(e.attr("id")=="friendsdata"){privacyArray.push({friends:1})}else{if(e.attr("id")=="friends_of_friends_data"){privacyArray.push({friends_of_friends:1})}else{if(e.attr("id")=="followersdata"){privacyArray.push({followers:1})}else{if(parseInt(e.attr("data-id"))!=0){privacyArray.push({id:e.attr("data-id")})}}}}})}});function verifyFormList(d){var c=true;var a=$("#"+d).find("#edit_info_part");$(".uploadinfomandatory span",a).html("");$("input,select,textarea",a).removeClass("err").each(function(){var f=$(this).attr("name");var e=$(this).parent();if((f=="location")||(f=="location_name")||(f=="placetakenat")||(f=="cityname")||(f=="status")||(f=="vid")||$(this).hasClass("filevalue")||(f=="filename")||(f=="addmoretext")||(f=="vpath")){}else{if(($(".uploadinfomandatory"+f,e).css("display")!="none"&&getObjectData($(this))=="")||(f=="category"&&!$(".uploadinfomandatorycategory",e).hasClass("inactive")&&$(this).val()=="0")||(f=="country"&&!$(".uploadinfomandatorycountry",e).hasClass("inactive")&&$(this).val()=="0")){$(".uploadinfomandatory"+f+" span",e).html(t("please fill this field correctly"));c=false}}});var b=$("input[name=cityname]",a).parent();if(getObjectData($("input[name=cityname]",a))==""&&!$(".uploadinfomandatorycitynameaccent",b).hasClass("inactive")&&$("input[name=cityname]",a).length>0){$(".uploadinfomandatorycitynameaccent span",b).html(t("please fill this field correctly"));c=false}if(!c){return false}else{return true}}function initResetSelectedUsers(a){a.hide();resetSelectedUsers(a.find(".addmore input"));a.find(".uploadinfocheckbox").removeClass("active");a.find(".addmore input").val("");a.find(".addmore input").blur();a.find(".peoplesdata").each(function(){var b=$(this);b.remove()})}function enableSharesComments_log(a,b,c){$.ajax({url:ReturnLink("/ajax/info_log_updatesharescomments.php"),data:{entity_id:a,entity_type:b,new_status:c,globchannelid:channelGlobalID()},type:"post",success:function(d){}})}function addAutoCompleteList(){var a=$("#edit_citynameaccent");a.autocomplete({appendTo:"#right_container",search:function(d,e){var b=$("select[name=country]",a.parent()).removeClass("err");var c=$("option:selected",b).val();if(c=="ZZ"){b.addClass("err");d.preventDefault()}else{a.autocomplete("option","source",ReturnLink("/ajax/uploadGetCities.php?cc="+c))}},select:function(b,c){a.val(c.item.value);$("input[name=cityname]",a.parent()).val(c.item.value);$("input[name=cityname]",a.parent()).attr("data-id",c.item.id);b.preventDefault()}})}function updateReintialiseslider(){var c=0;var a=$("#thumb-pic-container .imageitem").each(function(){if($(this).css("display")!="none"){c++}});var e=89;var b=2;var d=((e+b)*c);$("#thumb-pic-container").css("width",d+"px")}function positionHScroller(c){var b=$(".video-thum-slider-bar");var a=$(".video-thum-slider-wrap");var d=a.width()-b.outerWidth(true);b.css({left:d*c-2})}function inBounds(e,a){var b=a.offset();var c=b.left+a.width();var d=b.top+a.height();if((e.pageX<c)&&(e.pageY<d)&&(e.pageX>b.left)&&(e.pageY>b.top)){return true}else{return false}}function inBounds2(e,a){var b=a.offset();var c=b.left+a.width();var d=b.top+a.height();if((e.pageX<c)&&(e.pageX>b.left)){return true}else{return false}}function editReintialiseslider(d,c,a,b){var h=0;var e=0;var f=false;var g=false;var k=Hammer(d.get(0),{drag_vertical:false,drag_horizontal:true,drag_min_distance:5,prevent_default:true,css_hacks:false,transform:false,tap:false,tap_double:false,hold:false}).on("dragstart",function(l){if(inBounds(l.gesture.center,c)){f=true;b.disableSelection()}else{f=false}}).on("dragend",function(l){f=false;h=0;b.enableSelection()});var j=Hammer(b.get(0),{drag_vertical:false,drag_horizontal:true,drag_min_distance:5,prevent_default:true,css_hacks:false,transform:false,tap:false,tap_double:false,hold:false}).on("dragstart",function(l){if(inBounds(l.gesture.center,a)){unbindToVideoThumbs();g=true;b.disableSelection()}else{g=false}}).on("dragend",function(l){setTimeout(function(){bindToVideoThumbs()},300);g=false;h=0;b.enableSelection()});if($("#edit_photo_part").length>0){var i=Hammer($("#edit_photo_part").get(0),{drag_vertical:false,drag_horizontal:true,drag_min_distance:5,prevent_default:false,css_hacks:false,transform:false,tap:false,tap_double:false,hold:false}).on("drag",function(n){var o=n.gesture;if(f&&inBounds2(n.gesture.center,c)){var m;var l=d.css("left");l=parseInt(l.substring(0,l.length-2));if(isNaN(l)){l=0}if(o.direction===Hammer.DIRECTION_LEFT){if(e!==1){h=0}e=1;m=o.distance-h;l-=m;h=o.distance}if(o.direction===Hammer.DIRECTION_RIGHT){if(e!==-1){h=0}e=-1;m=o.distance-h;l+=m;h=o.distance}var q=0;var p=c.outerWidth(true)-d.outerWidth(true)-2;if(l<q){l=q}if(l>p){l=p}var r=0;r=l/p;d.css({position:"absolute",left:l+"px"});a.css({left:r*(b.width()-a.width())})}else{if(g&&inBounds2(n.gesture.center,b)){var m;var l=a.css("left");l=parseInt(l.substring(0,l.length-2));if(isNaN(l)){l=0}if(o.direction===Hammer.DIRECTION_LEFT){if(e!==1){h=0}e=1;m=o.distance-h;l-=m;h=o.distance}if(o.direction===Hammer.DIRECTION_RIGHT){if(e!==-1){h=0}e=-1;m=o.distance-h;l+=m;h=o.distance}var q=b.outerWidth(true)-a.outerWidth(true)-2;var p=0;if(l<q){l=q}if(l>p){l=p}var r=l/q;d.css({position:"absolute",left:r*(c.outerWidth(true)-d.outerWidth(true))+"px"});a.css({left:l+"px"})}}})}else{var i=Hammer($(".video-thum-slider-bar").get(0),{drag_vertical:false,drag_horizontal:true,drag_min_distance:5,prevent_default:false,css_hacks:false,transform:false,tap:false,tap_double:false,hold:false}).on("drag",function(n){var o=n.gesture;if(f&&inBounds2(n.gesture.center,c)){var m;var l=d.css("left");l=parseInt(l.substring(0,l.length-2));if(isNaN(l)){l=0}if(o.direction===Hammer.DIRECTION_LEFT){if(e!==1){h=0}e=1;m=o.distance-h;l-=m;h=o.distance}if(o.direction===Hammer.DIRECTION_RIGHT){if(e!==-1){h=0}e=-1;m=o.distance-h;l+=m;h=o.distance}var q=0;var p=c.outerWidth(true)-d.outerWidth(true)-2;if(l<q){l=q}if(l>p){l=p}var r=0;r=l/p;d.css({position:"absolute",left:l+"px"});a.css({left:r*(b.width()-a.width())})}else{if(g&&inBounds2(n.gesture.center,b)){var m;var l=a.css("left");l=parseInt(l.substring(0,l.length-2));if(isNaN(l)){l=0}if(o.direction===Hammer.DIRECTION_LEFT){if(e!==1){h=0}e=1;m=o.distance-h;l-=m;h=o.distance}if(o.direction===Hammer.DIRECTION_RIGHT){if(e!==-1){h=0}e=-1;m=o.distance-h;l+=m;h=o.distance}var q=b.outerWidth(true)-a.outerWidth(true)-2;var p=0;if(l<q){l=q}if(l>p){l=p}var r=l/q;d.css({position:"absolute",left:r*(c.outerWidth(true)-d.outerWidth(true))+"px"});a.css({left:l+"px"})}}})}c.click(function(l){var p=l.pageX-$(this).offset().left;var q=l.pageY-$(this).offset().top;p=p-d.outerWidth()/2;var n=0;var m=c.width()-d.outerWidth(true)-2;if(p<n){p=n}if(p>m){p=m}var o=0;o=p/m;positionHScroller(o);a.stop().animate({left:o*(b.width()-a.outerWidth())})})};