var map;var TO_CAL;var entity_type_search=0;var fr_txt="";var to_txt="";var MapMarkers=[];var markerTypes=["tuber"];var MyLocation={};var infoWindow;var newff=0;var fullscreenmode=false;var AllMarkerTypes=["tuber","hotel","restaurant"];var ViewModeGeneral=0;var ViewModeDetail=1;var ViewMode=ViewModeGeneral;var ShowPopups=false;var CurrentUID=0;var UI_EVENT=0;function changeFilter(a){$(".footer_container_all").show();if(parseInt($(a).val())==1){if(fullscreenmode){$("html,body").css({overflow:"visible"});$("#BigMap").css({position:"",top:"",left:"",height:"100%",width:"100%"}).detach().prependTo($("#BigMap_up"))}fullscreenmode=false;$("#mapcalendarcontent").show();$(".search_data_container").hide();$(".search_data_container").removeClass("full");$("#BigMap_up").animate({height:"175px"},500,function(){google.maps.event.trigger(map,"resize");map.setCenter(new google.maps.LatLng($("#BigMap_up").attr("data-lat"),$("#BigMap_up").attr("data-log")))})}else{if(parseInt($(a).val())==2){if(fullscreenmode){$("html,body").css({overflow:"visible"});$("#BigMap").css({position:"",top:"",left:"",height:"100%",width:"100%"}).detach().prependTo($("#BigMap_up"))}fullscreenmode=false;$("#mapcalendarcontent").hide();$(".search_data_container").show();$(".search_data_container").removeClass("full");$("#BigMap_up").animate({height:"480px"},500,function(){google.maps.event.trigger(map,"resize");map.setCenter(new google.maps.LatLng($("#BigMap_up").attr("data-lat"),$("#BigMap_up").attr("data-log")))})}else{if($("#chatList").css("display")!="none"){$("#openChatList").click()}fullscreenmode=true;$("#mapcalendarcontent").hide();$(".footer_container_all").hide();$(".search_data_container").addClass("full");$(".search_data_container").show();$("html,body").css({overflow:"hidden"});$("#BigMap").css({position:"fixed",top:"0px",left:"0px",width:"100%",height:"100%","z-index":200}).detach().prependTo($("body"));google.maps.event.trigger(map,"resize");map.setCenter(new google.maps.LatLng($("#BigMap_up").attr("data-lat"),$("#BigMap_up").attr("data-log")))}}}function customRadio(b){var a=$('input[name="'+b+'"]');$(a).each(function(){$(this).wrap("<span class='custom-radio'></span>");if($(this).is(":checked")){$(this).parent().addClass("selected")}});$(a).click(function(){if($(this).is(":checked")){$(this).parent().addClass("selected")}$(a).not(this).each(function(){$(this).parent().removeClass("selected")})})}function chatOnOff(a){if(a==1){$(".chatOffTxt").removeClass("chatActive");$(".chatOnTxt").addClass("chatActive");$("#newsticker").show()}else{$(".chatOnTxt").removeClass("chatActive");$(".chatOffTxt").addClass("chatActive");$("#newsticker").hide()}}function resizePartsContainer(){var d=$(window).width();var c=$(".parts_container_up").width();var b=$(".parts_container").width();var a=(d>b);if(a){$(".parts_container").css("marginLeft","0");$(".parts_container_up").css("width",$(".parts_container").css("width"));$(".prev_btn,.next_btn").hide();count=0}else{$(".parts_container_up").css("width","923px");$(".prev_btn,.next_btn").show()}}$(document).ready(function(){$(window).resize(function(){resizePartsContainer()});$(".incont").css("width",$(".incont_inside").css("width"));$(".parts_container_up").css("width",$(".parts_container").css("width"));$(".parts_container").css("width",$(".parts_container_up").css("width"));$(".parts_container_up").css("width","923px");resizePartsContainer();autocompleteDiscover($("#mapsearchfield"));var c=parseInt($(".incont").css("width"));var a=982;var b=c-a;var d=parseInt($(".incont").css("left"));$(".chatOnTxt").click(function(){chatOnOff(1)});$(".chatOffTxt").click(function(){chatOnOff(0)});$(".hotelsplus").click(function(){var f=$(this);if(f.hasClass("stationBag")){return}var e=$(this).closest(".hotels_cont_inside");var k=e.attr("data-id");var h=""+($("#discoverData").attr("data-country")).toUpperCase();var i=""+($("#discoverData").attr("data-state"));var g=""+($("#discoverData").attr("data-city"));var j=e.attr("data-type");TTCallAPI({what:"/user/bag/add",data:{item_id:k,entity_type:j,data_country:h,data_state:i,data_city:g},callback:function(l){if(l.status==="error"){TTAlert({msg:l.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}$(".bag_count").html(l.count);f.removeClass("hotelsplus");f.addClass("stationBag")}})});$(".hotelsplus_inactive").click(function(){TTAlert({msg:t("you need to have a")+' <a class="black_link" href="'+ReturnLink("/register")+'">'+t("TT account")+"</a> "+t("in order to add items to your bag."),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})});$("#searchCalendarbut").click(function(){if($("#fromtxt").html()==""&&$("#fromtxt").attr("data-cal")==""){TTAlert({msg:t("Invalid date from"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if($("#totxt").html()==""&&$("#totxt").attr("data-cal")==""){TTAlert({msg:t("Invalid date to"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}fr_txt=""+$("#fromtxt").attr("data-cal");to_txt=""+$("#totxt").attr("data-cal");entity_type_search=SOCIAL_ENTITY_EVENTS;getToDoDataRelated()});$(".tt_advisor").click(function(){if($("#fromtxt").html()==""&&$("#fromtxt").attr("data-cal")==""){TTAlert({msg:t("Invalid date from"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}if($("#totxt").html()==""&&$("#totxt").attr("data-cal")==""){TTAlert({msg:t("Invalid date to"),type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null});return}fr_txt=""+$("#fromtxt").attr("data-cal");to_txt=""+$("#totxt").attr("data-cal");var e=""+$("#discoverData").attr("data-bag");if($("#discoverData").attr("data-country")!=""){e+="_"+$("#discoverData").attr("data-country");if($("#discoverData").attr("data-state")!=""){e+="_"+$("#discoverData").attr("data-state")}}window.open(ReturnLink("/planner/"+e+"/"+fr_txt+"/"+to_txt),"_blank")});$(".menu_header_active").click(function(){fr_txt=""+$("#fromtxt").attr("data-cal");to_txt=""+$("#totxt").attr("data-cal");var h=""+$("#discoverData").attr("data-bag");var e=""+($("#discoverData").attr("data-city"));if(e!=""&&e!=0){h+="/C/"+e}if($("#discoverData").attr("data-country")!=""){h+="/CO/"+$("#discoverData").attr("data-country");if($("#discoverData").attr("data-state")!=""){h+="/ST/"+$("#discoverData").attr("data-state")}}var g=h;if(fr_txt!=""){g+="/from/"+fr_txt;if(to_txt!=""){g+="/to/"+to_txt}}var f="";if($(this).attr("data-type")==SOCIAL_ENTITY_LANDMARK){f=ReturnLink("/things-to-do")}else{if($(this).attr("data-type")==SOCIAL_ENTITY_HOTEL){f=ReturnLink("/hotel-search/"+g)}else{if($(this).attr("data-type")==SOCIAL_ENTITY_RESTAURANT){f=ReturnLink("/restaurant-search/"+g)}else{if($(this).attr("data-type")==SOCIAL_ENTITY_CHANNEL){f=ReturnLink("/channel-search/co/"+$("#discoverData").attr("data-country")+"")}}}}if(f!=""){window.open(f,"_blank")}});$(document).on("click",".middle_search_container .search_checkbox",function(){if($(this).hasClass("active")){$(this).removeClass("active")}else{if($(this).hasClass("search_checkbox_all")){$(".middle_search_container .search_checkbox").removeClass("active")}else{$(".middle_search_container .search_checkbox_all").removeClass("active")}$(this).addClass("active")}$(".upload-overlay-loading-fix").show();setTimeout(function(){setMapMarkers(currentmapzoom);$(".upload-overlay-loading-fix").hide()},1000)});$("#activetubers").on("mouseover","img",function(g){if(!$(this).data("title")){$(this).data("title",$(this).attr("title"));$(this).attr("title","")}var j=$(this).data("title");var f=(j!=="")?"<br/>"+j:"";$("body").append("<div id='preview'><img src='"+$(this).attr("data-src")+"' alt='Image preview' style='width: 100px;height: 100px;'/>"+f+"</div>");var i=$(this).offset().top;var h=$(this).offset().left+28;$("#preview").css("top",i+"px").css("left",h+"px").css({position:"absolute",border:"1px solid #ccc",background:"#333","font-size":"12px",padding:"5px",display:"none",color:"#fff","z-index":10000,"text-align":"center"}).fadeIn("fast")}).on("mouseout","img",function(){$("#preview").remove()}).mousemove(function(f){});$(document).on("click","#mapsearchbutton",function(){var h=$("#mapsearchfield").val();var e=""+($("#mapsearchfield").attr("data-code")).toUpperCase();var g=""+($("#mapsearchfield").attr("data-state-code"));var f=parseInt($("#mapsearchfield").attr("data-iscountry"));if(f==0&&e!=""){h+="/"+e;if(parseInt(g)!=0){h+="/"+g}}if(h!=""){window.location.href=ReturnLink("/map/"+h)}});$(".moveright").click(function(){var e=0;if(d<=-b){e=-b}else{if((d-a)<=-b){e=-b}else{e=d-a}}$(".incont").stop().animate({left:e},"6000");d=e});$(".moveleft").click(function(){var e=0;if(d>=0){e=0}else{if((d+a)>=0){e=0}else{e=d+a}}$(".incont").stop().animate({left:e},"6000");d=e});$(".middle_map_items_cont").css("width",$(".middle_map_item").length*227+"px");$(".select3").selectbox();$(".alert_bulb").delay(4000).fadeOut(600);$("#collapsemenu").animate({opacity:"1",},500);$(".things_imgs").animate({opacity:"1",},500);$(function(){$("#vertical-ticker").totemticker({row_height:"46px",next:"#ticker-next",previous:"#ticker-previous",stop:"#stop",start:"#start",mousestop:true,})});$("#things_cont_inside").each(function(){var e=$(this);e.on("click",function(){alert(e)})});$(".map_radio").each(function(){var e=$(this);e.on("click",function(){$(".map_radio").find(".rd-selected").hide();e.find(".rd-selected").show()})});$("#splash").zAccordion({timeout:4500,speed:500,slideClass:"slide",animationStart:function(){document.getElementById("things_header").innerHTML=$("#splash").find("li.slide-open").attr("data-title");$("#splash").find("li.slide-previous div").fadeOut()},animationComplete:function(){$("#splash").find("li.slide-open div").fadeIn()},buildComplete:function(){$("#splash").find("li.slide-closed div").css("display","none");$("#splash").find("li.slide-open div").fadeIn()},startingSlide:0,slideWidth:168,width:280,height:123});InitCalendar()});function InitCalendar(){if($("#fromtxt").length>0){Calendar.setup({inputField:"fromtxt",noScroll:true,trigger:"frombutcontainer",align:"B",onSelect:function(){var a=Calendar.intToDate(this.selection.get());TO_CAL.args.min=a;TO_CAL.redraw();$("#fromtxt").attr("data-cal",Calendar.printDate(a,"%Y-%m-%d"));addCalToEvent(this);this.hide()},dateFormat:"%d / %m / %Y",disabled:function(b){var c=new Date();var a=new Date(c.getFullYear(),c.getMonth(),c.getDate(),0,0,0,0);return(b<a)}});TO_CAL=Calendar.setup({inputField:"totxt",noScroll:true,trigger:"tobutcontainer",align:"B",onSelect:function(){var a=Calendar.intToDate(this.selection.get());$("#totxt").attr("data-cal",Calendar.printDate(a,"%Y-%m-%d"));addCalToEvent(this);this.hide()},dateFormat:"%d / %m / %Y",disabled:function(b){var c=new Date();var a=new Date(c.getFullYear(),c.getMonth(),c.getDate(),0,0,0,0);return(b<a)}})}}function addCalToEvent(a){if(new Date($("#fromtxt").attr("data-cal"))>new Date($("#totxt").attr("data-cal"))){$("#totxt").attr("data-cal",$("#fromtxt").attr("data-cal"));$("#totxt").html($("#fromtxt").html())}}function checkSubmitcatadd(a){if(a&&a.keyCode==13){$("#mapsearchbutton").click()}}function checkSubmitcatadd1(a){if(a&&a.keyCode==13){window.location.href=ReturnLink("/map")}}function addMapData(){}function getToDoDataRelated(){$(".upload-overlay-loading-fix").show();$("#search01_landmarks").val(0);$.post(ReturnLink("/ajax/ajax_ToDo_result.php"),{frtxt:fr_txt,totxt:to_txt,data_log:$("#BigMap_up").attr("data-log"),data_angle:$("#BigMap_up").attr("data-angle"),data_lat:$("#BigMap_up").attr("data-lat"),entity_type:entity_type_search},function(a){var c=null;try{c=$.parseJSON(a)}catch(b){$(".upload-overlay-loading-fix").hide();return}if(c.error){TTAlert({msg:c.error,type:"alert",btn1:t("ok"),btn2:"",btn2Callback:null})}else{$("#todo_container").html(c.data)}$(".upload-overlay-loading-fix").hide()})}function filterToDoData(b){var a=parseInt($(b).val());entity_type_search=a;if(entity_type_search!=SOCIAL_ENTITY_LANDMARK&&entity_type_search!=SOCIAL_ENTITY_EVENTS){entity_type_search=0}fr_txt="";to_txt="";getToDoDataRelated()}function inArray(d,a){var c=a.length;for(var b=0;b<c;b++){if(a[b]==d){return true}}return false}function setMapMarkers(a){var b=a-10;if(b<=0){b=0}var k=new Array();k.push(-1);$(".search_checkbox.active").each(function(i,e){k.push(parseInt($(this).attr("data-value")))});for(var d=0;d<marker_global_array.length;d++){var l=marker_global_array[d];try{for(var f=0;f<l.length;f++){var g=l[f];var h=marker_global_array1[d][f];if(d<=b){g[0].setMap(null);if(inArray(parseInt(g[1]),k)||inArray(0,k)){h[0].setMap(map)}else{h[0].setMap(null)}}else{h[0].setMap(null);if(inArray(parseInt(g[1]),k)||inArray(0,k)){g[0].setMap(map)}else{g[0].setMap(null)}}}}catch(c){}}};