{% extends 'baseFinal.html.twig' %}
{% block structureddatablock %}
    <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      {% if mediaType=='v' %}
      "@type": "VideoObject",
      "author": {
	"@type": "Person",
	"name": "{{creator_avatar_name|raw}}"
	 },
	"@id": "{{app.request.uri}}",
	"thumbnailUrl":"{{image|raw}}",
	{% if description =='' %}
	"description": "{{creator_avatar_name|raw}} uploaded the {{pageTitle|raw}} video",
	 {% else %}
	  "description": "{{description|nl2br|e('html')}}",
	{% endif %}
	  "uploadDate": "{{ datePublished|join('-') }}",
	{% else %}
      "@type": "ImageObject",
      "author": "{{creator_avatar_name|raw}}",
      "contentUrl": "{{image|raw}}",
      "description": "{{description|nl2br|e('html')}}",
      "datePublished": "{{ datePublished|join('-') }}",
      {% endif %}
      "name": "{{pageTitle|raw|e('html')}}",
      "contentLocation": "{{ crumbsArray |join(',')}}"

    }
    </script>
{% endblock %}
{% block pagenewcss %}
    <link rel="stylesheet" type="text/css" href="{{ asset("/assets/vendor/jquery/plugins/fancybox/dist/jquery.fancybox.min.css")|raw }}">
{% endblock %}
{% block pagenewjs %}
<script type="text/javascript" src="{{ asset("/assets/vendor/jquery/plugins/fancybox/dist/jquery.fancybox.js")|raw }}" ></script>
    <script type="text/javascript">      
        var regWidth;
        var regHeight;
        $(window).bind('resize',function(){
            {% if mediaType=='v' and VPublished==1 %}
                refreshVideos('flashcontentmedia');
            {% endif %}
            $('.jwplayer').each(function(){
                var $thisjw = $(this);
                if( $thisjw.attr('id') != 'flashcontentmedia' ) refreshVideosSwiper( $thisjw.attr('id') );
            });
        });
        ThumbPath = '';
        var pagevideoerror=false;
       
        $(document).ready(function() {
			
			$('[data-fancybox="gallery"]').fancybox({
				animationEffect: false,
				transitionEffect: 'slide',
				thumbs: {
					autoStart: true,
				},
			});
			
            var videocount = $('.flashmediaclasses').length;
            var li =0;
            
			setTimeout(function () {
                {% if mediaType=='v' and VPublished==1 %}                  
                    regWidth = $('.video_detimg').width();                     
                    regHeight = $('.video_detimg').height(); 
                    EmbedFlashJW('flashcontentmedia', '{{ res_list|raw }}', regWidth, regHeight, '{{res_listimg|raw}}' , {{ mediaid|raw }},0,0,false);
                    
		    jwplayer('flashcontentmedia').on('error', function() {
                        setTimeout(function () {
                            EmbedFlashJW('flashcontentmedia', '{{ res_list|raw }}', regWidth, regHeight, '{{res_listimg|raw}}' , {{ mediaid|raw }},0,0,false);
                        }, 1500);
                    })
                    $('.video_detimg').on('load', function() { 
                         refreshVideos('flashcontentmedia');
                    });
                {% endif %}
                $('.flashmediaclasses').each(function(){
                    var $this = $(this);
                    var $thisswiperslide = $this.closest('.swiper-slide');
                    li++;
                    var datareslist = $this.attr('data-reslist');
                    var datareslistimg = $this.attr('data-reslistimg');
                    var datamediaid = $this.attr('data-mediaid');
                    if(datareslist!=''){
                        regWidth = $this.closest('.swiper-slide').find('.video_detimgswiper').width();                     
                        regHeight = $this.closest('.swiper-slide').find('.video_detimgswiper').height();
                        EmbedFlashJW($this.attr('id'), datareslist, regWidth, regHeight, datareslistimg , datamediaid,0,0,false);               
                        $this.closest('.swiper-slide').on('load', function() { 
                             refreshVideosSwiper( $this.attr('id') );
                        });
                        setTimeout(function () {
                            $thisswiperslide.find('.imgcontainerswipe').hide();
                        }, 300);
			jwplayer($this.attr('id')).on('play', function() {
                            var thisplay = $(this);
                            $('.jwplayer').each(function(){
                                var $thisjw = $(this);
                                if( thisplay[0].id != $thisjw.attr('id') )jwplayer($thisjw.attr('id')).stop();
                            });
                        })
                    }
                });
                {% if mediaType=='v' and VPublished==1 %}
		    jwplayer('flashcontentmedia').on('play', function() {
                            var thisplay = $(this);
                            $('.jwplayer').each(function(){
                                var $thisjw = $(this);
                                if( thisplay[0].id != $thisjw.attr('id') )jwplayer($thisjw.attr('id')).stop();
                            });
                        }
                    )
                {% endif %}
            }, 2500);
        });
        function refreshVideos(id){
            regWidth = $('.video_detimg').width();                     
            regHeight = $('.video_detimg').height();
            var playerInstance = jwplayer(id);
            playerInstance.resize(regWidth,regHeight);
        }
        function refreshVideosSwiper(id){
            regWidth = $('#'+id).closest('.swiper-slide').find('.video_detimgswiper').width();                     
            regHeight = $('#'+id).closest('.swiper-slide').find('.video_detimgswiper').height();
            var playerInstance = jwplayer(id);
            playerInstance.resize(regWidth,regHeight);
        }
    </script>
{% endblock %}
{% block body %}

    <section class="media-container" data-id="{{mediaid|raw}}" data-log="{{isUserLoggedIn|raw}}">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <div class="row no-margin margin_top_20">
                        <div class="col-xs-12 nopad">
                            <h1 class="search_title"><span class="circlimg_arrow"><i class="fas fa-angle-right"></i></span>{{'Media'|trans}} | <span>{{pageTitle|raw}}</span></h1>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row no-margin">
                <div class="col-xs-12 nopad">
                    <div class="mainwrappercontainer-wrapper">
                        <div class="swiper-container-ss s1 swiper-container-horizontal">
                            <div class="swiper-wrapper nav nav-tabs">
				{% for items in mediaarray %}
				    <div data-target="{{ loop.index }}" class="swiper-slide first_trigger_li {% if loop.index==1 %}visible-xs{% endif %}" data-id="{{items.id|raw}}">
					<a href="{{items.link|raw}}" title="{{'title'}}: {{ items.titlealt|raw }}" class="imgcontainerswipe">
					    <img class="img-responsive{% if items.img1 !='' %} hidden-xs{% endif %}" src="{{items.img|raw}}" alt="{{'title'}}: {{ items.titlealt|raw }}"/>
					    {% if items.img1 !='' %}
						<img class="img-responsive visible-xs" src="{{items.img1|raw}}" alt="{{'title'}}: {{ items.titlealt|raw }}"/>
					    {% endif %}					    
					    {% if items.mediaType=='v' %}
						<div class="sprite video_icon hidden-xs"></div>
					    {% endif %}
					</a>
					{% if items.mediaType=='v' %}
					    <div class="vid_imgswiper vid_img visible-xs">
						<div id="flashcontentmedia{{loop.index}}" data-reslist="{{ items.res_list|raw }}" data-reslistimg="{{ items.res_listimg|raw }}" data-mediaid="{{ items.id|raw }}" class="{% if loop.index==1 %}flashmediaclasses{% else %}flashmediaclassesOther{% endif %}"></div>
					    </div>
					    <img class="video_detimgswiper" src="{{ generateMediaURL('/media/images/media-black-photo.jpg') }}" alt="{{'video'|trans}}"/>
					{% endif %}
					<h3 class="firsttextimgswiper"><a href="{{items.link|raw}}" title="{{'title'}}: {{ items.titlealt|raw }}">{{items.title|raw}}</a></h3>
					<p class="uploaddatetextimgswiper">{{items.time|raw}}</p>
					<p class="uploaddatetextimgswiper hidden-lg hidden-md hidden-sm">{{items.description|raw}}</p>
				    </div>
				{% endfor %}
                            </div>
                        </div>
                        <a class="swiper-button-ss-prev"></a>
                        <a class="swiper-button-ss-next"></a>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid nopad hidden-xs">
            <div class="row no-margin bordered_row"></div>
        </div>
        <div class="container hidden-xs">
	    <div class="row margin_top_30">
		<div class="col-xs-12">
		    {{seo_bread_crumbs|raw}}
		</div>
	    </div>
            <div class="row no-margin">
                <div class="col-xs-12 nopad">
		    {% if VPublished==1 %}
			<div class="row no-margin">
			    <div class="col-xs-12 nopad margin_top_10 blackBg">
				{% if mediaType=='v' %}
				    <div class="vid_img">
						<div id="flashcontentmedia"></div>
				    </div>
				    <img class="col-xs-12 nopad video_detimg" src="{{ generateMediaURL('/media/images/media-black-photo.jpg') }}" alt="{{'black'|trans}}"/>
				{% else %}
				    <div class="media_holder">
					<div class="table-wrapper">
					    <a rel="nofollow" data-fancybox="gallery" href="{{image|raw}}" title="{% if pageTitle=='' %}{{'title'}}{% else %}{{pageTitle|raw}}{% endif %}" class="table-cell">
						<img src="{{image|raw}}" alt="{% if pageTitle=='' %}{{'title'}}{% else %}{{pageTitle|raw}}{% endif %}" />
					    </a>
					    {% for items in mediaarray %}
						{% if loop.index > 1 %}
						    {% if items.mediaType=='v' %}
							<a rel="nofollow" data-fancybox="gallery" href="/{{ items.res_video|raw }}" title="{% if items.titlealt=='' %}{{'title'}}{% else %}{{items.titlealt|raw}}{% endif %}" class="hidden">
							    <img class="hidden" src="{{items.img1|raw}}" alt="{{'title'}}: {{ items.titlealt|raw }}"/>
							</a>
						    {% else %}
							<a rel="nofollow" data-fancybox="gallery" href="{{items.img_big|raw}}" title="{% if items.titlealt=='' %}{{'title'}}{% else %}{{items.titlealt|raw}}{% endif %}" class="hidden">
							    <img class="hidden" src="{{items.img|raw}}" alt="{{'title'}}: {{ items.titlealt|raw }}"/>
							</a>
						    {% endif %}
						{% endif %}
					    {% endfor %}
					</div>
				    </div>				
				{% endif %}
			    </div>
			</div>
		    {% endif %}
                    <div class="row no-margin">
                        <div class="col-xs-12 nopad margin_top_10">
                            <img class="img-responsive img-circle float_left" src="{{creator_img|raw}}" alt="{{creator_avatar_namealt|raw}}"/>
                            <div class="right_text_div float_left">
                                <h2>{{pageTitle|raw}}</h2>
				<span>{{'by'|trans}} </span>
				{% if isUserLoggedIn==1 %}
				    <a href="{{creator_avatar_link|raw}}" title="{{ creator_avatar_name|raw }}" class="avatar_txt">{{creator_avatar_name|raw}}</a></div>
				{% else %}
				    <span class="avatar_txt">{{creator_avatar_name|raw}}</span>
				{% endif %}                                
                            </div>
                        </div>
                        <div class="col-xs-12 nopad margin_top_10">
                            <p class="txt_greypara">{{description|nl2br}}</p>
                            <p></p>
                        </div>
			{% if category_title !='' %}
			    <div class="col-xs-12 nopad margin_top_20">
				<h3 class="categorie_txt">{{'category:'|trans}} <a href="{{category_link|raw}}" class="valbum_name" title="{{ category_titlealt|raw }}">{{category_title|raw}}</a></h3>
			    </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}